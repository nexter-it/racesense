{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/racesense/racesense-frontend/src/pages/RaceLive.jsx\",\n  _s = $RefreshSig$();\n// src/pages/RaceLive.jsx\nimport React, { useState, useEffect, useRef, useMemo } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport '../App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE = process.env.REACT_APP_API_BASE || `http://${window.location.hostname}:5000`;\nconst WS_URL = process.env.REACT_APP_WS_URL || `ws://${window.location.hostname}:5001`;\nfunction toRad(d) {\n  return d * Math.PI / 180;\n}\nfunction haversine(lat1, lon1, lat2, lon2) {\n  const R = 6371000;\n  const dLat = toRad(lat2 - lat1);\n  const dLon = toRad(lat2 - lon1);\n  const a = Math.sin(dLat / 2) ** 2 + Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) * Math.sin(dLon / 2) ** 2;\n  return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n}\nconst formatLap = s => {\n  if (!s && s !== 0) return '—';\n  const m = Math.floor(s / 60);\n  const sec = (s % 60).toFixed(3);\n  return `${m}:${sec.padStart(6, '0')}`;\n};\nconst PALETTE = ['#C0FF03', '#2ED8A7', '#6AA9FF', '#FF7A59', '#B085FF', '#FFD166', '#EF476F', '#06D6A0', '#118AB2', '#FFE66D', '#F78C6B', '#8AC926'];\nfunction colorForKey(key) {\n  let h = 0;\n  for (let i = 0; i < key.length; i++) h = h * 31 + key.charCodeAt(i) >>> 0;\n  return PALETTE[h % PALETTE.length];\n}\nexport default function RaceLive({\n  raceConfig,\n  onStopRace\n}) {\n  _s();\n  var _snapshot$totalLaps, _snapshot$circuit, _circuitData$stats, _snapshot$circuit2, _snapshot$circuit2$st, _circuitData$stats2, _snapshot$circuit3, _snapshot$circuit3$st, _circuitData$params2, _snapshot$circuit4, _snapshot$circuit4$pa, _circuitData$params3, _snapshot$circuit5, _snapshot$circuit5$pa, _statusColors$lbBorde, _leaderboard$find, _leaderboard$find$pen;\n  const {\n    circuitData,\n    totalLaps\n  } = raceConfig;\n  const navigate = useNavigate();\n  const [snapshot, setSnapshot] = useState(null);\n  const [blink, setBlink] = useState(true);\n  const [penTargetMac, setPenTargetMac] = useState('');\n  useEffect(() => {\n    const t = setInterval(() => setBlink(b => !b), 700);\n    return () => clearInterval(t);\n  }, []);\n  const trailsRef = useRef({});\n  const TRAIL_MAX_AGE_MS = 30000;\n  const TRAIL_MAX_LEN = 140;\n  const colorsRef = useRef({});\n  const canvasRef = useRef(null);\n  const animFrameRef = useRef(null);\n  const zoomRef = useRef(1);\n  const panRef = useRef({\n    x: 0,\n    y: 0\n  });\n  const isDraggingRef = useRef(false);\n  const lastMouseRef = useRef({\n    x: 0,\n    y: 0\n  });\n  useEffect(() => {\n    const ws = new WebSocket(WS_URL);\n    ws.onmessage = event => {\n      try {\n        const data = JSON.parse(event.data);\n        if ((data === null || data === void 0 ? void 0 : data.type) === 'race_snapshot') {\n          const now = Date.now();\n          (data.drivers || []).forEach(d => {\n            if (!colorsRef.current[d.mac]) colorsRef.current[d.mac] = colorForKey(d.mac + (d.team || '') + (d.tag || ''));\n          });\n          (data.drivers || []).forEach(d => {\n            const t = trailsRef.current[d.mac] || [];\n            trailsRef.current[d.mac] = [...t, {\n              lat: d.lat,\n              lon: d.lon,\n              ts: now\n            }].slice(-TRAIL_MAX_LEN);\n          });\n          setSnapshot(data);\n        } else if ((data === null || data === void 0 ? void 0 : data.type) === 'race_inactive') setSnapshot(null);\n      } catch {}\n    };\n    ws.onerror = e => console.error('[RaceLive] WS error', e);\n    return () => {\n      try {\n        ws.close();\n      } catch {}\n    };\n  }, []);\n  useEffect(() => {\n    if (!circuitData || !canvasRef.current) return;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    const dpr = window.devicePixelRatio || 1;\n    const ensureSize = () => {\n      const w = canvas.parentElement.clientWidth || 600;\n      const h = canvas.parentElement.clientHeight || 520;\n      if (canvas.width !== Math.floor(w * dpr) || canvas.height !== Math.floor(h * dpr)) {\n        canvas.width = Math.floor(w * dpr);\n        canvas.height = Math.floor(h * dpr);\n        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n      }\n    };\n    const onResize = () => ensureSize();\n    ensureSize();\n    window.addEventListener('resize', onResize);\n    const wheel = e => {\n      e.preventDefault();\n      zoomRef.current = Math.max(0.5, Math.min(5, zoomRef.current * (e.deltaY > 0 ? 0.9 : 1.1)));\n    };\n    const mousedown = e => {\n      isDraggingRef.current = true;\n      lastMouseRef.current = {\n        x: e.clientX,\n        y: e.clientY\n      };\n      canvas.style.cursor = 'grabbing';\n    };\n    const mousemove = e => {\n      if (!isDraggingRef.current) return;\n      panRef.current.x += e.clientX - lastMouseRef.current.x;\n      panRef.current.y += e.clientY - lastMouseRef.current.y;\n      lastMouseRef.current = {\n        x: e.clientX,\n        y: e.clientY\n      };\n    };\n    const mouseup = () => {\n      isDraggingRef.current = false;\n      canvas.style.cursor = 'grab';\n    };\n    canvas.addEventListener('wheel', wheel, {\n      passive: false\n    });\n    canvas.addEventListener('mousedown', mousedown);\n    canvas.addEventListener('mousemove', mousemove);\n    canvas.addEventListener('mouseup', mouseup);\n    canvas.addEventListener('mouseleave', mouseup);\n    canvas.style.cursor = 'grab';\n    const lats = circuitData.sectors.map(s => s.lat);\n    const lons = circuitData.sectors.map(s => s.lon);\n    const minLat = Math.min(...lats),\n      maxLat = Math.max(...lats);\n    const minLon = Math.min(...lons),\n      maxLon = Math.max(...lons);\n    const centerLat = (minLat + maxLat) / 2,\n      centerLon = (minLon + maxLon) / 2;\n    const R = 6371000,\n      centerLatRad = centerLat * Math.PI / 180;\n    const dxList = lons.map(l => (l - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad));\n    const dyList = lats.map(l => (l - centerLat) * Math.PI / 180 * R);\n    const maxDx = Math.max(...dxList.map(Math.abs));\n    const maxDy = Math.max(...dyList.map(Math.abs));\n    const padding = 40;\n    const project = (lat, lon) => {\n      const w = canvas.width / dpr,\n        h = canvas.height / dpr;\n      const maxRange = Math.max(maxDx, maxDy) * 1.1;\n      const scale = Math.min(w - padding * 2, h - padding * 2) / (maxRange * 2) * zoomRef.current;\n      const dx = (lon - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad);\n      const dy = (lat - centerLat) * Math.PI / 180 * R;\n      return {\n        x: w / 2 + dx * scale + panRef.current.x,\n        y: h / 2 - dy * scale + panRef.current.y,\n        scale\n      };\n    };\n    const draw = () => {\n      var _circuitData$params$w, _circuitData$params, _pts$;\n      ensureSize();\n      const w = canvas.width / dpr,\n        h = canvas.height / dpr;\n      ctx.clearRect(0, 0, w, h);\n      ctx.fillStyle = '#0a0a0a';\n      ctx.fillRect(0, 0, w, h);\n      const widthMeters = (_circuitData$params$w = (_circuitData$params = circuitData.params) === null || _circuitData$params === void 0 ? void 0 : _circuitData$params.widthMeters) !== null && _circuitData$params$w !== void 0 ? _circuitData$params$w : 6;\n      const pts = circuitData.sectors.map(s => project(s.lat, s.lon));\n      const scale = ((_pts$ = pts[0]) === null || _pts$ === void 0 ? void 0 : _pts$.scale) || 1;\n      const trackPx = Math.max(6, widthMeters * scale);\n      ctx.strokeStyle = 'rgba(255,255,255,0.10)';\n      ctx.lineWidth = trackPx + 4;\n      ctx.lineCap = 'round';\n      ctx.lineJoin = 'round';\n      ctx.beginPath();\n      pts.forEach((p, i) => i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y));\n      ctx.closePath();\n      ctx.stroke();\n      ctx.strokeStyle = 'rgba(80,84,90,0.95)';\n      ctx.lineWidth = trackPx;\n      ctx.beginPath();\n      pts.forEach((p, i) => i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y));\n      ctx.closePath();\n      ctx.stroke();\n      if (pts.length > 1) {\n        const s0 = pts[0],\n          s1 = pts[1];\n        const ang = Math.atan2(s1.y - s0.y, s1.x - s0.x);\n        ctx.save();\n        ctx.translate(s0.x, s0.y);\n        ctx.rotate(ang);\n        ctx.strokeStyle = '#ffffff';\n        ctx.lineWidth = Math.max(2, trackPx * 0.12);\n        ctx.beginPath();\n        ctx.moveTo(0, -trackPx * 0.5);\n        ctx.lineTo(0, trackPx * 0.5);\n        ctx.stroke();\n        ctx.restore();\n      }\n      const now = Date.now();\n      Object.keys(trailsRef.current).forEach(k => {\n        trailsRef.current[k] = (trailsRef.current[k] || []).filter(p => now - p.ts <= 30000).slice(-TRAIL_MAX_LEN);\n      });\n      const drivers = (snapshot === null || snapshot === void 0 ? void 0 : snapshot.drivers) || [];\n      const sorted = [...drivers].sort((a, b) => a.position - b.position);\n      sorted.forEach((d, i) => {\n        const color = colorsRef.current[d.mac] || '#C0FF03';\n        const trail = trailsRef.current[d.mac] || [];\n        if (trail.length > 1) {\n          for (let t = 1; t < trail.length; t++) {\n            const prev = project(trail[t - 1].lat, trail[t - 1].lon);\n            const cur = project(trail[t].lat, trail[t].lon);\n            const ageFrac = Math.min(1, (now - trail[t].ts) / 30000);\n            const alpha = 0.75 * (1 - ageFrac);\n            let rgba = color;\n            if (color.startsWith('#')) {\n              const hex = color.slice(1);\n              const full = hex.length === 3 ? hex.split('').map(c => c + c).join('') : hex;\n              const v = parseInt(full, 16),\n                r = v >> 16 & 255,\n                g = v >> 8 & 255,\n                b = v & 255;\n              rgba = `rgba(${r},${g},${b},${alpha})`;\n            }\n            ctx.strokeStyle = rgba;\n            ctx.lineWidth = Math.max(2, trackPx * 0.12);\n            ctx.beginPath();\n            ctx.moveTo(prev.x, prev.y);\n            ctx.lineTo(cur.x, cur.y);\n            ctx.stroke();\n          }\n        }\n        const p = project(d.lat, d.lon);\n        const r = Math.max(5, trackPx * 0.18) + (i === 0 ? 1 : 0);\n        let fill = color;\n        if (fill.startsWith('#')) {\n          const hex = fill.slice(1);\n          const full = hex.length === 3 ? hex.split('').map(c => c + c).join('') : hex;\n          const v = parseInt(full, 16),\n            rr = v >> 16 & 255,\n            gg = v >> 8 & 255,\n            bb = v & 255;\n          fill = `rgba(${rr},${gg},${bb},1)`;\n        }\n        ctx.shadowColor = 'rgba(0,0,0,0.5)';\n        ctx.shadowBlur = 4;\n        ctx.fillStyle = fill;\n        ctx.beginPath();\n        ctx.arc(p.x, p.y, r, 0, Math.PI * 2);\n        ctx.fill();\n        ctx.shadowBlur = 0;\n        ctx.strokeStyle = '#fff';\n        ctx.lineWidth = 2;\n        ctx.stroke();\n        ctx.fillStyle = '#fff';\n        ctx.font = 'bold 10px Roboto, sans-serif';\n        ctx.textAlign = 'center';\n        ctx.fillText(d.tag, p.x, p.y - (r + 8));\n      });\n      animFrameRef.current = requestAnimationFrame(draw);\n    };\n    draw();\n    return () => {\n      window.removeEventListener('resize', onResize);\n      canvas.removeEventListener('wheel', wheel);\n      canvas.removeEventListener('mousedown', mousedown);\n      canvas.removeEventListener('mousemove', mousemove);\n      canvas.removeEventListener('mouseup', mouseup);\n      canvas.removeEventListener('mouseleave', mouseup);\n      if (animFrameRef.current) cancelAnimationFrame(animFrameRef.current);\n    };\n  }, [circuitData, snapshot]);\n  const leaderboard = useMemo(() => !(snapshot !== null && snapshot !== void 0 && snapshot.drivers) ? [] : [...snapshot.drivers].sort((a, b) => a.position - b.position), [snapshot]);\n  const globalBestLap = (snapshot === null || snapshot === void 0 ? void 0 : snapshot.globalBestLap) || null;\n  const statusColors = useMemo(() => {\n    const s = (snapshot === null || snapshot === void 0 ? void 0 : snapshot.raceStatus) || 'IN CORSO';\n    switch (s) {\n      case 'RED FLAG':\n        return {\n          chipBg: 'rgba(225,6,0,.15)',\n          chipBorder: '#e10600',\n          chipText: '#ffdede',\n          lbBorder: '#e10600'\n        };\n      case 'YELLOW FLAG':\n        return {\n          chipBg: 'rgba(241,196,15,.15)',\n          chipBorder: '#f1c40f',\n          chipText: '#fff3c4',\n          lbBorder: '#f1c40f'\n        };\n      case 'FINITA':\n        return {\n          chipBg: 'rgba(154,163,154,.15)',\n          chipBorder: '#9aa39a',\n          chipText: '#e0e0e0',\n          lbBorder: '#9aa39a'\n        };\n      default:\n        return {\n          chipBg: 'rgba(21,193,48,.15)',\n          chipBorder: '#15c130',\n          chipText: '#e9ffe0',\n          lbBorder: null\n        };\n    }\n  }, [snapshot === null || snapshot === void 0 ? void 0 : snapshot.raceStatus]);\n  const sendStatus = async status => {\n    try {\n      await fetch(`${API_BASE}/api/race/status`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          status\n        })\n      });\n    } catch (e) {\n      console.error(e);\n    }\n  };\n  const sendPenalty = async type => {\n    if (!penTargetMac) return;\n    try {\n      await fetch(`${API_BASE}/api/race/penalty`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          mac: penTargetMac,\n          type\n        })\n      });\n    } catch (e) {\n      console.error(e);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main small-top\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"rs-live-topbar\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rs-live-left\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            gap: 8\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            \"aria-hidden\": true,\n            style: {\n              width: 10,\n              height: 10,\n              borderRadius: '50%',\n              background: '#ff4d4f',\n              boxShadow: '0 0 12px rgba(255,77,79,.8)',\n              opacity: blink ? 1 : .25,\n              transition: 'opacity .15s linear'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 13\n          }, this), \"LIVE\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          children: [(_snapshot$totalLaps = snapshot === null || snapshot === void 0 ? void 0 : snapshot.totalLaps) !== null && _snapshot$totalLaps !== void 0 ? _snapshot$totalLaps : totalLaps, \" giri\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          style: {\n            background: statusColors.chipBg,\n            border: `1px solid ${statusColors.chipBorder}`,\n            color: statusColors.chipText,\n            fontWeight: 800\n          },\n          children: (snapshot === null || snapshot === void 0 ? void 0 : snapshot.raceStatus) || 'IN CORSO'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rs-live-right\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          children: (circuitData === null || circuitData === void 0 ? void 0 : circuitData.name) || (snapshot === null || snapshot === void 0 ? void 0 : (_snapshot$circuit = snapshot.circuit) === null || _snapshot$circuit === void 0 ? void 0 : _snapshot$circuit.name) || 'Circuito'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 11\n        }, this), ((circuitData === null || circuitData === void 0 ? void 0 : (_circuitData$stats = circuitData.stats) === null || _circuitData$stats === void 0 ? void 0 : _circuitData$stats.lengthMeters) || (snapshot === null || snapshot === void 0 ? void 0 : (_snapshot$circuit2 = snapshot.circuit) === null || _snapshot$circuit2 === void 0 ? void 0 : (_snapshot$circuit2$st = _snapshot$circuit2.stats) === null || _snapshot$circuit2$st === void 0 ? void 0 : _snapshot$circuit2$st.lengthMeters)) && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          children: [((circuitData === null || circuitData === void 0 ? void 0 : (_circuitData$stats2 = circuitData.stats) === null || _circuitData$stats2 === void 0 ? void 0 : _circuitData$stats2.lengthMeters) || (snapshot === null || snapshot === void 0 ? void 0 : (_snapshot$circuit3 = snapshot.circuit) === null || _snapshot$circuit3 === void 0 ? void 0 : (_snapshot$circuit3$st = _snapshot$circuit3.stats) === null || _snapshot$circuit3$st === void 0 ? void 0 : _snapshot$circuit3$st.lengthMeters)).toFixed(0), \" m\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 13\n        }, this), ((circuitData === null || circuitData === void 0 ? void 0 : (_circuitData$params2 = circuitData.params) === null || _circuitData$params2 === void 0 ? void 0 : _circuitData$params2.widthMeters) || (snapshot === null || snapshot === void 0 ? void 0 : (_snapshot$circuit4 = snapshot.circuit) === null || _snapshot$circuit4 === void 0 ? void 0 : (_snapshot$circuit4$pa = _snapshot$circuit4.params) === null || _snapshot$circuit4$pa === void 0 ? void 0 : _snapshot$circuit4$pa.widthMeters)) && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          children: [(circuitData === null || circuitData === void 0 ? void 0 : (_circuitData$params3 = circuitData.params) === null || _circuitData$params3 === void 0 ? void 0 : _circuitData$params3.widthMeters) || (snapshot === null || snapshot === void 0 ? void 0 : (_snapshot$circuit5 = snapshot.circuit) === null || _snapshot$circuit5 === void 0 ? void 0 : (_snapshot$circuit5$pa = _snapshot$circuit5.params) === null || _snapshot$circuit5$pa === void 0 ? void 0 : _snapshot$circuit5$pa.widthMeters), \" m larghezza\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"rs-live-grid\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"track-card\",\n        children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n          ref: canvasRef,\n          className: \"track-canvas\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 37\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"leaderboard-card\",\n        style: {\n          borderColor: (_statusColors$lbBorde = statusColors.lbBorder) !== null && _statusColors$lbBorde !== void 0 ? _statusColors$lbBorde : 'var(--line)',\n          boxShadow: statusColors.lbBorder ? `0 8px 32px ${statusColors.lbBorder}33, inset 0 0 0 1px ${statusColors.lbBorder}55` : undefined\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lb-title\",\n            children: \"CLASSIFICA\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 38\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lb-sub\",\n            children: [leaderboard.length, \" piloti\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 80\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-list\",\n          children: leaderboard.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"no-drivers\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Nessun dato GPS ancora disponibile\\u2026\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 43\n            }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n              className: \"muted\",\n              children: \"Appena arrivano i pacchetti la classifica si popola\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 85\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 15\n          }, this) : leaderboard.map((d, idx) => {\n            var _snapshot$totalLaps2;\n            const isLeader = idx === 0;\n            const fastest = d.bestLapTime && globalBestLap && d.bestLapTime === globalBestLap;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `lb-row ${isLeader ? 'lb-leader' : ''}`,\n              title: `${d.fullName} — Clicca per seguire`,\n              role: \"button\",\n              tabIndex: 0,\n              onClick: () => navigate(`/pilot/${d.mac}`) // ⬅⬅ CLIC\n              ,\n              onKeyDown: e => {\n                if (e.key === 'Enter') navigate(`/pilot/${d.mac}`);\n              },\n              style: {\n                cursor: 'pointer'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-pos\",\n                children: idx + 1\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 276,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-team\",\n                children: d.photoTeamUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: `${API_BASE}${d.photoTeamUrl}`,\n                  alt: d.team,\n                  className: \"lb-team-logo\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 279,\n                  columnNumber: 25\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"lb-team-color\",\n                  style: {\n                    background: colorsRef.current[d.mac] || '#C0FF03'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 281,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 277,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-name\",\n                children: d.tag\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 284,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-gap\",\n                children: d.gapToLeader || (isLeader ? 'LEADER' : '')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 285,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-icons\",\n                children: fastest && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"lb-icon purple\",\n                  title: `Best lap ${formatLap(d.bestLapTime)}`,\n                  children: \"\\u23F1\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 286,\n                  columnNumber: 59\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 286,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-lap\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"muted\",\n                  children: \"Lap\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 287,\n                  columnNumber: 45\n                }, this), \"\\xA0\", d.lapCount, \"/\", (_snapshot$totalLaps2 = snapshot === null || snapshot === void 0 ? void 0 : snapshot.totalLaps) !== null && _snapshot$totalLaps2 !== void 0 ? _snapshot$totalLaps2 : totalLaps]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 287,\n                columnNumber: 21\n              }, this)]\n            }, d.mac, true, {\n              fileName: _jsxFileName,\n              lineNumber: 266,\n              columnNumber: 19\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"leaderboard-card\",\n      style: {\n        marginTop: 12,\n        width: '100%'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lb-header\",\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'baseline'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-title\",\n          children: \"CLASSIFICA DETTAGLIATA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-sub\",\n          children: [leaderboard.length, \" piloti \\u2022 tempi ultimo giro e miglior giro\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lb-list\",\n        children: leaderboard.map((d, idx) => {\n          var _d$penalty, _snapshot$totalLaps3;\n          const fastest = d.bestLapTime && globalBestLap && d.bestLapTime === globalBestLap;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lb-row\",\n            style: {\n              gridTemplateColumns: '28px 28px 1fr 90px 110px 110px 140px 90px',\n              cursor: 'pointer'\n            },\n            title: `${d.fullName} — Clicca per seguire`,\n            onClick: () => navigate(`/pilot/${d.mac}`) // ⬅⬅ CLIC\n            ,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-pos\",\n              children: idx + 1\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 314,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-team\",\n              children: d.photoTeamUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n                src: `${API_BASE}${d.photoTeamUrl}`,\n                alt: d.team,\n                className: \"lb-team-logo\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 317,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-team-color\",\n                style: {\n                  background: colorsRef.current[d.mac] || '#C0FF03'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 319,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 315,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-name\",\n              children: d.tag\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 322,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              style: {\n                textAlign: 'right'\n              },\n              children: idx === 0 ? 'LEADER' : d.gapToLeader\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              title: \"Ultimo giro\",\n              style: {\n                fontWeight: 700,\n                color: '#e9ffe0'\n              },\n              children: formatLap(d.lastLapTime)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 324,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              title: \"Miglior giro\",\n              style: {\n                fontWeight: 700,\n                color: fastest ? '#b085ff' : '#e9ffe0'\n              },\n              children: [formatLap(d.bestLapTime), fastest && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"lb-icon purple\",\n                style: {\n                  marginLeft: 6\n                },\n                children: \"\\u23F1\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 326,\n                columnNumber: 57\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 325,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              title: \"Penalit\\xE0 assegnate\",\n              style: {\n                fontWeight: 800\n              },\n              children: (d === null || d === void 0 ? void 0 : (_d$penalty = d.penalty) === null || _d$penalty === void 0 ? void 0 : _d$penalty.summary) || '—'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 328,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-lap\",\n              style: {\n                textAlign: 'right'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"muted\",\n                children: \"Lap\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 329,\n                columnNumber: 72\n              }, this), \"\\xA0\", d.lapCount, \"/\", (_snapshot$totalLaps3 = snapshot === null || snapshot === void 0 ? void 0 : snapshot.totalLaps) !== null && _snapshot$totalLaps3 !== void 0 ? _snapshot$totalLaps3 : totalLaps]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 329,\n              columnNumber: 17\n            }, this)]\n          }, `wide-${d.mac}`, true, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"leaderboard-card\",\n      style: {\n        marginTop: 12,\n        width: '100%'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lb-header\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-title\",\n          children: \"COMANDI GARA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 338,\n          columnNumber: 36\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"race-controls\",\n        style: {\n          justifyContent: 'space-between',\n          gap: 12,\n          flexWrap: 'wrap',\n          padding: '20px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            gap: 8,\n            flexWrap: 'wrap'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"muted\",\n            children: \"Stato:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 13\n          }, this), ['IN CORSO', 'FINITA', 'RED FLAG', 'YELLOW FLAG'].map(s => /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn-ghost\",\n            onClick: () => sendStatus(s),\n            style: {\n              borderColor: (snapshot === null || snapshot === void 0 ? void 0 : snapshot.raceStatus) === s ? 'rgba(192,255,3,0.6)' : 'var(--line)',\n              boxShadow: (snapshot === null || snapshot === void 0 ? void 0 : snapshot.raceStatus) === s ? '0 0 0 2px rgba(192,255,3,0.12) inset' : 'none',\n              fontWeight: 700\n            },\n            children: s\n          }, s, false, {\n            fileName: _jsxFileName,\n            lineNumber: 343,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            gap: 8,\n            flexWrap: 'wrap',\n            marginTop: '15px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"muted\",\n            children: \"Sanzioni:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            className: \"input\",\n            value: penTargetMac,\n            onChange: e => setPenTargetMac(e.target.value),\n            style: {\n              width: 260\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"-- Seleziona pilota --\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 352,\n              columnNumber: 15\n            }, this), leaderboard.map(d => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: d.mac,\n              children: [d.tag, \" \\u2014 \", d.fullName]\n            }, d.mac, true, {\n              fileName: _jsxFileName,\n              lineNumber: 353,\n              columnNumber: 38\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 351,\n            columnNumber: 13\n          }, this), ['+5s', '+10s', '+15s', '1mo avv. squalifica', 'squalifica'].map(k => /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn-ghost\",\n            disabled: !penTargetMac,\n            onClick: () => sendPenalty(k),\n            style: {\n              fontWeight: 800\n            },\n            children: k\n          }, k, false, {\n            fileName: _jsxFileName,\n            lineNumber: 356,\n            columnNumber: 15\n          }, this)), penTargetMac && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"muted\",\n            style: {\n              marginLeft: 6\n            },\n            children: [\"Attuale: \", /*#__PURE__*/_jsxDEV(\"b\", {\n              children: ((_leaderboard$find = leaderboard.find(d => d.mac === penTargetMac)) === null || _leaderboard$find === void 0 ? void 0 : (_leaderboard$find$pen = _leaderboard$find.penalty) === null || _leaderboard$find$pen === void 0 ? void 0 : _leaderboard$find$pen.summary) || '—'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 358,\n              columnNumber: 89\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 30\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 349,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          style: {\n            marginTop: '20px'\n          },\n          className: \"btn-danger\",\n          onClick: async () => {\n            try {\n              await fetch(`${API_BASE}/api/race/stop`, {\n                method: 'POST'\n              });\n            } catch {}\n            ;\n            onStopRace();\n          },\n          children: \"Termina gara\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 337,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 228,\n    columnNumber: 5\n  }, this);\n}\n_s(RaceLive, \"sa1E+ms55oyHUA+xq4CsRqq8uKY=\", false, function () {\n  return [useNavigate];\n});\n_c = RaceLive;\nvar _c;\n$RefreshReg$(_c, \"RaceLive\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useMemo","useNavigate","jsxDEV","_jsxDEV","API_BASE","process","env","REACT_APP_API_BASE","window","location","hostname","WS_URL","REACT_APP_WS_URL","toRad","d","Math","PI","haversine","lat1","lon1","lat2","lon2","R","dLat","dLon","a","sin","cos","atan2","sqrt","formatLap","s","m","floor","sec","toFixed","padStart","PALETTE","colorForKey","key","h","i","length","charCodeAt","RaceLive","raceConfig","onStopRace","_s","_snapshot$totalLaps","_snapshot$circuit","_circuitData$stats","_snapshot$circuit2","_snapshot$circuit2$st","_circuitData$stats2","_snapshot$circuit3","_snapshot$circuit3$st","_circuitData$params2","_snapshot$circuit4","_snapshot$circuit4$pa","_circuitData$params3","_snapshot$circuit5","_snapshot$circuit5$pa","_statusColors$lbBorde","_leaderboard$find","_leaderboard$find$pen","circuitData","totalLaps","navigate","snapshot","setSnapshot","blink","setBlink","penTargetMac","setPenTargetMac","t","setInterval","b","clearInterval","trailsRef","TRAIL_MAX_AGE_MS","TRAIL_MAX_LEN","colorsRef","canvasRef","animFrameRef","zoomRef","panRef","x","y","isDraggingRef","lastMouseRef","ws","WebSocket","onmessage","event","data","JSON","parse","type","now","Date","drivers","forEach","current","mac","team","tag","lat","lon","ts","slice","onerror","e","console","error","close","canvas","ctx","getContext","dpr","devicePixelRatio","ensureSize","w","parentElement","clientWidth","clientHeight","width","height","setTransform","onResize","addEventListener","wheel","preventDefault","max","min","deltaY","mousedown","clientX","clientY","style","cursor","mousemove","mouseup","passive","lats","sectors","map","lons","minLat","maxLat","minLon","maxLon","centerLat","centerLon","centerLatRad","dxList","l","dyList","maxDx","abs","maxDy","padding","project","maxRange","scale","dx","dy","draw","_circuitData$params$w","_circuitData$params","_pts$","clearRect","fillStyle","fillRect","widthMeters","params","pts","trackPx","strokeStyle","lineWidth","lineCap","lineJoin","beginPath","p","lineTo","moveTo","closePath","stroke","s0","s1","ang","save","translate","rotate","restore","Object","keys","k","filter","sorted","sort","position","color","trail","prev","cur","ageFrac","alpha","rgba","startsWith","hex","full","split","c","join","v","parseInt","r","g","fill","rr","gg","bb","shadowColor","shadowBlur","arc","font","textAlign","fillText","requestAnimationFrame","removeEventListener","cancelAnimationFrame","leaderboard","globalBestLap","statusColors","raceStatus","chipBg","chipBorder","chipText","lbBorder","sendStatus","status","fetch","method","headers","body","stringify","sendPenalty","className","children","display","alignItems","gap","borderRadius","background","boxShadow","opacity","transition","fileName","_jsxFileName","lineNumber","columnNumber","border","fontWeight","name","circuit","stats","lengthMeters","ref","borderColor","undefined","idx","_snapshot$totalLaps2","isLeader","fastest","bestLapTime","title","fullName","role","tabIndex","onClick","onKeyDown","photoTeamUrl","src","alt","gapToLeader","lapCount","marginTop","justifyContent","_d$penalty","_snapshot$totalLaps3","gridTemplateColumns","lastLapTime","marginLeft","penalty","summary","flexWrap","value","onChange","target","disabled","find","_c","$RefreshReg$"],"sources":["/home/ubuntu/racesense/racesense-frontend/src/pages/RaceLive.jsx"],"sourcesContent":["// src/pages/RaceLive.jsx\nimport React, { useState, useEffect, useRef, useMemo } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport '../App.css';\n\nconst API_BASE = process.env.REACT_APP_API_BASE || `http://${window.location.hostname}:5000`;\nconst WS_URL = process.env.REACT_APP_WS_URL || `ws://${window.location.hostname}:5001`;\n\nfunction toRad(d) { return d * Math.PI / 180; }\nfunction haversine(lat1, lon1, lat2, lon2) {\n  const R = 6371000;\n  const dLat = toRad(lat2 - lat1);\n  const dLon = toRad(lat2 - lon1);\n  const a = Math.sin(dLat / 2) ** 2 + Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) * Math.sin(dLon / 2) ** 2;\n  return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n}\nconst formatLap = (s) => {\n  if (!s && s !== 0) return '—';\n  const m = Math.floor(s / 60);\n  const sec = (s % 60).toFixed(3);\n  return `${m}:${sec.padStart(6, '0')}`;\n};\n\nconst PALETTE = ['#C0FF03', '#2ED8A7', '#6AA9FF', '#FF7A59', '#B085FF', '#FFD166', '#EF476F', '#06D6A0', '#118AB2', '#FFE66D', '#F78C6B', '#8AC926'];\nfunction colorForKey(key) {\n  let h = 0; for (let i = 0; i < key.length; i++) h = (h * 31 + key.charCodeAt(i)) >>> 0;\n  return PALETTE[h % PALETTE.length];\n}\n\nexport default function RaceLive({ raceConfig, onStopRace }) {\n  const { circuitData, totalLaps } = raceConfig;\n  const navigate = useNavigate();\n\n  const [snapshot, setSnapshot] = useState(null);\n  const [blink, setBlink] = useState(true);\n  const [penTargetMac, setPenTargetMac] = useState('');\n  useEffect(() => { const t = setInterval(() => setBlink(b => !b), 700); return () => clearInterval(t); }, []);\n\n  const trailsRef = useRef({});\n  const TRAIL_MAX_AGE_MS = 30000;\n  const TRAIL_MAX_LEN = 140;\n  const colorsRef = useRef({});\n\n  const canvasRef = useRef(null);\n  const animFrameRef = useRef(null);\n  const zoomRef = useRef(1);\n  const panRef = useRef({ x: 0, y: 0 });\n  const isDraggingRef = useRef(false);\n  const lastMouseRef = useRef({ x: 0, y: 0 });\n\n  useEffect(() => {\n    const ws = new WebSocket(WS_URL);\n    ws.onmessage = (event) => {\n      try {\n        const data = JSON.parse(event.data);\n        if (data?.type === 'race_snapshot') {\n          const now = Date.now();\n          (data.drivers || []).forEach(d => {\n            if (!colorsRef.current[d.mac]) colorsRef.current[d.mac] = colorForKey(d.mac + (d.team || '') + (d.tag || ''));\n          });\n          (data.drivers || []).forEach(d => {\n            const t = trailsRef.current[d.mac] || [];\n            trailsRef.current[d.mac] = [...t, { lat: d.lat, lon: d.lon, ts: now }].slice(-TRAIL_MAX_LEN);\n          });\n          setSnapshot(data);\n        } else if (data?.type === 'race_inactive') setSnapshot(null);\n      } catch { }\n    };\n    ws.onerror = (e) => console.error('[RaceLive] WS error', e);\n    return () => { try { ws.close(); } catch { } };\n  }, []);\n\n  useEffect(() => {\n    if (!circuitData || !canvasRef.current) return;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    const dpr = window.devicePixelRatio || 1;\n\n    const ensureSize = () => {\n      const w = canvas.parentElement.clientWidth || 600;\n      const h = canvas.parentElement.clientHeight || 520;\n      if (canvas.width !== Math.floor(w * dpr) || canvas.height !== Math.floor(h * dpr)) {\n        canvas.width = Math.floor(w * dpr); canvas.height = Math.floor(h * dpr);\n        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n      }\n    };\n    const onResize = () => ensureSize();\n    ensureSize();\n    window.addEventListener('resize', onResize);\n\n    const wheel = (e) => { e.preventDefault(); zoomRef.current = Math.max(0.5, Math.min(5, zoomRef.current * (e.deltaY > 0 ? 0.9 : 1.1))); };\n    const mousedown = (e) => { isDraggingRef.current = true; lastMouseRef.current = { x: e.clientX, y: e.clientY }; canvas.style.cursor = 'grabbing'; };\n    const mousemove = (e) => { if (!isDraggingRef.current) return; panRef.current.x += e.clientX - lastMouseRef.current.x; panRef.current.y += e.clientY - lastMouseRef.current.y; lastMouseRef.current = { x: e.clientX, y: e.clientY }; };\n    const mouseup = () => { isDraggingRef.current = false; canvas.style.cursor = 'grab'; };\n    canvas.addEventListener('wheel', wheel, { passive: false });\n    canvas.addEventListener('mousedown', mousedown);\n    canvas.addEventListener('mousemove', mousemove);\n    canvas.addEventListener('mouseup', mouseup);\n    canvas.addEventListener('mouseleave', mouseup);\n    canvas.style.cursor = 'grab';\n\n    const lats = circuitData.sectors.map(s => s.lat);\n    const lons = circuitData.sectors.map(s => s.lon);\n    const minLat = Math.min(...lats), maxLat = Math.max(...lats);\n    const minLon = Math.min(...lons), maxLon = Math.max(...lons);\n    const centerLat = (minLat + maxLat) / 2, centerLon = (minLon + maxLon) / 2;\n    const R = 6371000, centerLatRad = centerLat * Math.PI / 180;\n    const dxList = lons.map(l => (l - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad));\n    const dyList = lats.map(l => (l - centerLat) * Math.PI / 180 * R);\n    const maxDx = Math.max(...dxList.map(Math.abs));\n    const maxDy = Math.max(...dyList.map(Math.abs));\n    const padding = 40;\n\n    const project = (lat, lon) => {\n      const w = canvas.width / dpr, h = canvas.height / dpr;\n      const maxRange = Math.max(maxDx, maxDy) * 1.1;\n      const scale = Math.min(w - padding * 2, h - padding * 2) / (maxRange * 2) * zoomRef.current;\n      const dx = (lon - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad);\n      const dy = (lat - centerLat) * Math.PI / 180 * R;\n      return { x: w / 2 + dx * scale + panRef.current.x, y: h / 2 - dy * scale + panRef.current.y, scale };\n    };\n\n    const draw = () => {\n      ensureSize();\n      const w = canvas.width / dpr, h = canvas.height / dpr;\n      ctx.clearRect(0, 0, w, h);\n      ctx.fillStyle = '#0a0a0a'; ctx.fillRect(0, 0, w, h);\n\n      const widthMeters = circuitData.params?.widthMeters ?? 6;\n      const pts = circuitData.sectors.map(s => project(s.lat, s.lon));\n      const scale = pts[0]?.scale || 1;\n      const trackPx = Math.max(6, widthMeters * scale);\n\n      ctx.strokeStyle = 'rgba(255,255,255,0.10)'; ctx.lineWidth = trackPx + 4; ctx.lineCap = 'round'; ctx.lineJoin = 'round';\n      ctx.beginPath(); pts.forEach((p, i) => i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y)); ctx.closePath(); ctx.stroke();\n      ctx.strokeStyle = 'rgba(80,84,90,0.95)'; ctx.lineWidth = trackPx;\n      ctx.beginPath(); pts.forEach((p, i) => i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y)); ctx.closePath(); ctx.stroke();\n\n      if (pts.length > 1) {\n        const s0 = pts[0], s1 = pts[1]; const ang = Math.atan2(s1.y - s0.y, s1.x - s0.x);\n        ctx.save(); ctx.translate(s0.x, s0.y); ctx.rotate(ang);\n        ctx.strokeStyle = '#ffffff'; ctx.lineWidth = Math.max(2, trackPx * 0.12);\n        ctx.beginPath(); ctx.moveTo(0, -trackPx * 0.5); ctx.lineTo(0, trackPx * 0.5); ctx.stroke(); ctx.restore();\n      }\n\n      const now = Date.now();\n      Object.keys(trailsRef.current).forEach(k => {\n        trailsRef.current[k] = (trailsRef.current[k] || []).filter(p => now - p.ts <= 30000).slice(-TRAIL_MAX_LEN);\n      });\n\n      const drivers = snapshot?.drivers || [];\n      const sorted = [...drivers].sort((a, b) => a.position - b.position);\n\n      sorted.forEach((d, i) => {\n        const color = colorsRef.current[d.mac] || '#C0FF03';\n        const trail = trailsRef.current[d.mac] || [];\n        if (trail.length > 1) {\n          for (let t = 1; t < trail.length; t++) {\n            const prev = project(trail[t - 1].lat, trail[t - 1].lon);\n            const cur = project(trail[t].lat, trail[t].lon);\n            const ageFrac = Math.min(1, (now - trail[t].ts) / 30000);\n            const alpha = 0.75 * (1 - ageFrac);\n            let rgba = color;\n            if (color.startsWith('#')) {\n              const hex = color.slice(1);\n              const full = hex.length === 3 ? hex.split('').map(c => c + c).join('') : hex;\n              const v = parseInt(full, 16), r = (v >> 16) & 255, g = (v >> 8) & 255, b = v & 255;\n              rgba = `rgba(${r},${g},${b},${alpha})`;\n            }\n            ctx.strokeStyle = rgba; ctx.lineWidth = Math.max(2, trackPx * 0.12);\n            ctx.beginPath(); ctx.moveTo(prev.x, prev.y); ctx.lineTo(cur.x, cur.y); ctx.stroke();\n          }\n        }\n        const p = project(d.lat, d.lon);\n        const r = Math.max(5, trackPx * 0.18) + (i === 0 ? 1 : 0);\n        let fill = color;\n        if (fill.startsWith('#')) {\n          const hex = fill.slice(1); const full = hex.length === 3 ? hex.split('').map(c => c + c).join('') : hex;\n          const v = parseInt(full, 16), rr = (v >> 16) & 255, gg = (v >> 8) & 255, bb = v & 255;\n          fill = `rgba(${rr},${gg},${bb},1)`;\n        }\n        ctx.shadowColor = 'rgba(0,0,0,0.5)'; ctx.shadowBlur = 4;\n        ctx.fillStyle = fill; ctx.beginPath(); ctx.arc(p.x, p.y, r, 0, Math.PI * 2); ctx.fill();\n        ctx.shadowBlur = 0; ctx.strokeStyle = '#fff'; ctx.lineWidth = 2; ctx.stroke();\n        ctx.fillStyle = '#fff'; ctx.font = 'bold 10px Roboto, sans-serif'; ctx.textAlign = 'center';\n        ctx.fillText(d.tag, p.x, p.y - (r + 8));\n      });\n\n      animFrameRef.current = requestAnimationFrame(draw);\n    };\n    draw();\n\n    return () => {\n      window.removeEventListener('resize', onResize);\n      canvas.removeEventListener('wheel', wheel);\n      canvas.removeEventListener('mousedown', mousedown);\n      canvas.removeEventListener('mousemove', mousemove);\n      canvas.removeEventListener('mouseup', mouseup);\n      canvas.removeEventListener('mouseleave', mouseup);\n      if (animFrameRef.current) cancelAnimationFrame(animFrameRef.current);\n    };\n  }, [circuitData, snapshot]);\n\n  const leaderboard = useMemo(() => (!snapshot?.drivers) ? [] : [...snapshot.drivers].sort((a, b) => a.position - b.position), [snapshot]);\n  const globalBestLap = snapshot?.globalBestLap || null;\n\n  const statusColors = useMemo(() => {\n    const s = snapshot?.raceStatus || 'IN CORSO';\n    switch (s) {\n      case 'RED FLAG': return { chipBg: 'rgba(225,6,0,.15)', chipBorder: '#e10600', chipText: '#ffdede', lbBorder: '#e10600' };\n      case 'YELLOW FLAG': return { chipBg: 'rgba(241,196,15,.15)', chipBorder: '#f1c40f', chipText: '#fff3c4', lbBorder: '#f1c40f' };\n      case 'FINITA': return { chipBg: 'rgba(154,163,154,.15)', chipBorder: '#9aa39a', chipText: '#e0e0e0', lbBorder: '#9aa39a' };\n      default: return { chipBg: 'rgba(21,193,48,.15)', chipBorder: '#15c130', chipText: '#e9ffe0', lbBorder: null };\n    }\n  }, [snapshot?.raceStatus]);\n\n  const sendStatus = async (status) => {\n    try { await fetch(`${API_BASE}/api/race/status`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ status }) }); }\n    catch (e) { console.error(e); }\n  };\n  const sendPenalty = async (type) => {\n    if (!penTargetMac) return;\n    try { await fetch(`${API_BASE}/api/race/penalty`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ mac: penTargetMac, type }) }); }\n    catch (e) { console.error(e); }\n  };\n\n  return (\n    <div className=\"main small-top\">\n      {/* topbar */}\n      <div className=\"rs-live-topbar\">\n        <div className=\"rs-live-left\">\n          <span className=\"chip readonly\" style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n            <span aria-hidden style={{ width: 10, height: 10, borderRadius: '50%', background: '#ff4d4f', boxShadow: '0 0 12px rgba(255,77,79,.8)', opacity: blink ? 1 : .25, transition: 'opacity .15s linear' }} />\n            LIVE\n          </span>\n          <span className=\"chip readonly\">{snapshot?.totalLaps ?? totalLaps} giri</span>\n          <span className=\"chip readonly\" style={{ background: statusColors.chipBg, border: `1px solid ${statusColors.chipBorder}`, color: statusColors.chipText, fontWeight: 800 }}>\n            {snapshot?.raceStatus || 'IN CORSO'}\n          </span>\n        </div>\n        <div className=\"rs-live-right\">\n          <span className=\"chip readonly\">{circuitData?.name || snapshot?.circuit?.name || 'Circuito'}</span>\n          {(circuitData?.stats?.lengthMeters || snapshot?.circuit?.stats?.lengthMeters) && (\n            <span className=\"chip readonly\">{(circuitData?.stats?.lengthMeters || snapshot?.circuit?.stats?.lengthMeters).toFixed(0)} m</span>\n          )}\n          {(circuitData?.params?.widthMeters || snapshot?.circuit?.params?.widthMeters) && (\n            <span className=\"chip readonly\">{(circuitData?.params?.widthMeters || snapshot?.circuit?.params?.widthMeters)} m larghezza</span>\n          )}\n        </div>\n      </div>\n\n      <div className=\"rs-live-grid\">\n        <div className=\"track-card\"><canvas ref={canvasRef} className=\"track-canvas\" /></div>\n\n        <div className=\"leaderboard-card\" style={{ borderColor: statusColors.lbBorder ?? 'var(--line)', boxShadow: statusColors.lbBorder ? `0 8px 32px ${statusColors.lbBorder}33, inset 0 0 0 1px ${statusColors.lbBorder}55` : undefined }}>\n          <div className=\"lb-header\"><div className=\"lb-title\">CLASSIFICA</div><div className=\"lb-sub\">{leaderboard.length} piloti</div></div>\n\n          <div className=\"lb-list\">\n            {leaderboard.length === 0 ? (\n              <div className=\"no-drivers\"><p>Nessun dato GPS ancora disponibile…</p><small className=\"muted\">Appena arrivano i pacchetti la classifica si popola</small></div>\n            ) : (\n              leaderboard.map((d, idx) => {\n                const isLeader = idx === 0;\n                const fastest = d.bestLapTime && globalBestLap && d.bestLapTime === globalBestLap;\n                return (\n                  <div\n                    key={d.mac}\n                    className={`lb-row ${isLeader ? 'lb-leader' : ''}`}\n                    title={`${d.fullName} — Clicca per seguire`}\n                    role=\"button\"\n                    tabIndex={0}\n                    onClick={() => navigate(`/pilot/${d.mac}`)}   // ⬅⬅ CLIC\n                    onKeyDown={(e) => { if (e.key === 'Enter') navigate(`/pilot/${d.mac}`); }}\n                    style={{ cursor: 'pointer' }}\n                  >\n                    <div className=\"lb-pos\">{idx + 1}</div>\n                    <div className=\"lb-team\">\n                      {d.photoTeamUrl ? (\n                        <img src={`${API_BASE}${d.photoTeamUrl}`} alt={d.team} className=\"lb-team-logo\" />\n                      ) : (\n                        <div className=\"lb-team-color\" style={{ background: colorsRef.current[d.mac] || '#C0FF03' }} />\n                      )}\n                    </div>\n                    <div className=\"lb-name\">{d.tag}</div>\n                    <div className=\"lb-gap\">{d.gapToLeader || (isLeader ? 'LEADER' : '')}</div>\n                    <div className=\"lb-icons\">{fastest && <span className=\"lb-icon purple\" title={`Best lap ${formatLap(d.bestLapTime)}`}>⏱</span>}</div>\n                    <div className=\"lb-lap\"><span className=\"muted\">Lap</span>&nbsp;{d.lapCount}/{snapshot?.totalLaps ?? totalLaps}</div>\n                  </div>\n                );\n              })\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Dettagliata (cliccabile uguale) */}\n      <div className=\"leaderboard-card\" style={{ marginTop: 12, width: '100%' }}>\n        <div className=\"lb-header\" style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'baseline' }}>\n          <div className=\"lb-title\">CLASSIFICA DETTAGLIATA</div>\n          <div className=\"lb-sub\">{leaderboard.length} piloti • tempi ultimo giro e miglior giro</div>\n        </div>\n\n        <div className=\"lb-list\">\n          {leaderboard.map((d, idx) => {\n            const fastest = d.bestLapTime && globalBestLap && d.bestLapTime === globalBestLap;\n            return (\n              <div\n                key={`wide-${d.mac}`}\n                className=\"lb-row\"\n                style={{ gridTemplateColumns: '28px 28px 1fr 90px 110px 110px 140px 90px', cursor: 'pointer' }}\n                title={`${d.fullName} — Clicca per seguire`}\n                onClick={() => navigate(`/pilot/${d.mac}`)}     // ⬅⬅ CLIC\n              >\n                <div className=\"lb-pos\">{idx + 1}</div>\n                <div className=\"lb-team\">\n                  {d.photoTeamUrl ? (\n                    <img src={`${API_BASE}${d.photoTeamUrl}`} alt={d.team} className=\"lb-team-logo\" />\n                  ) : (\n                    <div className=\"lb-team-color\" style={{ background: colorsRef.current[d.mac] || '#C0FF03' }} />\n                  )}\n                </div>\n                <div className=\"lb-name\">{d.tag}</div>\n                <div className=\"lb-gap\" style={{ textAlign: 'right' }}>{idx === 0 ? 'LEADER' : d.gapToLeader}</div>\n                <div className=\"lb-gap\" title=\"Ultimo giro\" style={{ fontWeight: 700, color: '#e9ffe0' }}>{formatLap(d.lastLapTime)}</div>\n                <div className=\"lb-gap\" title=\"Miglior giro\" style={{ fontWeight: 700, color: fastest ? '#b085ff' : '#e9ffe0' }}>\n                  {formatLap(d.bestLapTime)}{fastest && <span className=\"lb-icon purple\" style={{ marginLeft: 6 }}>⏱</span>}\n                </div>\n                <div className=\"lb-gap\" title=\"Penalità assegnate\" style={{ fontWeight: 800 }}>{d?.penalty?.summary || '—'}</div>\n                <div className=\"lb-lap\" style={{ textAlign: 'right' }}><span className=\"muted\">Lap</span>&nbsp;{d.lapCount}/{snapshot?.totalLaps ?? totalLaps}</div>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* COMANDI GARA (invariati) */}\n      <div className=\"leaderboard-card\" style={{ marginTop: 12, width: '100%' }}>\n        <div className=\"lb-header\"><div className=\"lb-title\">COMANDI GARA</div></div>\n        <div className=\"race-controls\" style={{ justifyContent: 'space-between', gap: 12, flexWrap: 'wrap', padding: '20px' }}>\n          <div style={{ display: 'flex', alignItems: 'center', gap: 8, flexWrap: 'wrap' }}>\n            <span className=\"muted\">Stato:</span>\n            {['IN CORSO', 'FINITA', 'RED FLAG', 'YELLOW FLAG'].map(s => (\n              <button key={s} className=\"btn-ghost\" onClick={() => sendStatus(s)}\n                style={{ borderColor: (snapshot?.raceStatus === s) ? 'rgba(192,255,3,0.6)' : 'var(--line)', boxShadow: (snapshot?.raceStatus === s) ? '0 0 0 2px rgba(192,255,3,0.12) inset' : 'none', fontWeight: 700 }}\n              >{s}</button>\n            ))}\n          </div>\n\n          <div style={{ display: 'flex', alignItems: 'center', gap: 8, flexWrap: 'wrap', marginTop: '15px' }}>\n            <span className=\"muted\">Sanzioni:</span>\n            <select className=\"input\" value={penTargetMac} onChange={(e) => setPenTargetMac(e.target.value)} style={{ width: 260 }}>\n              <option value=\"\">-- Seleziona pilota --</option>\n              {leaderboard.map(d => (<option key={d.mac} value={d.mac}>{d.tag} — {d.fullName}</option>))}\n            </select>\n            {['+5s', '+10s', '+15s', '1mo avv. squalifica', 'squalifica'].map(k => (\n              <button key={k} className=\"btn-ghost\" disabled={!penTargetMac} onClick={() => sendPenalty(k)} style={{ fontWeight: 800 }}>{k}</button>\n            ))}\n            {penTargetMac && <span className=\"muted\" style={{ marginLeft: 6 }}>Attuale: <b>{leaderboard.find(d => d.mac === penTargetMac)?.penalty?.summary || '—'}</b></span>}\n          </div>\n\n          <button style={{ marginTop: '20px' }} className=\"btn-danger\" onClick={async () => { try { await fetch(`${API_BASE}/api/race/stop`, { method: 'POST' }) } catch { }; onStopRace(); }}>Termina gara</button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}