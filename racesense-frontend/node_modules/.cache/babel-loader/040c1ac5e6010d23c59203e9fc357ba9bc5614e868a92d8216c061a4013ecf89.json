{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/racesense/racesense-frontend/src/pages/RaceLive.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useEffect, useMemo, useRef, useState, useCallback } from 'react';\nimport '../App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE = process.env.REACT_APP_API_BASE || `http://${window.location.hostname}:5000`;\n\n/* ========= WebSocket URL coerente con http/https ========= */\nconst makeWsUrl = () => {\n  if (process.env.REACT_APP_WS_URL) return process.env.REACT_APP_WS_URL; // se definita, prioritaria\n  const proto = window.location.protocol === 'https:' ? 'wss' : 'ws';\n  const host = window.location.hostname;\n  const port = process.env.REACT_APP_WS_PORT || '5001';\n  return `${proto}://${host}${port ? `:${port}` : ''}`;\n};\nconst WS_URL = makeWsUrl();\n\n/* ========= Hook: WebSocket affidabile con auto-reconnect ========= */\nfunction useReliableWebSocket(url, {\n  onMessage,\n  onOpen,\n  onError\n} = {}) {\n  _s();\n  const wsRef = useRef(null);\n  const aliveRef = useRef(true);\n  const retryRef = useRef(0);\n  useEffect(() => {\n    aliveRef.current = true;\n    const connect = () => {\n      if (!aliveRef.current) return;\n      try {\n        const ws = new WebSocket(url);\n        wsRef.current = ws;\n        ws.onopen = e => {\n          retryRef.current = 0;\n          onOpen && onOpen(e);\n        };\n        ws.onmessage = e => onMessage && onMessage(e);\n        ws.onerror = e => onError && onError(e);\n        ws.onclose = () => {\n          if (!aliveRef.current) return; // unmount\n          const delay = Math.min(1000 * 2 ** retryRef.current, 10000); // backoff max 10s\n          retryRef.current += 1;\n          setTimeout(connect, delay);\n        };\n      } catch {\n        const delay = Math.min(1000 * 2 ** retryRef.current, 10000);\n        retryRef.current += 1;\n        setTimeout(connect, delay);\n      }\n    };\n    connect();\n    return () => {\n      aliveRef.current = false;\n      try {\n        const ws = wsRef.current;\n        if (ws && (ws.readyState === WebSocket.OPEN || ws.readyState === WebSocket.CONNECTING)) {\n          ws.close();\n        }\n      } catch {}\n    };\n  }, [url, onMessage, onOpen, onError]);\n  return wsRef;\n}\n\n/* ========= Utils ========= */\n_s(useReliableWebSocket, \"iFhBiEiu1yKOD3cu3g/02F8KEsM=\");\nfunction formatLap(sec) {\n  if (!sec && sec !== 0) return '—';\n  const m = Math.floor(sec / 60);\n  const s = (sec % 60).toFixed(3).padStart(6, '0');\n  return `${m}:${s}`;\n}\n\n/* ========= Component ========= */\nexport default function RaceLive({\n  raceConfig,\n  onStopRace\n}) {\n  _s2();\n  var _circuit$stats, _circuit$params2, _statusColors$lbBorde;\n  // Stato dal server (se entro “da spettatore”)\n  const [serverState, setServerState] = useState(null); // { active, circuit, totalLaps, pilots, summary }\n  const [summary, setSummary] = useState(null); // { leaderboard, status, bestLapOverall, ... } (1Hz dal server)\n  const [raceStatus, setRaceStatus] = useState('IN CORSO');\n\n  // Canvas & proiezione\n  const canvasRef = useRef(null);\n  const zoomRef = useRef(1);\n  const panRef = useRef({\n    x: 0,\n    y: 0\n  });\n  const isDraggingRef = useRef(false);\n  const lastMouseRef = useRef({\n    x: 0,\n    y: 0\n  });\n  const animRef = useRef(null);\n  const dprRef = useRef(1);\n  const circuitRef = useRef(null);\n\n  // Posizioni GPS correnti (realtime) per i marker\n  const driverPositionsRef = useRef({}); // mac -> { lat, lon, tag, color, photoTeamUrl }\n\n  // Blink “LIVE”\n  const [blink, setBlink] = useState(true);\n  useEffect(() => {\n    const t = setInterval(() => setBlink(b => !b), 700);\n    return () => clearInterval(t);\n  }, []);\n\n  /* ===== Stato iniziale: se non ho raceConfig locale, tento join gara attiva ===== */\n  useEffect(() => {\n    let alive = true;\n    const init = async () => {\n      try {\n        const r = await fetch(`${API_BASE}/api/race/state`);\n        const j = await r.json();\n        if (!alive) return;\n        if (j.active) {\n          var _j$summary;\n          setServerState(j);\n          setSummary(j.summary || null);\n          setRaceStatus(((_j$summary = j.summary) === null || _j$summary === void 0 ? void 0 : _j$summary.status) || 'IN CORSO');\n          circuitRef.current = j.circuit || null;\n        } else if (raceConfig !== null && raceConfig !== void 0 && raceConfig.circuitData) {\n          // fallback: se arrivo da setup con config locale\n          setServerState({\n            active: false,\n            circuit: raceConfig.circuitData,\n            totalLaps: raceConfig.totalLaps,\n            pilots: raceConfig.pilots\n          });\n          circuitRef.current = raceConfig.circuitData;\n        }\n      } catch (e) {\n        console.error('[RaceLive] init error', e);\n        // fallback locale se ho raceConfig\n        if (raceConfig !== null && raceConfig !== void 0 && raceConfig.circuitData) {\n          setServerState({\n            active: false,\n            circuit: raceConfig.circuitData,\n            totalLaps: raceConfig.totalLaps,\n            pilots: raceConfig.pilots\n          });\n          circuitRef.current = raceConfig.circuitData;\n        }\n      }\n    };\n    init();\n    return () => {\n      alive = false;\n    };\n  }, [raceConfig]);\n\n  /* ===== WebSocket: ricevo GPS (realtime) + summary (1 Hz) ===== */\n  useReliableWebSocket(WS_URL, {\n    onOpen: () => console.log('[RaceLive] WS connesso'),\n    onError: e => console.error('[RaceLive] WS error', e),\n    onMessage: event => {\n      try {\n        const msg = JSON.parse(event.data);\n\n        // Pacchetto classifica/riepilogo lato server\n        if ((msg === null || msg === void 0 ? void 0 : msg.type) === 'race') {\n          var _msg$payload;\n          setSummary(msg.payload || null);\n          if ((_msg$payload = msg.payload) !== null && _msg$payload !== void 0 && _msg$payload.status) setRaceStatus(msg.payload.status);\n          return;\n        }\n\n        // Pacchetto GPS (accetto sia {type:'gps', payload} sia payload piatto)\n        const pkt = (msg === null || msg === void 0 ? void 0 : msg.type) === 'gps' ? msg.payload || msg : msg;\n        if (pkt !== null && pkt !== void 0 && pkt.mac && pkt !== null && pkt !== void 0 && pkt.lat && pkt !== null && pkt !== void 0 && pkt.lon) {\n          const mac = String(pkt.mac);\n          // prova a recuperare dallo snapshot di summary (per tag/colore)\n          const row = ((summary === null || summary === void 0 ? void 0 : summary.leaderboard) || []).find(x => x.mac === mac);\n          driverPositionsRef.current[mac] = {\n            lat: Number(pkt.lat),\n            lon: Number(pkt.lon),\n            tag: ((row === null || row === void 0 ? void 0 : row.tag) || 'PIL').slice(0, 4),\n            color: (row === null || row === void 0 ? void 0 : row.color) || '#C0FF03',\n            photoTeamUrl: (row === null || row === void 0 ? void 0 : row.photoTeamUrl) || null\n          };\n        }\n      } catch {}\n    }\n  });\n\n  /* ===== Canvas draw loop (solo render, niente calcoli di classifica) ===== */\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const ctx = canvas.getContext('2d');\n    const dpr = window.devicePixelRatio || 1;\n    dprRef.current = dpr;\n    const ensureSize = () => {\n      const parent = canvas.parentElement;\n      const w = parent.clientWidth || 800;\n      const h = parent.clientHeight || 520;\n      if (canvas.width !== Math.floor(w * dpr) || canvas.height !== Math.floor(h * dpr)) {\n        canvas.width = Math.floor(w * dpr);\n        canvas.height = Math.floor(h * dpr);\n        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n      }\n    };\n    ensureSize();\n    const onResize = () => ensureSize();\n    window.addEventListener('resize', onResize);\n    const wheel = e => {\n      e.preventDefault();\n      zoomRef.current = Math.max(0.5, Math.min(5, zoomRef.current * (e.deltaY > 0 ? 0.9 : 1.1)));\n    };\n    const mousedown = e => {\n      isDraggingRef.current = true;\n      lastMouseRef.current = {\n        x: e.clientX,\n        y: e.clientY\n      };\n      canvas.style.cursor = 'grabbing';\n    };\n    const mousemove = e => {\n      if (!isDraggingRef.current) return;\n      const dx = e.clientX - lastMouseRef.current.x;\n      const dy = e.clientY - lastMouseRef.current.y;\n      panRef.current.x += dx;\n      panRef.current.y += dy;\n      lastMouseRef.current = {\n        x: e.clientX,\n        y: e.clientY\n      };\n    };\n    const mouseup = () => {\n      isDraggingRef.current = false;\n      canvas.style.cursor = 'grab';\n    };\n    canvas.addEventListener('wheel', wheel, {\n      passive: false\n    });\n    canvas.addEventListener('mousedown', mousedown);\n    canvas.addEventListener('mousemove', mousemove);\n    canvas.addEventListener('mouseup', mouseup);\n    canvas.addEventListener('mouseleave', mouseup);\n    canvas.style.cursor = 'grab';\n\n    // proiezione\n    const projectFactory = () => {\n      var _circuit$sectors;\n      const circuit = circuitRef.current;\n      if (!(circuit !== null && circuit !== void 0 && (_circuit$sectors = circuit.sectors) !== null && _circuit$sectors !== void 0 && _circuit$sectors.length)) return null;\n      const lats = circuit.sectors.map(s => s.lat);\n      const lons = circuit.sectors.map(s => s.lon);\n      const minLat = Math.min(...lats),\n        maxLat = Math.max(...lats);\n      const minLon = Math.min(...lons),\n        maxLon = Math.max(...lons);\n      const centerLat = (minLat + maxLat) / 2;\n      const centerLon = (minLon + maxLon) / 2;\n      const R = 6371000;\n      const centerLatRad = centerLat * Math.PI / 180;\n      const dxList = lons.map(l => (l - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad));\n      const dyList = lats.map(l => (l - centerLat) * Math.PI / 180 * R);\n      const maxDx = Math.max(...dxList.map(Math.abs));\n      const maxDy = Math.max(...dyList.map(Math.abs));\n      const padding = 40;\n      return (lat, lon, w, h) => {\n        const maxRange = Math.max(maxDx, maxDy) * 1.1;\n        const scale = Math.min(w - padding * 2, h - padding * 2) / (maxRange * 2) * zoomRef.current;\n        const dx = (lon - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad);\n        const dy = (lat - centerLat) * Math.PI / 180 * R;\n        const x = w / 2 + dx * scale + panRef.current.x;\n        const y = h / 2 - dy * scale + panRef.current.y;\n        return {\n          x,\n          y,\n          scale\n        };\n      };\n    };\n    let project = projectFactory();\n    const draw = () => {\n      var _circuit$sectors2;\n      ensureSize();\n      const w = canvas.width / dpr;\n      const h = canvas.height / dpr;\n      ctx.clearRect(0, 0, w, h);\n      ctx.fillStyle = '#0a0a0a';\n      ctx.fillRect(0, 0, w, h);\n      const circuit = circuitRef.current;\n      if (circuit !== null && circuit !== void 0 && (_circuit$sectors2 = circuit.sectors) !== null && _circuit$sectors2 !== void 0 && _circuit$sectors2.length) {\n        var _circuit$params$width, _circuit$params, _pts$;\n        if (!project) project = projectFactory();\n        const widthMeters = (_circuit$params$width = (_circuit$params = circuit.params) === null || _circuit$params === void 0 ? void 0 : _circuit$params.widthMeters) !== null && _circuit$params$width !== void 0 ? _circuit$params$width : 6;\n        const pts = circuit.sectors.map(s => project(s.lat, s.lon, w, h));\n        const scale = ((_pts$ = pts[0]) === null || _pts$ === void 0 ? void 0 : _pts$.scale) || 1;\n        const trackPx = Math.max(6, widthMeters * scale);\n\n        // bordo soft\n        ctx.strokeStyle = 'rgba(255,255,255,0.10)';\n        ctx.lineWidth = trackPx + 4;\n        ctx.lineCap = 'round';\n        ctx.lineJoin = 'round';\n        ctx.beginPath();\n        pts.forEach((p, i) => i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y));\n        ctx.closePath();\n        ctx.stroke();\n\n        // asfalto\n        ctx.strokeStyle = 'rgba(80, 84, 90, 0.95)';\n        ctx.lineWidth = trackPx;\n        ctx.beginPath();\n        pts.forEach((p, i) => i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y));\n        ctx.closePath();\n        ctx.stroke();\n\n        // linea di start\n        if (pts.length > 1) {\n          const s0 = pts[0],\n            s1 = pts[1];\n          const ang = Math.atan2(s1.y - s0.y, s1.x - s0.x);\n          ctx.save();\n          ctx.translate(s0.x, s0.y);\n          ctx.rotate(ang);\n          ctx.strokeStyle = '#ffffff';\n          ctx.lineWidth = Math.max(2, trackPx * 0.12);\n          ctx.beginPath();\n          ctx.moveTo(0, -trackPx * 0.5);\n          ctx.lineTo(0, trackPx * 0.5);\n          ctx.stroke();\n          ctx.restore();\n        }\n      }\n\n      // markers piloti (posizioni arrivate via WS GPS)\n      Object.entries(driverPositionsRef.current).forEach(([mac, pos]) => {\n        if (!project) return;\n        const p = project(pos.lat, pos.lon, w, h);\n        if (!p) return;\n        const r = Math.max(5, 6 * (zoomRef.current * 0.9));\n        ctx.shadowColor = 'rgba(0,0,0,0.5)';\n        ctx.shadowBlur = 4;\n        ctx.fillStyle = pos.color || '#C0FF03';\n        ctx.beginPath();\n        ctx.arc(p.x, p.y, r, 0, Math.PI * 2);\n        ctx.fill();\n        ctx.shadowBlur = 0;\n        ctx.strokeStyle = '#fff';\n        ctx.lineWidth = 2;\n        ctx.stroke();\n        ctx.fillStyle = '#fff';\n        ctx.font = 'bold 10px Roboto, sans-serif';\n        ctx.textAlign = 'center';\n        ctx.fillText((pos.tag || 'PIL').slice(0, 4), p.x, p.y - (r + 6));\n      });\n      animRef.current = requestAnimationFrame(draw);\n    };\n    draw();\n    return () => {\n      window.removeEventListener('resize', onResize);\n      canvas.removeEventListener('wheel', wheel);\n      canvas.removeEventListener('mousedown', mousedown);\n      canvas.removeEventListener('mousemove', mousemove);\n      canvas.removeEventListener('mouseup', mouseup);\n      canvas.removeEventListener('mouseleave', mouseup);\n      if (animRef.current) cancelAnimationFrame(animRef.current);\n    };\n  }, []);\n\n  /* ===== Render ===== */\n  const circuit = (serverState === null || serverState === void 0 ? void 0 : serverState.circuit) || (raceConfig === null || raceConfig === void 0 ? void 0 : raceConfig.circuitData);\n  const board = (summary === null || summary === void 0 ? void 0 : summary.leaderboard) || [];\n  const totalLaps = (summary === null || summary === void 0 ? void 0 : summary.totalLaps) || (serverState === null || serverState === void 0 ? void 0 : serverState.totalLaps) || (raceConfig === null || raceConfig === void 0 ? void 0 : raceConfig.totalLaps) || 0;\n  const statusColors = useMemo(() => {\n    switch (raceStatus) {\n      case 'RED FLAG':\n        return {\n          chipBg: 'rgba(225,6,0,.15)',\n          chipBorder: '#e10600',\n          chipText: '#ffdede',\n          lbBorder: '#e10600'\n        };\n      case 'YELLOW FLAG':\n        return {\n          chipBg: 'rgba(241,196,15,.15)',\n          chipBorder: '#f1c40f',\n          chipText: '#fff3c4',\n          lbBorder: '#f1c40f'\n        };\n      case 'FINITA':\n        return {\n          chipBg: 'rgba(154,163,154,.15)',\n          chipBorder: '#9aa39a',\n          chipText: '#e0e0e0',\n          lbBorder: '#9aa39a'\n        };\n      default:\n        return {\n          chipBg: 'rgba(21,193,48,.15)',\n          chipBorder: '#15c130',\n          chipText: '#e9ffe0',\n          lbBorder: null\n        };\n    }\n  }, [raceStatus]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main small-top\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"rs-live-topbar\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rs-live-left\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            gap: 8\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            \"aria-hidden\": true,\n            style: {\n              width: 10,\n              height: 10,\n              borderRadius: '50%',\n              background: '#ff4d4f',\n              boxShadow: '0 0 12px rgba(255,77,79,.8)',\n              opacity: blink ? 1 : 0.25,\n              transition: 'opacity .15s linear'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 357,\n            columnNumber: 13\n          }, this), \"LIVE\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          children: [totalLaps, \" giri\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 367,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          style: {\n            background: statusColors.chipBg,\n            border: `1px solid ${statusColors.chipBorder}`,\n            color: statusColors.chipText,\n            fontWeight: 800\n          },\n          children: raceStatus\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 368,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rs-live-right\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          children: (circuit === null || circuit === void 0 ? void 0 : circuit.name) || 'Circuito'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 11\n        }, this), (circuit === null || circuit === void 0 ? void 0 : (_circuit$stats = circuit.stats) === null || _circuit$stats === void 0 ? void 0 : _circuit$stats.lengthMeters) && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          children: [circuit.stats.lengthMeters.toFixed(0), \" m\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 382,\n          columnNumber: 44\n        }, this), (circuit === null || circuit === void 0 ? void 0 : (_circuit$params2 = circuit.params) === null || _circuit$params2 === void 0 ? void 0 : _circuit$params2.widthMeters) && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          children: [circuit.params.widthMeters, \" m larghezza\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 383,\n          columnNumber: 44\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 354,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"rs-live-grid\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"track-card\",\n        children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n          ref: canvasRef,\n          className: \"track-canvas\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 390,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 389,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"leaderboard-card\",\n        style: {\n          borderColor: (_statusColors$lbBorde = statusColors.lbBorder) !== null && _statusColors$lbBorde !== void 0 ? _statusColors$lbBorde : 'var(--line)',\n          boxShadow: statusColors.lbBorder ? `0 8px 32px ${statusColors.lbBorder}33, inset 0 0 0 1px ${statusColors.lbBorder}55` : undefined\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lb-title\",\n            children: \"CLASSIFICA\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lb-sub\",\n            children: [board.length, \" piloti\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 405,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 403,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-list\",\n          children: board.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"no-drivers\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Nessun dato GPS ancora disponibile\\u2026\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 411,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n              className: \"muted\",\n              children: \"Appena arrivano i pacchetti la classifica si popola\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 412,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 410,\n            columnNumber: 15\n          }, this) : board.map((d, idx) => {\n            const fastest = (summary === null || summary === void 0 ? void 0 : summary.bestLapOverall) && d.bestLapTime && d.bestLapTime === summary.bestLapOverall;\n            const gapText = idx === 0 ? 'LEADER' : typeof d.gap === 'string' ? `+${d.gap}` : `+${(d.gap || 0).toFixed(2)}`;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `lb-row ${idx === 0 ? 'lb-leader' : ''}`,\n              title: d.fullName,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-pos\",\n                children: idx + 1\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 420,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-team\",\n                children: d.photoTeamUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: `${API_BASE}${d.photoTeamUrl}`,\n                  alt: d.team || '',\n                  className: \"lb-team-logo\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 423,\n                  columnNumber: 25\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"lb-team-color\",\n                  style: {\n                    background: d.color\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 425,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 421,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-name\",\n                children: (d.tag || 'PIL').slice(0, 4)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 428,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-gap\",\n                children: gapText\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 429,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-icons\",\n                children: [fastest && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"lb-icon purple\",\n                  title: `Best lap ${formatLap(d.bestLapTime)}`,\n                  children: \"\\u23F1\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 431,\n                  columnNumber: 35\n                }, this), d.penaltySeconds > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"lb-icon\",\n                  title: `${d.penaltySeconds}s penalità`,\n                  children: \"\\u26A0\\uFE0F\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 432,\n                  columnNumber: 48\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 430,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-lap\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"muted\",\n                  children: \"Lap\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 434,\n                  columnNumber: 45\n                }, this), \"\\xA0\", d.lapCount, \"/\", totalLaps]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 434,\n                columnNumber: 21\n              }, this)]\n            }, d.mac, true, {\n              fileName: _jsxFileName,\n              lineNumber: 419,\n              columnNumber: 19\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 408,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 388,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"leaderboard-card\",\n      style: {\n        marginTop: 12,\n        width: '100%'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lb-header\",\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'baseline'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-title\",\n          children: \"CLASSIFICA DETTAGLIATA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 446,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-sub\",\n          children: [board.length, \" piloti \\u2022 tempi ultimo giro e miglior giro\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lb-list\",\n        children: board.map((d, idx) => {\n          const fastest = (summary === null || summary === void 0 ? void 0 : summary.bestLapOverall) && d.bestLapTime && d.bestLapTime === summary.bestLapOverall;\n          const pen = d.penaltySeconds || 0;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lb-row\",\n            style: {\n              gridTemplateColumns: '28px 28px 1fr 90px 110px 110px 110px'\n            },\n            title: d.fullName,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-pos\",\n              children: idx + 1\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 461,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-team\",\n              children: d.photoTeamUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n                src: `${API_BASE}${d.photoTeamUrl}`,\n                alt: d.team || '',\n                className: \"lb-team-logo\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 465,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-team-color\",\n                style: {\n                  background: d.color\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 467,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 463,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-name\",\n              children: (d.tag || 'PIL').slice(0, 4)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 471,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              style: {\n                textAlign: 'right'\n              },\n              children: idx === 0 ? 'LEADER' : typeof d.gap === 'string' ? `+${d.gap}` : `+${(d.gap || 0).toFixed(2)}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 473,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              title: \"Ultimo giro\",\n              style: {\n                fontWeight: 700\n              },\n              children: formatLap(d.lastLapTime)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 477,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              title: \"Miglior giro\",\n              style: {\n                fontWeight: 700,\n                color: fastest ? '#b085ff' : 'inherit'\n              },\n              children: [formatLap(d.bestLapTime), fastest && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"lb-icon purple\",\n                style: {\n                  marginLeft: 6\n                },\n                children: \"\\u23F1\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 483,\n                columnNumber: 31\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 481,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              title: \"Penalit\\xE0\",\n              style: {\n                fontWeight: 700\n              },\n              children: pen > 0 ? `+${pen}s` : '—'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 486,\n              columnNumber: 17\n            }, this)]\n          }, `wide-${d.mac}`, true, {\n            fileName: _jsxFileName,\n            lineNumber: 455,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 450,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 444,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"leaderboard-card\",\n      style: {\n        marginTop: 12,\n        width: '100%'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lb-header\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-title\",\n          children: \"COMANDI GARA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 498,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 497,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"race-controls\",\n        style: {\n          justifyContent: 'space-between',\n          gap: 12,\n          flexWrap: 'wrap',\n          padding: '20px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            gap: 8,\n            flexWrap: 'wrap'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"muted\",\n            children: \"Stato:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 504,\n            columnNumber: 13\n          }, this), ['IN CORSO', 'FINITA', 'RED FLAG', 'YELLOW FLAG'].map(s => /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn-ghost\",\n            onClick: () => setRaceStatus(s),\n            style: {\n              borderColor: raceStatus === s ? 'rgba(192,255,3,0.6)' : 'var(--line)',\n              boxShadow: raceStatus === s ? '0 0 0 2px rgba(192,255,3,0.12) inset' : 'none',\n              fontWeight: 700\n            },\n            children: s\n          }, s, false, {\n            fileName: _jsxFileName,\n            lineNumber: 506,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 503,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-danger\",\n          onClick: onStopRace,\n          children: \"Termina gara\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 521,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 501,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 496,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 352,\n    columnNumber: 5\n  }, this);\n}\n_s2(RaceLive, \"fU7sNaYGoQ+Wigf6y6wzYTaNtjw=\", false, function () {\n  return [useReliableWebSocket];\n});\n_c = RaceLive;\nvar _c;\n$RefreshReg$(_c, \"RaceLive\");","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","useCallback","jsxDEV","_jsxDEV","API_BASE","process","env","REACT_APP_API_BASE","window","location","hostname","makeWsUrl","REACT_APP_WS_URL","proto","protocol","host","port","REACT_APP_WS_PORT","WS_URL","useReliableWebSocket","url","onMessage","onOpen","onError","_s","wsRef","aliveRef","retryRef","current","connect","ws","WebSocket","onopen","e","onmessage","onerror","onclose","delay","Math","min","setTimeout","readyState","OPEN","CONNECTING","close","formatLap","sec","m","floor","s","toFixed","padStart","RaceLive","raceConfig","onStopRace","_s2","_circuit$stats","_circuit$params2","_statusColors$lbBorde","serverState","setServerState","summary","setSummary","raceStatus","setRaceStatus","canvasRef","zoomRef","panRef","x","y","isDraggingRef","lastMouseRef","animRef","dprRef","circuitRef","driverPositionsRef","blink","setBlink","t","setInterval","b","clearInterval","alive","init","r","fetch","j","json","active","_j$summary","status","circuit","circuitData","totalLaps","pilots","console","error","log","event","msg","JSON","parse","data","type","_msg$payload","payload","pkt","mac","lat","lon","String","row","leaderboard","find","Number","tag","slice","color","photoTeamUrl","canvas","ctx","getContext","dpr","devicePixelRatio","ensureSize","parent","parentElement","w","clientWidth","h","clientHeight","width","height","setTransform","onResize","addEventListener","wheel","preventDefault","max","deltaY","mousedown","clientX","clientY","style","cursor","mousemove","dx","dy","mouseup","passive","projectFactory","_circuit$sectors","sectors","length","lats","map","lons","minLat","maxLat","minLon","maxLon","centerLat","centerLon","R","centerLatRad","PI","dxList","l","cos","dyList","maxDx","abs","maxDy","padding","maxRange","scale","project","draw","_circuit$sectors2","clearRect","fillStyle","fillRect","_circuit$params$width","_circuit$params","_pts$","widthMeters","params","pts","trackPx","strokeStyle","lineWidth","lineCap","lineJoin","beginPath","forEach","p","i","lineTo","moveTo","closePath","stroke","s0","s1","ang","atan2","save","translate","rotate","restore","Object","entries","pos","shadowColor","shadowBlur","arc","fill","font","textAlign","fillText","requestAnimationFrame","removeEventListener","cancelAnimationFrame","board","statusColors","chipBg","chipBorder","chipText","lbBorder","className","children","display","alignItems","gap","borderRadius","background","boxShadow","opacity","transition","fileName","_jsxFileName","lineNumber","columnNumber","border","fontWeight","name","stats","lengthMeters","ref","borderColor","undefined","d","idx","fastest","bestLapOverall","bestLapTime","gapText","title","fullName","src","alt","team","penaltySeconds","lapCount","marginTop","justifyContent","pen","gridTemplateColumns","lastLapTime","marginLeft","flexWrap","onClick","_c","$RefreshReg$"],"sources":["/home/ubuntu/racesense/racesense-frontend/src/pages/RaceLive.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState, useCallback } from 'react';\nimport '../App.css';\n\nconst API_BASE = process.env.REACT_APP_API_BASE || `http://${window.location.hostname}:5000`;\n\n/* ========= WebSocket URL coerente con http/https ========= */\nconst makeWsUrl = () => {\n  if (process.env.REACT_APP_WS_URL) return process.env.REACT_APP_WS_URL; // se definita, prioritaria\n  const proto = window.location.protocol === 'https:' ? 'wss' : 'ws';\n  const host = window.location.hostname;\n  const port = process.env.REACT_APP_WS_PORT || '5001';\n  return `${proto}://${host}${port ? `:${port}` : ''}`;\n};\nconst WS_URL = makeWsUrl();\n\n/* ========= Hook: WebSocket affidabile con auto-reconnect ========= */\nfunction useReliableWebSocket(url, { onMessage, onOpen, onError } = {}) {\n  const wsRef = useRef(null);\n  const aliveRef = useRef(true);\n  const retryRef = useRef(0);\n\n  useEffect(() => {\n    aliveRef.current = true;\n\n    const connect = () => {\n      if (!aliveRef.current) return;\n      try {\n        const ws = new WebSocket(url);\n        wsRef.current = ws;\n\n        ws.onopen = (e) => {\n          retryRef.current = 0;\n          onOpen && onOpen(e);\n        };\n        ws.onmessage = (e) => onMessage && onMessage(e);\n        ws.onerror = (e) => onError && onError(e);\n        ws.onclose = () => {\n          if (!aliveRef.current) return; // unmount\n          const delay = Math.min(1000 * 2 ** retryRef.current, 10000); // backoff max 10s\n          retryRef.current += 1;\n          setTimeout(connect, delay);\n        };\n      } catch {\n        const delay = Math.min(1000 * 2 ** retryRef.current, 10000);\n        retryRef.current += 1;\n        setTimeout(connect, delay);\n      }\n    };\n\n    connect();\n\n    return () => {\n      aliveRef.current = false;\n      try {\n        const ws = wsRef.current;\n        if (ws && (ws.readyState === WebSocket.OPEN || ws.readyState === WebSocket.CONNECTING)) {\n          ws.close();\n        }\n      } catch { }\n    };\n  }, [url, onMessage, onOpen, onError]);\n\n  return wsRef;\n}\n\n/* ========= Utils ========= */\nfunction formatLap(sec) {\n  if (!sec && sec !== 0) return '—';\n  const m = Math.floor(sec / 60);\n  const s = (sec % 60).toFixed(3).padStart(6, '0');\n  return `${m}:${s}`;\n}\n\n/* ========= Component ========= */\nexport default function RaceLive({ raceConfig, onStopRace }) {\n  // Stato dal server (se entro “da spettatore”)\n  const [serverState, setServerState] = useState(null);  // { active, circuit, totalLaps, pilots, summary }\n  const [summary, setSummary] = useState(null);          // { leaderboard, status, bestLapOverall, ... } (1Hz dal server)\n  const [raceStatus, setRaceStatus] = useState('IN CORSO');\n\n  // Canvas & proiezione\n  const canvasRef = useRef(null);\n  const zoomRef = useRef(1);\n  const panRef = useRef({ x: 0, y: 0 });\n  const isDraggingRef = useRef(false);\n  const lastMouseRef = useRef({ x: 0, y: 0 });\n  const animRef = useRef(null);\n  const dprRef = useRef(1);\n  const circuitRef = useRef(null);\n\n  // Posizioni GPS correnti (realtime) per i marker\n  const driverPositionsRef = useRef({}); // mac -> { lat, lon, tag, color, photoTeamUrl }\n\n  // Blink “LIVE”\n  const [blink, setBlink] = useState(true);\n  useEffect(() => {\n    const t = setInterval(() => setBlink(b => !b), 700);\n    return () => clearInterval(t);\n  }, []);\n\n  /* ===== Stato iniziale: se non ho raceConfig locale, tento join gara attiva ===== */\n  useEffect(() => {\n    let alive = true;\n    const init = async () => {\n      try {\n        const r = await fetch(`${API_BASE}/api/race/state`);\n        const j = await r.json();\n        if (!alive) return;\n\n        if (j.active) {\n          setServerState(j);\n          setSummary(j.summary || null);\n          setRaceStatus(j.summary?.status || 'IN CORSO');\n          circuitRef.current = j.circuit || null;\n        } else if (raceConfig?.circuitData) {\n          // fallback: se arrivo da setup con config locale\n          setServerState({\n            active: false,\n            circuit: raceConfig.circuitData,\n            totalLaps: raceConfig.totalLaps,\n            pilots: raceConfig.pilots\n          });\n          circuitRef.current = raceConfig.circuitData;\n        }\n      } catch (e) {\n        console.error('[RaceLive] init error', e);\n        // fallback locale se ho raceConfig\n        if (raceConfig?.circuitData) {\n          setServerState({\n            active: false,\n            circuit: raceConfig.circuitData,\n            totalLaps: raceConfig.totalLaps,\n            pilots: raceConfig.pilots\n          });\n          circuitRef.current = raceConfig.circuitData;\n        }\n      }\n    };\n    init();\n    return () => { alive = false; };\n  }, [raceConfig]);\n\n  /* ===== WebSocket: ricevo GPS (realtime) + summary (1 Hz) ===== */\n  useReliableWebSocket(WS_URL, {\n    onOpen: () => console.log('[RaceLive] WS connesso'),\n    onError: (e) => console.error('[RaceLive] WS error', e),\n    onMessage: (event) => {\n      try {\n        const msg = JSON.parse(event.data);\n\n        // Pacchetto classifica/riepilogo lato server\n        if (msg?.type === 'race') {\n          setSummary(msg.payload || null);\n          if (msg.payload?.status) setRaceStatus(msg.payload.status);\n          return;\n        }\n\n        // Pacchetto GPS (accetto sia {type:'gps', payload} sia payload piatto)\n        const pkt = msg?.type === 'gps' ? (msg.payload || msg) : msg;\n        if (pkt?.mac && pkt?.lat && pkt?.lon) {\n          const mac = String(pkt.mac);\n          // prova a recuperare dallo snapshot di summary (per tag/colore)\n          const row = (summary?.leaderboard || []).find(x => x.mac === mac);\n          driverPositionsRef.current[mac] = {\n            lat: Number(pkt.lat),\n            lon: Number(pkt.lon),\n            tag: (row?.tag || 'PIL').slice(0, 4),\n            color: row?.color || '#C0FF03',\n            photoTeamUrl: row?.photoTeamUrl || null\n          };\n        }\n      } catch { }\n    }\n  });\n\n  /* ===== Canvas draw loop (solo render, niente calcoli di classifica) ===== */\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const ctx = canvas.getContext('2d');\n    const dpr = window.devicePixelRatio || 1;\n    dprRef.current = dpr;\n\n    const ensureSize = () => {\n      const parent = canvas.parentElement;\n      const w = parent.clientWidth || 800;\n      const h = parent.clientHeight || 520;\n      if (canvas.width !== Math.floor(w * dpr) || canvas.height !== Math.floor(h * dpr)) {\n        canvas.width = Math.floor(w * dpr);\n        canvas.height = Math.floor(h * dpr);\n        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n      }\n    };\n    ensureSize();\n    const onResize = () => ensureSize();\n    window.addEventListener('resize', onResize);\n\n    const wheel = (e) => { e.preventDefault(); zoomRef.current = Math.max(0.5, Math.min(5, zoomRef.current * (e.deltaY > 0 ? 0.9 : 1.1))); };\n    const mousedown = (e) => { isDraggingRef.current = true; lastMouseRef.current = { x: e.clientX, y: e.clientY }; canvas.style.cursor = 'grabbing'; };\n    const mousemove = (e) => {\n      if (!isDraggingRef.current) return;\n      const dx = e.clientX - lastMouseRef.current.x;\n      const dy = e.clientY - lastMouseRef.current.y;\n      panRef.current.x += dx; panRef.current.y += dy;\n      lastMouseRef.current = { x: e.clientX, y: e.clientY };\n    };\n    const mouseup = () => { isDraggingRef.current = false; canvas.style.cursor = 'grab'; };\n    canvas.addEventListener('wheel', wheel, { passive: false });\n    canvas.addEventListener('mousedown', mousedown);\n    canvas.addEventListener('mousemove', mousemove);\n    canvas.addEventListener('mouseup', mouseup);\n    canvas.addEventListener('mouseleave', mouseup);\n    canvas.style.cursor = 'grab';\n\n    // proiezione\n    const projectFactory = () => {\n      const circuit = circuitRef.current;\n      if (!circuit?.sectors?.length) return null;\n      const lats = circuit.sectors.map(s => s.lat);\n      const lons = circuit.sectors.map(s => s.lon);\n      const minLat = Math.min(...lats), maxLat = Math.max(...lats);\n      const minLon = Math.min(...lons), maxLon = Math.max(...lons);\n      const centerLat = (minLat + maxLat) / 2;\n      const centerLon = (minLon + maxLon) / 2;\n      const R = 6371000;\n      const centerLatRad = centerLat * Math.PI / 180;\n      const dxList = lons.map(l => (l - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad));\n      const dyList = lats.map(l => (l - centerLat) * Math.PI / 180 * R);\n      const maxDx = Math.max(...dxList.map(Math.abs));\n      const maxDy = Math.max(...dyList.map(Math.abs));\n      const padding = 40;\n      return (lat, lon, w, h) => {\n        const maxRange = Math.max(maxDx, maxDy) * 1.1;\n        const scale = Math.min(w - padding * 2, h - padding * 2) / (maxRange * 2) * zoomRef.current;\n        const dx = (lon - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad);\n        const dy = (lat - centerLat) * Math.PI / 180 * R;\n        const x = w / 2 + dx * scale + panRef.current.x;\n        const y = h / 2 - dy * scale + panRef.current.y;\n        return { x, y, scale };\n      };\n    };\n    let project = projectFactory();\n\n    const draw = () => {\n      ensureSize();\n      const w = canvas.width / dpr;\n      const h = canvas.height / dpr;\n\n      ctx.clearRect(0, 0, w, h);\n      ctx.fillStyle = '#0a0a0a';\n      ctx.fillRect(0, 0, w, h);\n\n      const circuit = circuitRef.current;\n\n      if (circuit?.sectors?.length) {\n        if (!project) project = projectFactory();\n\n        const widthMeters = circuit.params?.widthMeters ?? 6;\n        const pts = circuit.sectors.map(s => project(s.lat, s.lon, w, h));\n        const scale = pts[0]?.scale || 1;\n        const trackPx = Math.max(6, widthMeters * scale);\n\n        // bordo soft\n        ctx.strokeStyle = 'rgba(255,255,255,0.10)';\n        ctx.lineWidth = trackPx + 4;\n        ctx.lineCap = 'round';\n        ctx.lineJoin = 'round';\n        ctx.beginPath();\n        pts.forEach((p, i) => (i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y)));\n        ctx.closePath();\n        ctx.stroke();\n\n        // asfalto\n        ctx.strokeStyle = 'rgba(80, 84, 90, 0.95)';\n        ctx.lineWidth = trackPx;\n        ctx.beginPath();\n        pts.forEach((p, i) => (i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y)));\n        ctx.closePath();\n        ctx.stroke();\n\n        // linea di start\n        if (pts.length > 1) {\n          const s0 = pts[0], s1 = pts[1];\n          const ang = Math.atan2(s1.y - s0.y, s1.x - s0.x);\n          ctx.save();\n          ctx.translate(s0.x, s0.y);\n          ctx.rotate(ang);\n          ctx.strokeStyle = '#ffffff';\n          ctx.lineWidth = Math.max(2, trackPx * 0.12);\n          ctx.beginPath();\n          ctx.moveTo(0, -trackPx * 0.5);\n          ctx.lineTo(0, trackPx * 0.5);\n          ctx.stroke();\n          ctx.restore();\n        }\n      }\n\n      // markers piloti (posizioni arrivate via WS GPS)\n      Object.entries(driverPositionsRef.current).forEach(([mac, pos]) => {\n        if (!project) return;\n        const p = project(pos.lat, pos.lon, w, h);\n        if (!p) return;\n        const r = Math.max(5, 6 * (zoomRef.current * 0.9));\n        ctx.shadowColor = 'rgba(0,0,0,0.5)';\n        ctx.shadowBlur = 4;\n        ctx.fillStyle = pos.color || '#C0FF03';\n        ctx.beginPath();\n        ctx.arc(p.x, p.y, r, 0, Math.PI * 2);\n        ctx.fill();\n        ctx.shadowBlur = 0;\n        ctx.strokeStyle = '#fff';\n        ctx.lineWidth = 2;\n        ctx.stroke();\n\n        ctx.fillStyle = '#fff';\n        ctx.font = 'bold 10px Roboto, sans-serif';\n        ctx.textAlign = 'center';\n        ctx.fillText((pos.tag || 'PIL').slice(0, 4), p.x, p.y - (r + 6));\n      });\n\n      animRef.current = requestAnimationFrame(draw);\n    };\n\n    draw();\n\n    return () => {\n      window.removeEventListener('resize', onResize);\n      canvas.removeEventListener('wheel', wheel);\n      canvas.removeEventListener('mousedown', mousedown);\n      canvas.removeEventListener('mousemove', mousemove);\n      canvas.removeEventListener('mouseup', mouseup);\n      canvas.removeEventListener('mouseleave', mouseup);\n      if (animRef.current) cancelAnimationFrame(animRef.current);\n    };\n  }, []);\n\n  /* ===== Render ===== */\n  const circuit = serverState?.circuit || raceConfig?.circuitData;\n  const board = summary?.leaderboard || [];\n  const totalLaps = summary?.totalLaps || serverState?.totalLaps || raceConfig?.totalLaps || 0;\n\n  const statusColors = useMemo(() => {\n    switch (raceStatus) {\n      case 'RED FLAG': return { chipBg: 'rgba(225,6,0,.15)', chipBorder: '#e10600', chipText: '#ffdede', lbBorder: '#e10600' };\n      case 'YELLOW FLAG': return { chipBg: 'rgba(241,196,15,.15)', chipBorder: '#f1c40f', chipText: '#fff3c4', lbBorder: '#f1c40f' };\n      case 'FINITA': return { chipBg: 'rgba(154,163,154,.15)', chipBorder: '#9aa39a', chipText: '#e0e0e0', lbBorder: '#9aa39a' };\n      default: return { chipBg: 'rgba(21,193,48,.15)', chipBorder: '#15c130', chipText: '#e9ffe0', lbBorder: null };\n    }\n  }, [raceStatus]);\n\n  return (\n    <div className=\"main small-top\">\n      {/* Top bar */}\n      <div className=\"rs-live-topbar\">\n        <div className=\"rs-live-left\">\n          <span className=\"chip readonly\" style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n            <span\n              aria-hidden\n              style={{\n                width: 10, height: 10, borderRadius: '50%',\n                background: '#ff4d4f', boxShadow: '0 0 12px rgba(255,77,79,.8)',\n                opacity: blink ? 1 : 0.25, transition: 'opacity .15s linear'\n              }}\n            />\n            LIVE\n          </span>\n          <span className=\"chip readonly\">{totalLaps} giri</span>\n          <span\n            className=\"chip readonly\"\n            style={{\n              background: statusColors.chipBg,\n              border: `1px solid ${statusColors.chipBorder}`,\n              color: statusColors.chipText,\n              fontWeight: 800\n            }}\n          >\n            {raceStatus}\n          </span>\n        </div>\n        <div className=\"rs-live-right\">\n          <span className=\"chip readonly\">{circuit?.name || 'Circuito'}</span>\n          {circuit?.stats?.lengthMeters && <span className=\"chip readonly\">{circuit.stats.lengthMeters.toFixed(0)} m</span>}\n          {circuit?.params?.widthMeters && <span className=\"chip readonly\">{circuit.params.widthMeters} m larghezza</span>}\n        </div>\n      </div>\n\n      {/* Griglia principale */}\n      <div className=\"rs-live-grid\">\n        <div className=\"track-card\">\n          <canvas ref={canvasRef} className=\"track-canvas\" />\n        </div>\n\n        {/* Classifica laterale (server-side) */}\n        <div\n          className=\"leaderboard-card\"\n          style={{\n            borderColor: statusColors.lbBorder ?? 'var(--line)',\n            boxShadow: statusColors.lbBorder\n              ? `0 8px 32px ${statusColors.lbBorder}33, inset 0 0 0 1px ${statusColors.lbBorder}55`\n              : undefined\n          }}\n        >\n          <div className=\"lb-header\">\n            <div className=\"lb-title\">CLASSIFICA</div>\n            <div className=\"lb-sub\">{board.length} piloti</div>\n          </div>\n\n          <div className=\"lb-list\">\n            {board.length === 0 ? (\n              <div className=\"no-drivers\">\n                <p>Nessun dato GPS ancora disponibile…</p>\n                <small className=\"muted\">Appena arrivano i pacchetti la classifica si popola</small>\n              </div>\n            ) : (\n              board.map((d, idx) => {\n                const fastest = summary?.bestLapOverall && d.bestLapTime && d.bestLapTime === summary.bestLapOverall;\n                const gapText = idx === 0 ? 'LEADER' : (typeof d.gap === 'string' ? `+${d.gap}` : `+${(d.gap || 0).toFixed(2)}`);\n                return (\n                  <div key={d.mac} className={`lb-row ${idx === 0 ? 'lb-leader' : ''}`} title={d.fullName}>\n                    <div className=\"lb-pos\">{idx + 1}</div>\n                    <div className=\"lb-team\">\n                      {d.photoTeamUrl ? (\n                        <img src={`${API_BASE}${d.photoTeamUrl}`} alt={d.team || ''} className=\"lb-team-logo\" />\n                      ) : (\n                        <div className=\"lb-team-color\" style={{ background: d.color }} />\n                      )}\n                    </div>\n                    <div className=\"lb-name\">{(d.tag || 'PIL').slice(0, 4)}</div>\n                    <div className=\"lb-gap\">{gapText}</div>\n                    <div className=\"lb-icons\">\n                      {fastest && <span className=\"lb-icon purple\" title={`Best lap ${formatLap(d.bestLapTime)}`}>⏱</span>}\n                      {d.penaltySeconds > 0 && <span className=\"lb-icon\" title={`${d.penaltySeconds}s penalità`}>⚠️</span>}\n                    </div>\n                    <div className=\"lb-lap\"><span className=\"muted\">Lap</span>&nbsp;{d.lapCount}/{totalLaps}</div>\n                  </div>\n                );\n              })\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Classifica full-width con tempi + penalità */}\n      <div className=\"leaderboard-card\" style={{ marginTop: 12, width: '100%' }}>\n        <div className=\"lb-header\" style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'baseline' }}>\n          <div className=\"lb-title\">CLASSIFICA DETTAGLIATA</div>\n          <div className=\"lb-sub\">{board.length} piloti • tempi ultimo giro e miglior giro</div>\n        </div>\n\n        <div className=\"lb-list\">\n          {board.map((d, idx) => {\n            const fastest = summary?.bestLapOverall && d.bestLapTime && d.bestLapTime === summary.bestLapOverall;\n            const pen = d.penaltySeconds || 0;\n            return (\n              <div\n                key={`wide-${d.mac}`}\n                className=\"lb-row\"\n                style={{ gridTemplateColumns: '28px 28px 1fr 90px 110px 110px 110px' }}\n                title={d.fullName}\n              >\n                <div className=\"lb-pos\">{idx + 1}</div>\n\n                <div className=\"lb-team\">\n                  {d.photoTeamUrl ? (\n                    <img src={`${API_BASE}${d.photoTeamUrl}`} alt={d.team || ''} className=\"lb-team-logo\" />\n                  ) : (\n                    <div className=\"lb-team-color\" style={{ background: d.color }} />\n                  )}\n                </div>\n\n                <div className=\"lb-name\">{(d.tag || 'PIL').slice(0, 4)}</div>\n\n                <div className=\"lb-gap\" style={{ textAlign: 'right' }}>\n                  {idx === 0 ? 'LEADER' : (typeof d.gap === 'string' ? `+${d.gap}` : `+${(d.gap || 0).toFixed(2)}`)}\n                </div>\n\n                <div className=\"lb-gap\" title=\"Ultimo giro\" style={{ fontWeight: 700 }}>\n                  {formatLap(d.lastLapTime)}\n                </div>\n\n                <div className=\"lb-gap\" title=\"Miglior giro\" style={{ fontWeight: 700, color: fastest ? '#b085ff' : 'inherit' }}>\n                  {formatLap(d.bestLapTime)}\n                  {fastest && <span className=\"lb-icon purple\" style={{ marginLeft: 6 }}>⏱</span>}\n                </div>\n\n                <div className=\"lb-gap\" title=\"Penalità\" style={{ fontWeight: 700 }}>\n                  {pen > 0 ? `+${pen}s` : '—'}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* Comandi gara (locale; se vuoi propagarli al server, collega le API) */}\n      <div className=\"leaderboard-card\" style={{ marginTop: 12, width: '100%' }}>\n        <div className=\"lb-header\">\n          <div className=\"lb-title\">COMANDI GARA</div>\n        </div>\n\n        <div className=\"race-controls\" style={{ justifyContent: 'space-between', gap: 12, flexWrap: 'wrap', padding: '20px' }}>\n          {/* Stato gara (solo client-side qui; se vuoi lato server usa POST /api/race/status) */}\n          <div style={{ display: 'flex', alignItems: 'center', gap: 8, flexWrap: 'wrap' }}>\n            <span className=\"muted\">Stato:</span>\n            {['IN CORSO', 'FINITA', 'RED FLAG', 'YELLOW FLAG'].map(s => (\n              <button\n                key={s}\n                className=\"btn-ghost\"\n                onClick={() => setRaceStatus(s)}\n                style={{\n                  borderColor: raceStatus === s ? 'rgba(192,255,3,0.6)' : 'var(--line)',\n                  boxShadow: raceStatus === s ? '0 0 0 2px rgba(192,255,3,0.12) inset' : 'none',\n                  fontWeight: 700\n                }}\n              >\n                {s}\n              </button>\n            ))}\n          </div>\n\n          <button className=\"btn-danger\" onClick={onStopRace}>Termina gara</button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}