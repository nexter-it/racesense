{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/racesense/racesense-frontend/src/pages/RaceLive.jsx\",\n  _s = $RefreshSig$();\n// src/pages/RaceLive.jsx\nimport React, { useState, useEffect, useRef, useMemo } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport '../App.css';\nimport { colorFromName } from '../utils/colors'; // se non l'hai già, te lo ho dato nel messaggio precedente\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE = process.env.REACT_APP_API_BASE || `http://${window.location.hostname}:5000`;\nconst WS_URL = process.env.REACT_APP_WS_URL || `ws://${window.location.hostname}:5001`;\n\n// Limita il rendering a 30fps (non tocca i pacchetti WS)\nconst FRAME_DT_MS = 1000 / 30;\nfunction toRad(d) {\n  return d * Math.PI / 180;\n}\nconst formatLap = s => {\n  if (!s && s !== 0) return '—';\n  const m = Math.floor(s / 60);\n  const sec = (s % 60).toFixed(3);\n  return `${m}:${sec.padStart(6, '0')}`;\n};\nexport default function RaceLive({\n  raceConfig,\n  onStopRace\n}) {\n  _s();\n  var _initCircuit$sectors2, _snapshot$circuit, _ref, _circuitData$stats$le, _circuitData$stats, _initCircuit$stats, _snapshot$circuit2, _snapshot$circuit2$st, _ref2, _circuitData$params$w, _circuitData$params, _initCircuit$params, _snapshot$circuit3, _snapshot$circuit3$pa, _snapshot$totalLaps, _leaderboard$find, _leaderboard$find$pen;\n  const {\n    circuitData,\n    totalLaps\n  } = raceConfig;\n  const navigate = useNavigate();\n  const [snapshot, setSnapshot] = useState(null);\n  const [initCircuit, setInitCircuit] = useState(null);\n  const [blink, setBlink] = useState(true);\n  const [penTargetMac, setPenTargetMac] = useState('');\n  useEffect(() => {\n    const t = setInterval(() => setBlink(b => !b), 700);\n    return () => clearInterval(t);\n  }, []);\n\n  // ---- trails più leggeri + colori\n  const trailsRef = useRef({});\n  const TRAIL_MAX_AGE_MS = 10000;\n  const TRAIL_MAX_LEN = 60;\n  const colorsRef = useRef({});\n  const lastTrailPurgeRef = useRef(0);\n\n  // ---- canvas & interazione\n  const canvasRef = useRef(null);\n  const animFrameRef = useRef(null);\n  const zoomRef = useRef(1);\n  const panRef = useRef({\n    x: 0,\n    y: 0\n  });\n  const isDraggingRef = useRef(false);\n  const lastMouseRef = useRef({\n    x: 0,\n    y: 0\n  });\n\n  // pointer events (pinch/pan)\n  const pointersRef = useRef(new Map());\n  const pinchStartRef = useRef({\n    dist: 0,\n    zoom: 1\n  });\n\n  // ---- websocket\n  useEffect(() => {\n    const ws = new WebSocket(WS_URL);\n    ws.onmessage = async event => {\n      try {\n        const data = JSON.parse(event.data);\n        if ((data === null || data === void 0 ? void 0 : data.type) === 'race_init') {\n          setInitCircuit(data.circuit || null);\n          setSnapshot(s => s ? {\n            ...s,\n            totalLaps: data.totalLaps,\n            raceStatus: data.raceStatus\n          } : s);\n          return;\n        }\n        if ((data === null || data === void 0 ? void 0 : data.type) === 'race_snapshot') {\n          var _initCircuit$sectors, _data$circuit;\n          const now = Date.now();\n          (data.drivers || []).forEach(d => {\n            const keyName = d.fullName || d.tag || d.mac;\n            if (!colorsRef.current[d.mac]) {\n              colorsRef.current[d.mac] = colorFromName(keyName);\n            }\n          });\n          (data.drivers || []).forEach(d => {\n            const t = trailsRef.current[d.mac] || (trailsRef.current[d.mac] = []);\n            t.push({\n              lat: d.lat,\n              lon: d.lon,\n              ts: now\n            });\n            // taglio in-place invece di clonare array\n            if (t.length > TRAIL_MAX_LEN) t.splice(0, t.length - TRAIL_MAX_LEN);\n          });\n          if (!(initCircuit !== null && initCircuit !== void 0 && (_initCircuit$sectors = initCircuit.sectors) !== null && _initCircuit$sectors !== void 0 && _initCircuit$sectors.length) && (_data$circuit = data.circuit) !== null && _data$circuit !== void 0 && _data$circuit.id) {\n            try {\n              const rc = await fetch(`${API_BASE}/api/circuits/${data.circuit.id}`);\n              if (rc.ok) {\n                const full = await rc.json();\n                setInitCircuit({\n                  id: data.circuit.id,\n                  name: full.name || data.circuit.id,\n                  stats: full.stats || {},\n                  params: full.params || {},\n                  sectors: full.sectors || []\n                });\n              }\n            } catch {/* no-op */}\n          }\n          setSnapshot(data);\n        } else if ((data === null || data === void 0 ? void 0 : data.type) === 'race_inactive') {\n          setSnapshot(null);\n        }\n      } catch {}\n    };\n    ws.onerror = e => console.error('[RaceLive] WS error', e);\n    return () => {\n      try {\n        ws.close();\n      } catch {}\n    };\n  }, [initCircuit === null || initCircuit === void 0 ? void 0 : (_initCircuit$sectors2 = initCircuit.sectors) === null || _initCircuit$sectors2 === void 0 ? void 0 : _initCircuit$sectors2.length]);\n\n  // Precompute proiezione circuito in “world coords” (metri) una sola volta\n  const worldGeom = useMemo(() => {\n    var _circuit$sectors;\n    const circuit = circuitData || initCircuit;\n    if (!(circuit !== null && circuit !== void 0 && (_circuit$sectors = circuit.sectors) !== null && _circuit$sectors !== void 0 && _circuit$sectors.length)) return null;\n    const lats = circuit.sectors.map(s => s.lat);\n    const lons = circuit.sectors.map(s => s.lon);\n    const minLat = Math.min(...lats),\n      maxLat = Math.max(...lats);\n    const minLon = Math.min(...lons),\n      maxLon = Math.max(...lons);\n    const centerLat = (minLat + maxLat) / 2;\n    const centerLon = (minLon + maxLon) / 2;\n    const R = 6371000;\n    const cosLat = Math.cos(centerLat * Math.PI / 180);\n    // world points in metri, centrati (0,0)\n    const pts = circuit.sectors.map(s => ({\n      x: (s.lon - centerLon) * Math.PI / 180 * R * cosLat,\n      y: (s.lat - centerLat) * Math.PI / 180 * R * -1 // y verso il basso\n    }));\n    // raggio max per scale\n    const maxDx = Math.max(...pts.map(p => Math.abs(p.x)));\n    const maxDy = Math.max(...pts.map(p => Math.abs(p.y)));\n    const maxRange = Math.max(maxDx, maxDy) * 1.1;\n    // Path2D del tracciato (centerline)\n    const path = new Path2D();\n    pts.forEach((p, i) => i ? path.lineTo(p.x, p.y) : path.moveTo(p.x, p.y));\n    path.closePath();\n    return {\n      pts,\n      path,\n      maxRange,\n      centerLat,\n      centerLon\n    };\n  }, [circuitData, initCircuit]);\n\n  // ---- draw\n  useEffect(() => {\n    var _circuit$sectors2;\n    const circuit = circuitData || initCircuit;\n    if (!circuit || !canvasRef.current || !(circuit !== null && circuit !== void 0 && (_circuit$sectors2 = circuit.sectors) !== null && _circuit$sectors2 !== void 0 && _circuit$sectors2.length)) return;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d', {\n      alpha: false\n    });\n    const dpr = window.devicePixelRatio || 1;\n\n    // importantissimo per mobile (evita lo scroll durante il pinch)\n    canvas.style.touchAction = 'none';\n    const ensureSize = () => {\n      const w = canvas.parentElement.clientWidth || 600;\n      const h = canvas.parentElement.clientHeight || 520;\n      if (canvas.width !== Math.floor(w * dpr) || canvas.height !== Math.floor(h * dpr)) {\n        canvas.width = Math.floor(w * dpr);\n        canvas.height = Math.floor(h * dpr);\n        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n      }\n    };\n    const onResize = () => ensureSize();\n    ensureSize();\n    window.addEventListener('resize', onResize);\n\n    // ---- helpers proiezione\n    if (!worldGeom) return;\n    const padding = 40;\n    const projectWorldToScreen = (wx, wy) => {\n      const w = canvas.width / dpr,\n        h = canvas.height / dpr;\n      const s = Math.min(w - padding * 2, h - padding * 2) / (worldGeom.maxRange * 2) * zoomRef.current;\n      return {\n        x: w / 2 + wx * s + panRef.current.x,\n        y: h / 2 + wy * s + panRef.current.y,\n        scale: s\n      };\n    };\n\n    // ---- interazione mouse\n    const wheel = e => {\n      e.preventDefault();\n      const dir = e.deltaY > 0 ? 0.9 : 1.1;\n      zoomRef.current = Math.max(0.5, Math.min(6, zoomRef.current * dir));\n    };\n    const mousedown = e => {\n      isDraggingRef.current = true;\n      lastMouseRef.current = {\n        x: e.clientX,\n        y: e.clientY\n      };\n      canvas.style.cursor = 'grabbing';\n    };\n    const mousemove = e => {\n      if (!isDraggingRef.current) return;\n      panRef.current.x += e.clientX - lastMouseRef.current.x;\n      panRef.current.y += e.clientY - lastMouseRef.current.y;\n      lastMouseRef.current = {\n        x: e.clientX,\n        y: e.clientY\n      };\n    };\n    const mouseup = () => {\n      isDraggingRef.current = false;\n      canvas.style.cursor = 'grab';\n    };\n    canvas.addEventListener('wheel', wheel, {\n      passive: false\n    });\n    canvas.addEventListener('mousedown', mousedown);\n    canvas.addEventListener('mousemove', mousemove);\n    canvas.addEventListener('mouseup', mouseup);\n    canvas.addEventListener('mouseleave', mouseup);\n    canvas.style.cursor = 'grab';\n\n    // ---- interazione touch (pointer events)\n    const onPointerDown = ev => {\n      var _canvas$setPointerCap;\n      (_canvas$setPointerCap = canvas.setPointerCapture) === null || _canvas$setPointerCap === void 0 ? void 0 : _canvas$setPointerCap.call(canvas, ev.pointerId);\n      pointersRef.current.set(ev.pointerId, {\n        x: ev.clientX,\n        y: ev.clientY\n      });\n      if (pointersRef.current.size === 1) {\n        lastMouseRef.current = {\n          x: ev.clientX,\n          y: ev.clientY\n        };\n      } else if (pointersRef.current.size === 2) {\n        const pts = Array.from(pointersRef.current.values());\n        const dx = pts[0].x - pts[1].x;\n        const dy = pts[0].y - pts[1].y;\n        pinchStartRef.current = {\n          dist: Math.hypot(dx, dy),\n          zoom: zoomRef.current\n        };\n      }\n    };\n    const onPointerMove = ev => {\n      if (!pointersRef.current.has(ev.pointerId)) return;\n      pointersRef.current.set(ev.pointerId, {\n        x: ev.clientX,\n        y: ev.clientY\n      });\n      if (pointersRef.current.size === 1) {\n        const p = pointersRef.current.get(ev.pointerId);\n        panRef.current.x += p.x - lastMouseRef.current.x;\n        panRef.current.y += p.y - lastMouseRef.current.y;\n        lastMouseRef.current = {\n          ...p\n        };\n      } else if (pointersRef.current.size === 2) {\n        const pts = Array.from(pointersRef.current.values());\n        const dx = pts[0].x - pts[1].x;\n        const dy = pts[0].y - pts[1].y;\n        const dist = Math.hypot(dx, dy);\n        if (pinchStartRef.current.dist > 0) {\n          const ratio = dist / pinchStartRef.current.dist;\n          zoomRef.current = Math.max(0.5, Math.min(6, pinchStartRef.current.zoom * ratio));\n        }\n      }\n      ev.preventDefault();\n    };\n    const onPointerUp = ev => {\n      var _canvas$releasePointe;\n      (_canvas$releasePointe = canvas.releasePointerCapture) === null || _canvas$releasePointe === void 0 ? void 0 : _canvas$releasePointe.call(canvas, ev.pointerId);\n      pointersRef.current.delete(ev.pointerId);\n      if (pointersRef.current.size < 2) {\n        pinchStartRef.current.dist = 0;\n      }\n    };\n    canvas.addEventListener('pointerdown', onPointerDown, {\n      passive: false\n    });\n    canvas.addEventListener('pointermove', onPointerMove, {\n      passive: false\n    });\n    canvas.addEventListener('pointerup', onPointerUp);\n    canvas.addEventListener('pointercancel', onPointerUp);\n    canvas.addEventListener('pointerleave', onPointerUp);\n\n    // ---- render\n    const draw = ts => {\n      var _circuit$params$width, _circuit$params;\n      // Cap a 30fps\n      if (!draw.last) draw.last = 0;\n      if (ts - draw.last < FRAME_DT_MS) {\n        animFrameRef.current = requestAnimationFrame(draw);\n        return;\n      }\n      draw.last = ts;\n      ensureSize();\n      const w = canvas.width / dpr,\n        h = canvas.height / dpr;\n\n      // full clear + bg\n      ctx.fillStyle = '#0a0a0a';\n      ctx.fillRect(0, 0, w, h);\n      const widthMeters = (_circuit$params$width = (_circuit$params = circuit.params) === null || _circuit$params === void 0 ? void 0 : _circuit$params.widthMeters) !== null && _circuit$params$width !== void 0 ? _circuit$params$width : 6;\n      const s0 = projectWorldToScreen(0, 0).scale;\n      const trackPx = Math.max(6, widthMeters * s0);\n\n      // Disegno tracciato con Path2D in world coords → proiettato via iterazione veloce\n      // BORDO/SETTORI (come prima ma iterando sugli indici worldGeom.pts)\n      const sectors = circuit.customSectors || (circuitData === null || circuitData === void 0 ? void 0 : circuitData.customSectors) || (initCircuit === null || initCircuit === void 0 ? void 0 : initCircuit.customSectors) || [];\n      if (Array.isArray(sectors) && sectors.length > 0) {\n        sectors.forEach((sector, idx) => {\n          var _sector$startIdx, _sector$endIdx;\n          const start = Math.max(0, Math.min((_sector$startIdx = sector.startIdx) !== null && _sector$startIdx !== void 0 ? _sector$startIdx : 0, worldGeom.pts.length - 1));\n          const end = Math.max(0, Math.min((_sector$endIdx = sector.endIdx) !== null && _sector$endIdx !== void 0 ? _sector$endIdx : 0, worldGeom.pts.length - 1));\n          if (end <= start) return;\n          const color = sector.color || ['#ff0000', '#00ff00', '#0000ff'][idx % 3];\n          ctx.save();\n          ctx.lineCap = 'round';\n          ctx.lineJoin = 'round';\n          ctx.strokeStyle = color;\n          ctx.lineWidth = trackPx + 3;\n          ctx.globalAlpha = 0.35;\n          ctx.beginPath();\n          for (let i = start; i <= end; i++) {\n            const p = projectWorldToScreen(worldGeom.pts[i].x, worldGeom.pts[i].y);\n            if (i === start) ctx.moveTo(p.x, p.y);else ctx.lineTo(p.x, p.y);\n          }\n          ctx.stroke();\n          ctx.restore();\n        });\n      } else {\n        // fallback bordo unico\n        ctx.strokeStyle = 'rgba(255,255,255,0.10)';\n        ctx.lineWidth = trackPx + 3;\n        ctx.lineCap = 'round';\n        ctx.lineJoin = 'round';\n        ctx.beginPath();\n        worldGeom.pts.forEach((wp, i) => {\n          const p = projectWorldToScreen(wp.x, wp.y);\n          if (i) ctx.lineTo(p.x, p.y);else ctx.moveTo(p.x, p.y);\n        });\n        ctx.closePath();\n        ctx.stroke();\n      }\n      // Asfalto\n      ctx.strokeStyle = 'rgba(80,84,90,0.95)';\n      ctx.lineWidth = trackPx;\n      ctx.lineCap = 'round';\n      ctx.lineJoin = 'round';\n      ctx.beginPath();\n      worldGeom.pts.forEach((wp, i) => {\n        const p = projectWorldToScreen(wp.x, wp.y);\n        if (i) ctx.lineTo(p.x, p.y);else ctx.moveTo(p.x, p.y);\n      });\n      ctx.closePath();\n      ctx.stroke();\n\n      // linea start\n      if (worldGeom.pts.length > 1) {\n        const p0 = projectWorldToScreen(worldGeom.pts[0].x, worldGeom.pts[0].y);\n        const p1 = projectWorldToScreen(worldGeom.pts[1].x, worldGeom.pts[1].y);\n        const ang = Math.atan2(p1.y - p0.y, p1.x - p0.x);\n        ctx.save();\n        ctx.translate(s0.x, s0.y);\n        ctx.rotate(ang);\n        ctx.strokeStyle = '#ffffff';\n        ctx.lineWidth = Math.max(2, trackPx * 0.12);\n        ctx.beginPath();\n        ctx.moveTo(0, -trackPx * 0.5);\n        ctx.lineTo(0, trackPx * 0.5);\n        ctx.stroke();\n        ctx.restore();\n      }\n\n      // trails clean\n      const now = Date.now();\n      Object.keys(trailsRef.current).forEach(k => {\n        trailsRef.current[k] = (trailsRef.current[k] || []).filter(p => now - p.ts <= TRAIL_MAX_AGE_MS).slice(-TRAIL_MAX_LEN);\n      });\n      const drivers = (snapshot === null || snapshot === void 0 ? void 0 : snapshot.drivers) || [];\n      const sorted = [...drivers].sort((a, b) => a.position - b.position);\n      sorted.forEach((d, i) => {\n        const color = colorsRef.current[d.mac] || colorFromName(d.fullName || d.tag || d.mac);\n        const trail = trailsRef.current[d.mac] || [];\n        if (trail.length > 1) {\n          for (let t = 1; t < trail.length; t++) {\n            const prev = project(trail[t - 1].lat, trail[t - 1].lon);\n            const cur = project(trail[t].lat, trail[t].lon);\n            const ageFrac = Math.min(1, (now - trail[t].ts) / TRAIL_MAX_AGE_MS);\n            const alpha = 0.75 * (1 - ageFrac);\n            let rgba = color;\n            if (color.startsWith('#')) {\n              const hex = color.slice(1);\n              const full = hex.length === 3 ? hex.split('').map(c => c + c).join('') : hex;\n              const v = parseInt(full, 16),\n                r = v >> 16 & 255,\n                g = v >> 8 & 255,\n                b = v & 255;\n              rgba = `rgba(${r},${g},${b},${alpha})`;\n            }\n            ctx.strokeStyle = rgba;\n            ctx.lineWidth = Math.max(2, trackPx * 0.12);\n            ctx.beginPath();\n            ctx.moveTo(prev.x, prev.y);\n            ctx.lineTo(cur.x, cur.y);\n            ctx.stroke();\n          }\n        }\n        const p = project(d.lat, d.lon);\n        const r = Math.max(5, trackPx * 0.18) + (i === 0 ? 1 : 0);\n        let fill = color;\n        if (fill.startsWith('#')) {\n          const hex = fill.slice(1);\n          const full = hex.length === 3 ? hex.split('').map(c => c + c).join('') : hex;\n          const v = parseInt(full, 16),\n            rr = v >> 16 & 255,\n            gg = v >> 8 & 255,\n            bb = v & 255;\n          fill = `rgba(${rr},${gg},${bb},1)`;\n        }\n        ctx.shadowColor = 'rgba(0,0,0,0.5)';\n        ctx.shadowBlur = 4;\n        ctx.fillStyle = fill;\n        ctx.beginPath();\n        ctx.arc(p.x, p.y, r, 0, Math.PI * 2);\n        ctx.fill();\n        ctx.shadowBlur = 0;\n        ctx.strokeStyle = '#fff';\n        ctx.lineWidth = 2;\n        ctx.stroke();\n        ctx.fillStyle = '#fff';\n        ctx.font = 'bold 10px Roboto, sans-serif';\n        ctx.textAlign = 'center';\n        ctx.fillText(d.tag, p.x, p.y - (r + 8));\n      });\n      animFrameRef.current = requestAnimationFrame(draw);\n    };\n    draw();\n    return () => {\n      window.removeEventListener('resize', onResize);\n      canvas.removeEventListener('wheel', wheel);\n      canvas.removeEventListener('mousedown', mousedown);\n      canvas.removeEventListener('mousemove', mousemove);\n      canvas.removeEventListener('mouseup', mouseup);\n      canvas.removeEventListener('mouseleave', mouseup);\n      canvas.removeEventListener('pointerdown', onPointerDown);\n      canvas.removeEventListener('pointermove', onPointerMove);\n      canvas.removeEventListener('pointerup', onPointerUp);\n      canvas.removeEventListener('pointercancel', onPointerUp);\n      canvas.removeEventListener('pointerleave', onPointerUp);\n      if (animFrameRef.current) cancelAnimationFrame(animFrameRef.current);\n    };\n  }, [circuitData, initCircuit, snapshot]);\n  const leaderboard = useMemo(() => !(snapshot !== null && snapshot !== void 0 && snapshot.drivers) ? [] : [...snapshot.drivers].sort((a, b) => a.position - b.position), [snapshot]);\n  const globalBestLap = (snapshot === null || snapshot === void 0 ? void 0 : snapshot.globalBestLap) || null;\n\n  // chip di stato (no border)\n  const statusChipStyle = useMemo(() => {\n    const s = (snapshot === null || snapshot === void 0 ? void 0 : snapshot.raceStatus) || 'IN CORSO';\n    switch (s) {\n      case 'RED FLAG':\n        return {\n          background: 'rgba(225,6,0,.22)',\n          color: '#ffdede'\n        };\n      case 'YELLOW FLAG':\n        return {\n          background: 'rgba(241,196,15,.22)',\n          color: '#fff3c4'\n        };\n      case 'FINITA':\n        return {\n          background: 'rgba(154,163,154,.22)',\n          color: '#f0f0f0'\n        };\n      default:\n        return {\n          background: 'rgba(21,193,48,.22)',\n          color: '#dfffe9'\n        };\n    }\n  }, [snapshot === null || snapshot === void 0 ? void 0 : snapshot.raceStatus]);\n  const sendStatus = async status => {\n    try {\n      await fetch(`${API_BASE}/api/race/status`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          status\n        })\n      });\n    } catch (e) {\n      console.error(e);\n    }\n  };\n  const sendPenalty = async type => {\n    if (!penTargetMac) return;\n    try {\n      await fetch(`${API_BASE}/api/race/penalty`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          mac: penTargetMac,\n          type\n        })\n      });\n    } catch (e) {\n      console.error(e);\n    }\n  };\n  const circuitName = (circuitData === null || circuitData === void 0 ? void 0 : circuitData.name) || (initCircuit === null || initCircuit === void 0 ? void 0 : initCircuit.name) || (snapshot === null || snapshot === void 0 ? void 0 : (_snapshot$circuit = snapshot.circuit) === null || _snapshot$circuit === void 0 ? void 0 : _snapshot$circuit.name) || 'Circuito';\n  const circuitStatsLen = (_ref = (_circuitData$stats$le = circuitData === null || circuitData === void 0 ? void 0 : (_circuitData$stats = circuitData.stats) === null || _circuitData$stats === void 0 ? void 0 : _circuitData$stats.lengthMeters) !== null && _circuitData$stats$le !== void 0 ? _circuitData$stats$le : initCircuit === null || initCircuit === void 0 ? void 0 : (_initCircuit$stats = initCircuit.stats) === null || _initCircuit$stats === void 0 ? void 0 : _initCircuit$stats.lengthMeters) !== null && _ref !== void 0 ? _ref : snapshot === null || snapshot === void 0 ? void 0 : (_snapshot$circuit2 = snapshot.circuit) === null || _snapshot$circuit2 === void 0 ? void 0 : (_snapshot$circuit2$st = _snapshot$circuit2.stats) === null || _snapshot$circuit2$st === void 0 ? void 0 : _snapshot$circuit2$st.lengthMeters;\n  const circuitWidth = (_ref2 = (_circuitData$params$w = circuitData === null || circuitData === void 0 ? void 0 : (_circuitData$params = circuitData.params) === null || _circuitData$params === void 0 ? void 0 : _circuitData$params.widthMeters) !== null && _circuitData$params$w !== void 0 ? _circuitData$params$w : initCircuit === null || initCircuit === void 0 ? void 0 : (_initCircuit$params = initCircuit.params) === null || _initCircuit$params === void 0 ? void 0 : _initCircuit$params.widthMeters) !== null && _ref2 !== void 0 ? _ref2 : snapshot === null || snapshot === void 0 ? void 0 : (_snapshot$circuit3 = snapshot.circuit) === null || _snapshot$circuit3 === void 0 ? void 0 : (_snapshot$circuit3$pa = _snapshot$circuit3.params) === null || _snapshot$circuit3$pa === void 0 ? void 0 : _snapshot$circuit3$pa.widthMeters;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main small-top\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"rs-live-topbar rs-live-topbar--glass\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rs-chip-row\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly live-pill\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            \"aria-hidden\": true,\n            className: `live-dot ${blink ? 'on' : 'off'}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 402,\n            columnNumber: 13\n          }, this), \" LIVE\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 401,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly pill\",\n          children: [(_snapshot$totalLaps = snapshot === null || snapshot === void 0 ? void 0 : snapshot.totalLaps) !== null && _snapshot$totalLaps !== void 0 ? _snapshot$totalLaps : totalLaps, \" giri\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 404,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly pill\",\n          style: {\n            ...statusChipStyle,\n            fontWeight: 900\n          },\n          children: (snapshot === null || snapshot === void 0 ? void 0 : snapshot.raceStatus) || 'IN CORSO'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 405,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly pill\",\n          children: circuitName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 406,\n          columnNumber: 11\n        }, this), circuitStatsLen && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly pill\",\n          children: [(+circuitStatsLen).toFixed(0), \" m\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 407,\n          columnNumber: 32\n        }, this), circuitWidth && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly pill\",\n          children: [circuitWidth, \" m larghezza\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 408,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 400,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"rs-live-grid\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"track-card\",\n        children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n          ref: canvasRef,\n          className: \"track-canvas\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 413,\n          columnNumber: 37\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 413,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"leaderboard-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lb-title\",\n            children: \"CLASSIFICA\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 416,\n            columnNumber: 38\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lb-sub\",\n            children: [leaderboard.length, \" piloti\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 416,\n            columnNumber: 80\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 416,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-list\",\n          children: leaderboard.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"no-drivers\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Nessun dato GPS ancora disponibile\\u2026\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 420,\n              columnNumber: 43\n            }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n              className: \"muted\",\n              children: \"Appena arrivano i pacchetti la classifica si popola\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 420,\n              columnNumber: 85\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 420,\n            columnNumber: 15\n          }, this) : leaderboard.map((d, idx) => {\n            var _snapshot$totalLaps2;\n            const isLeader = idx === 0;\n            const fastest = d.bestLapTime && globalBestLap && d.bestLapTime === globalBestLap;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `lb-row ${isLeader ? 'lb-leader' : ''}`,\n              title: `${d.fullName} — Clicca per seguire`,\n              role: \"button\",\n              tabIndex: 0,\n              onClick: () => navigate(`/pilot/${d.mac}`),\n              onKeyDown: e => {\n                if (e.key === 'Enter') navigate(`/pilot/${d.mac}`);\n              },\n              style: {\n                cursor: 'pointer'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-pos\",\n                children: idx + 1\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 436,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-team\",\n                children: d.photoTeamUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: `${API_BASE}${d.photoTeamUrl}`,\n                  alt: d.team,\n                  className: \"lb-team-logo\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 439,\n                  columnNumber: 25\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"lb-team-color\",\n                  style: {\n                    background: colorsRef.current[d.mac] || colorFromName(d.fullName || d.tag || d.mac)\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 441,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 437,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-name\",\n                children: d.tag\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 444,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-gap\",\n                children: d.gapToLeader || (isLeader ? 'LEADER' : '')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 445,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-icons\",\n                children: fastest && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"lb-icon purple\",\n                  title: `Best lap ${formatLap(d.bestLapTime)}`,\n                  children: \"\\u23F1\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 446,\n                  columnNumber: 59\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 446,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-lap\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"muted\",\n                  children: \"Lap\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 447,\n                  columnNumber: 45\n                }, this), \"\\xA0\", d.lapCount, \"/\", (_snapshot$totalLaps2 = snapshot === null || snapshot === void 0 ? void 0 : snapshot.totalLaps) !== null && _snapshot$totalLaps2 !== void 0 ? _snapshot$totalLaps2 : totalLaps]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 447,\n                columnNumber: 21\n              }, this)]\n            }, d.mac, true, {\n              fileName: _jsxFileName,\n              lineNumber: 426,\n              columnNumber: 19\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 418,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 415,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 412,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"leaderboard-card\",\n      style: {\n        marginTop: 12,\n        width: '100%'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lb-header\",\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'baseline'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-title\",\n          children: \"CLASSIFICA DETTAGLIATA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 459,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-sub\",\n          children: [leaderboard.length, \" piloti \\u2022 tempi ultimo giro e miglior giro\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 460,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 458,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lb-row\",\n        style: {\n          gridTemplateColumns: '28px 28px 1fr 90px 90px 90px 90px 110px 110px 140px 90px',\n          fontWeight: 800,\n          background: 'rgba(255,255,255,0.05)',\n          borderBottom: '1px solid rgba(255,255,255,0.1)',\n          color: 'rgba(206, 206, 206, 0.72)',\n          marginLeft: '10px',\n          marginRight: '10px',\n          marginTop: '15px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"P\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 478,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"Team\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 479,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"Pilota\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 480,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            textAlign: 'right'\n          },\n          children: \"GAP\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 481,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            textAlign: 'right'\n          },\n          children: \"S1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 482,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            textAlign: 'right'\n          },\n          children: \"S2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 483,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            textAlign: 'right'\n          },\n          children: \"S3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 484,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            textAlign: 'right'\n          },\n          children: \"Ultimo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 485,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            textAlign: 'right'\n          },\n          children: \"Migliore\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 486,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            textAlign: 'right'\n          },\n          children: \"Sanzioni\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 487,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            textAlign: 'right'\n          },\n          children: \"Giri\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 488,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 464,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lb-list\",\n        children: leaderboard.map((d, idx) => {\n          var _d$lastSectorTimes$S, _d$lastSectorTimes, _d$sectorTimes, _d$lastSectorTimes$S2, _d$lastSectorTimes2, _d$sectorTimes2, _d$lastSectorTimes$S3, _d$lastSectorTimes3, _d$sectorTimes3, _d$penalty, _snapshot$totalLaps3;\n          const fastest = d.bestLapTime && globalBestLap && d.bestLapTime === globalBestLap;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lb-row\",\n            style: {\n              gridTemplateColumns: '28px 28px 1fr 90px 90px 90px 90px 110px 110px 140px 90px',\n              cursor: 'pointer'\n            },\n            title: `${d.fullName} — Clicca per seguire`,\n            onClick: () => navigate(`/pilot/${d.mac}`),\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-pos\",\n              children: idx + 1\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 506,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-team\",\n              children: d.photoTeamUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n                src: `${API_BASE}${d.photoTeamUrl}`,\n                alt: d.team,\n                className: \"lb-team-logo\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 509,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-team-color\",\n                style: {\n                  background: colorsRef.current[d.mac] || colorFromName(d.fullName || d.tag || d.mac)\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 511,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 507,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-name\",\n              children: d.tag\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 521,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              style: {\n                textAlign: 'right'\n              },\n              children: idx === 0 ? 'LEADER' : d.gapToLeader\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 524,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              title: \"Settore 1\",\n              style: {\n                color: '#fff'\n              },\n              children: formatLap((_d$lastSectorTimes$S = (_d$lastSectorTimes = d.lastSectorTimes) === null || _d$lastSectorTimes === void 0 ? void 0 : _d$lastSectorTimes.S1) !== null && _d$lastSectorTimes$S !== void 0 ? _d$lastSectorTimes$S : (_d$sectorTimes = d.sectorTimes) === null || _d$sectorTimes === void 0 ? void 0 : _d$sectorTimes.S1)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 529,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              title: \"Settore 2\",\n              style: {\n                color: '#fff'\n              },\n              children: formatLap((_d$lastSectorTimes$S2 = (_d$lastSectorTimes2 = d.lastSectorTimes) === null || _d$lastSectorTimes2 === void 0 ? void 0 : _d$lastSectorTimes2.S2) !== null && _d$lastSectorTimes$S2 !== void 0 ? _d$lastSectorTimes$S2 : (_d$sectorTimes2 = d.sectorTimes) === null || _d$sectorTimes2 === void 0 ? void 0 : _d$sectorTimes2.S2)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 532,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              title: \"Settore 3\",\n              style: {\n                color: '#fff'\n              },\n              children: formatLap((_d$lastSectorTimes$S3 = (_d$lastSectorTimes3 = d.lastSectorTimes) === null || _d$lastSectorTimes3 === void 0 ? void 0 : _d$lastSectorTimes3.S3) !== null && _d$lastSectorTimes$S3 !== void 0 ? _d$lastSectorTimes$S3 : (_d$sectorTimes3 = d.sectorTimes) === null || _d$sectorTimes3 === void 0 ? void 0 : _d$sectorTimes3.S3)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 535,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              title: \"Ultimo giro\",\n              style: {\n                fontWeight: 700,\n                color: '#e9ffe0'\n              },\n              children: formatLap(d.lastLapTime)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 540,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              title: \"Miglior giro\",\n              style: {\n                fontWeight: 700,\n                color: fastest ? '#b085ff' : '#e9ffe0'\n              },\n              children: [formatLap(d.bestLapTime), fastest && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"lb-icon purple\",\n                style: {\n                  marginLeft: 6\n                },\n                children: \"\\u23F1\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 559,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 549,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              title: \"Penalit\\xE0 assegnate\",\n              style: {\n                fontWeight: 800\n              },\n              children: (d === null || d === void 0 ? void 0 : (_d$penalty = d.penalty) === null || _d$penalty === void 0 ? void 0 : _d$penalty.summary) || '—'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 565,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-lap\",\n              style: {\n                textAlign: 'right'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"muted\",\n                children: \"Lap\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 573,\n                columnNumber: 19\n              }, this), \"\\xA0\", d.lapCount, \"/\", (_snapshot$totalLaps3 = snapshot === null || snapshot === void 0 ? void 0 : snapshot.totalLaps) !== null && _snapshot$totalLaps3 !== void 0 ? _snapshot$totalLaps3 : totalLaps]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 572,\n              columnNumber: 17\n            }, this)]\n          }, `wide-${d.mac}`, true, {\n            fileName: _jsxFileName,\n            lineNumber: 495,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 491,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 457,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"leaderboard-card\",\n      style: {\n        marginTop: 12,\n        width: '100%'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lb-header\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-title\",\n          children: \"COMANDI GARA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 584,\n          columnNumber: 36\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 584,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"race-controls\",\n        style: {\n          justifyContent: 'space-between',\n          gap: 12,\n          flexWrap: 'wrap',\n          padding: '20px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            gap: 8,\n            flexWrap: 'wrap'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"muted\",\n            children: \"Stato:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 587,\n            columnNumber: 13\n          }, this), ['IN CORSO', 'FINITA', 'RED FLAG', 'YELLOW FLAG'].map(s => /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn-ghost\",\n            onClick: () => sendStatus(s),\n            style: {\n              fontWeight: 700\n            },\n            children: s\n          }, s, false, {\n            fileName: _jsxFileName,\n            lineNumber: 589,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 586,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            gap: 8,\n            flexWrap: 'wrap',\n            marginTop: '15px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"muted\",\n            children: \"Sanzioni:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 594,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            className: \"input\",\n            value: penTargetMac,\n            onChange: e => setPenTargetMac(e.target.value),\n            style: {\n              width: 260\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"-- Seleziona pilota --\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 596,\n              columnNumber: 15\n            }, this), leaderboard.map(d => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: d.mac,\n              children: [d.tag, \" \\u2014 \", d.fullName]\n            }, d.mac, true, {\n              fileName: _jsxFileName,\n              lineNumber: 597,\n              columnNumber: 38\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 595,\n            columnNumber: 13\n          }, this), ['+5s', '+10s', '+15s', '1mo avv. squalifica', 'squalifica'].map(k => /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn-ghost\",\n            disabled: !penTargetMac,\n            onClick: () => sendPenalty(k),\n            style: {\n              fontWeight: 800\n            },\n            children: k\n          }, k, false, {\n            fileName: _jsxFileName,\n            lineNumber: 600,\n            columnNumber: 15\n          }, this)), penTargetMac && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"muted\",\n            style: {\n              marginLeft: 6\n            },\n            children: [\"Attuale: \", /*#__PURE__*/_jsxDEV(\"b\", {\n              children: ((_leaderboard$find = leaderboard.find(d => d.mac === penTargetMac)) === null || _leaderboard$find === void 0 ? void 0 : (_leaderboard$find$pen = _leaderboard$find.penalty) === null || _leaderboard$find$pen === void 0 ? void 0 : _leaderboard$find$pen.summary) || '—'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 602,\n              columnNumber: 89\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 602,\n            columnNumber: 30\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 593,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          style: {\n            marginTop: '20px'\n          },\n          className: \"btn-danger\",\n          onClick: async () => {\n            try {\n              await fetch(`${API_BASE}/api/race/stop`, {\n                method: 'POST'\n              });\n            } catch {}\n            ;\n            onStopRace();\n          },\n          children: \"Termina gara\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 605,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 585,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 583,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 395,\n    columnNumber: 5\n  }, this);\n}\n_s(RaceLive, \"ORWc070tQRRQ+Jhyc/tb0KqFymk=\", false, function () {\n  return [useNavigate];\n});\n_c = RaceLive;\nvar _c;\n$RefreshReg$(_c, \"RaceLive\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useMemo","useNavigate","colorFromName","jsxDEV","_jsxDEV","API_BASE","process","env","REACT_APP_API_BASE","window","location","hostname","WS_URL","REACT_APP_WS_URL","FRAME_DT_MS","toRad","d","Math","PI","formatLap","s","m","floor","sec","toFixed","padStart","RaceLive","raceConfig","onStopRace","_s","_initCircuit$sectors2","_snapshot$circuit","_ref","_circuitData$stats$le","_circuitData$stats","_initCircuit$stats","_snapshot$circuit2","_snapshot$circuit2$st","_ref2","_circuitData$params$w","_circuitData$params","_initCircuit$params","_snapshot$circuit3","_snapshot$circuit3$pa","_snapshot$totalLaps","_leaderboard$find","_leaderboard$find$pen","circuitData","totalLaps","navigate","snapshot","setSnapshot","initCircuit","setInitCircuit","blink","setBlink","penTargetMac","setPenTargetMac","t","setInterval","b","clearInterval","trailsRef","TRAIL_MAX_AGE_MS","TRAIL_MAX_LEN","colorsRef","lastTrailPurgeRef","canvasRef","animFrameRef","zoomRef","panRef","x","y","isDraggingRef","lastMouseRef","pointersRef","Map","pinchStartRef","dist","zoom","ws","WebSocket","onmessage","event","data","JSON","parse","type","circuit","raceStatus","_initCircuit$sectors","_data$circuit","now","Date","drivers","forEach","keyName","fullName","tag","mac","current","push","lat","lon","ts","length","splice","sectors","id","rc","fetch","ok","full","json","name","stats","params","onerror","e","console","error","close","worldGeom","_circuit$sectors","lats","map","lons","minLat","min","maxLat","max","minLon","maxLon","centerLat","centerLon","R","cosLat","cos","pts","maxDx","p","abs","maxDy","maxRange","path","Path2D","i","lineTo","moveTo","closePath","_circuit$sectors2","canvas","ctx","getContext","alpha","dpr","devicePixelRatio","style","touchAction","ensureSize","w","parentElement","clientWidth","h","clientHeight","width","height","setTransform","onResize","addEventListener","padding","projectWorldToScreen","wx","wy","scale","wheel","preventDefault","dir","deltaY","mousedown","clientX","clientY","cursor","mousemove","mouseup","passive","onPointerDown","ev","_canvas$setPointerCap","setPointerCapture","call","pointerId","set","size","Array","from","values","dx","dy","hypot","onPointerMove","has","get","ratio","onPointerUp","_canvas$releasePointe","releasePointerCapture","delete","draw","_circuit$params$width","_circuit$params","last","requestAnimationFrame","fillStyle","fillRect","widthMeters","s0","trackPx","customSectors","isArray","sector","idx","_sector$startIdx","_sector$endIdx","start","startIdx","end","endIdx","color","save","lineCap","lineJoin","strokeStyle","lineWidth","globalAlpha","beginPath","stroke","restore","wp","p0","p1","ang","atan2","translate","rotate","Object","keys","k","filter","slice","sorted","sort","a","position","trail","prev","project","cur","ageFrac","rgba","startsWith","hex","split","c","join","v","parseInt","r","g","fill","rr","gg","bb","shadowColor","shadowBlur","arc","font","textAlign","fillText","removeEventListener","cancelAnimationFrame","leaderboard","globalBestLap","statusChipStyle","background","sendStatus","status","method","headers","body","stringify","sendPenalty","circuitName","circuitStatsLen","lengthMeters","circuitWidth","className","children","fileName","_jsxFileName","lineNumber","columnNumber","fontWeight","ref","_snapshot$totalLaps2","isLeader","fastest","bestLapTime","title","role","tabIndex","onClick","onKeyDown","key","photoTeamUrl","src","alt","team","gapToLeader","lapCount","marginTop","display","justifyContent","alignItems","gridTemplateColumns","borderBottom","marginLeft","marginRight","_d$lastSectorTimes$S","_d$lastSectorTimes","_d$sectorTimes","_d$lastSectorTimes$S2","_d$lastSectorTimes2","_d$sectorTimes2","_d$lastSectorTimes$S3","_d$lastSectorTimes3","_d$sectorTimes3","_d$penalty","_snapshot$totalLaps3","lastSectorTimes","S1","sectorTimes","S2","S3","lastLapTime","penalty","summary","gap","flexWrap","value","onChange","target","disabled","find","_c","$RefreshReg$"],"sources":["/home/ubuntu/racesense/racesense-frontend/src/pages/RaceLive.jsx"],"sourcesContent":["// src/pages/RaceLive.jsx\nimport React, { useState, useEffect, useRef, useMemo } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport '../App.css';\nimport { colorFromName } from '../utils/colors'; // se non l'hai già, te lo ho dato nel messaggio precedente\n\nconst API_BASE = process.env.REACT_APP_API_BASE || `http://${window.location.hostname}:5000`;\nconst WS_URL = process.env.REACT_APP_WS_URL || `ws://${window.location.hostname}:5001`;\n\n// Limita il rendering a 30fps (non tocca i pacchetti WS)\nconst FRAME_DT_MS = 1000 / 30;\n\nfunction toRad(d) { return d * Math.PI / 180; }\nconst formatLap = (s) => {\n  if (!s && s !== 0) return '—';\n  const m = Math.floor(s / 60);\n  const sec = (s % 60).toFixed(3);\n  return `${m}:${sec.padStart(6, '0')}`;\n};\n\nexport default function RaceLive({ raceConfig, onStopRace }) {\n  const { circuitData, totalLaps } = raceConfig;\n  const navigate = useNavigate();\n\n  const [snapshot, setSnapshot] = useState(null);\n  const [initCircuit, setInitCircuit] = useState(null);\n  const [blink, setBlink] = useState(true);\n  const [penTargetMac, setPenTargetMac] = useState('');\n  useEffect(() => { const t = setInterval(() => setBlink(b => !b), 700); return () => clearInterval(t); }, []);\n\n  // ---- trails più leggeri + colori\n  const trailsRef = useRef({});\n  const TRAIL_MAX_AGE_MS = 10000;\n  const TRAIL_MAX_LEN = 60;\n  const colorsRef = useRef({});\n  const lastTrailPurgeRef = useRef(0);\n\n  // ---- canvas & interazione\n  const canvasRef = useRef(null);\n  const animFrameRef = useRef(null);\n  const zoomRef = useRef(1);\n  const panRef = useRef({ x: 0, y: 0 });\n  const isDraggingRef = useRef(false);\n  const lastMouseRef = useRef({ x: 0, y: 0 });\n\n  // pointer events (pinch/pan)\n  const pointersRef = useRef(new Map());\n  const pinchStartRef = useRef({ dist: 0, zoom: 1 });\n\n  // ---- websocket\n  useEffect(() => {\n    const ws = new WebSocket(WS_URL);\n    ws.onmessage = async (event) => {\n      try {\n        const data = JSON.parse(event.data);\n\n        if (data?.type === 'race_init') {\n          setInitCircuit(data.circuit || null);\n          setSnapshot(s => s ? { ...s, totalLaps: data.totalLaps, raceStatus: data.raceStatus } : s);\n          return;\n        }\n\n        if (data?.type === 'race_snapshot') {\n          const now = Date.now();\n\n          (data.drivers || []).forEach(d => {\n            const keyName = d.fullName || d.tag || d.mac;\n            if (!colorsRef.current[d.mac]) {\n              colorsRef.current[d.mac] = colorFromName(keyName);\n            }\n          });\n\n          (data.drivers || []).forEach(d => {\n            const t = trailsRef.current[d.mac] || (trailsRef.current[d.mac] = []);\n            t.push({ lat: d.lat, lon: d.lon, ts: now });\n            // taglio in-place invece di clonare array\n            if (t.length > TRAIL_MAX_LEN) t.splice(0, t.length - TRAIL_MAX_LEN);\n          });\n\n          if (!initCircuit?.sectors?.length && data.circuit?.id) {\n            try {\n              const rc = await fetch(`${API_BASE}/api/circuits/${data.circuit.id}`);\n              if (rc.ok) {\n                const full = await rc.json();\n                setInitCircuit({ id: data.circuit.id, name: full.name || data.circuit.id, stats: full.stats || {}, params: full.params || {}, sectors: full.sectors || [] });\n              }\n            } catch { /* no-op */ }\n          }\n\n          setSnapshot(data);\n        } else if (data?.type === 'race_inactive') {\n          setSnapshot(null);\n        }\n      } catch { }\n    };\n    ws.onerror = (e) => console.error('[RaceLive] WS error', e);\n    return () => { try { ws.close(); } catch { } };\n  }, [initCircuit?.sectors?.length]);\n\n  // Precompute proiezione circuito in “world coords” (metri) una sola volta\n  const worldGeom = useMemo(() => {\n    const circuit = circuitData || initCircuit;\n    if (!circuit?.sectors?.length) return null;\n    const lats = circuit.sectors.map(s => s.lat);\n    const lons = circuit.sectors.map(s => s.lon);\n    const minLat = Math.min(...lats), maxLat = Math.max(...lats);\n    const minLon = Math.min(...lons), maxLon = Math.max(...lons);\n    const centerLat = (minLat + maxLat) / 2;\n    const centerLon = (minLon + maxLon) / 2;\n    const R = 6371000;\n    const cosLat = Math.cos(centerLat * Math.PI / 180);\n    // world points in metri, centrati (0,0)\n    const pts = circuit.sectors.map(s => ({\n      x: (s.lon - centerLon) * Math.PI / 180 * R * cosLat,\n      y: (s.lat - centerLat) * Math.PI / 180 * R * (-1) // y verso il basso\n    }));\n    // raggio max per scale\n    const maxDx = Math.max(...pts.map(p => Math.abs(p.x)));\n    const maxDy = Math.max(...pts.map(p => Math.abs(p.y)));\n    const maxRange = Math.max(maxDx, maxDy) * 1.1;\n    // Path2D del tracciato (centerline)\n    const path = new Path2D();\n    pts.forEach((p, i) => i ? path.lineTo(p.x, p.y) : path.moveTo(p.x, p.y));\n    path.closePath();\n    return { pts, path, maxRange, centerLat, centerLon };\n  }, [circuitData, initCircuit]);\n\n  // ---- draw\n  useEffect(() => {\n    const circuit = circuitData || initCircuit;\n    if (!circuit || !canvasRef.current || !circuit?.sectors?.length) return;\n\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d', { alpha: false });\n    const dpr = window.devicePixelRatio || 1;\n\n    // importantissimo per mobile (evita lo scroll durante il pinch)\n    canvas.style.touchAction = 'none';\n\n    const ensureSize = () => {\n      const w = canvas.parentElement.clientWidth || 600;\n      const h = canvas.parentElement.clientHeight || 520;\n      if (canvas.width !== Math.floor(w * dpr) || canvas.height !== Math.floor(h * dpr)) {\n        canvas.width = Math.floor(w * dpr); canvas.height = Math.floor(h * dpr);\n        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n      }\n    };\n    const onResize = () => ensureSize();\n    ensureSize();\n    window.addEventListener('resize', onResize);\n\n    // ---- helpers proiezione\n    if (!worldGeom) return;\n    const padding = 40;\n    const projectWorldToScreen = (wx, wy) => {\n      const w = canvas.width / dpr, h = canvas.height / dpr;\n      const s = Math.min(w - padding * 2, h - padding * 2) / (worldGeom.maxRange * 2) * zoomRef.current;\n      return { x: w / 2 + wx * s + panRef.current.x, y: h / 2 + wy * s + panRef.current.y, scale: s };\n    };\n\n    // ---- interazione mouse\n    const wheel = (e) => {\n      e.preventDefault();\n      const dir = e.deltaY > 0 ? 0.9 : 1.1;\n      zoomRef.current = Math.max(0.5, Math.min(6, zoomRef.current * dir));\n    };\n    const mousedown = (e) => { isDraggingRef.current = true; lastMouseRef.current = { x: e.clientX, y: e.clientY }; canvas.style.cursor = 'grabbing'; };\n    const mousemove = (e) => { if (!isDraggingRef.current) return; panRef.current.x += e.clientX - lastMouseRef.current.x; panRef.current.y += e.clientY - lastMouseRef.current.y; lastMouseRef.current = { x: e.clientX, y: e.clientY }; };\n    const mouseup = () => { isDraggingRef.current = false; canvas.style.cursor = 'grab'; };\n    canvas.addEventListener('wheel', wheel, { passive: false });\n    canvas.addEventListener('mousedown', mousedown);\n    canvas.addEventListener('mousemove', mousemove);\n    canvas.addEventListener('mouseup', mouseup);\n    canvas.addEventListener('mouseleave', mouseup);\n    canvas.style.cursor = 'grab';\n\n    // ---- interazione touch (pointer events)\n    const onPointerDown = (ev) => {\n      canvas.setPointerCapture?.(ev.pointerId);\n      pointersRef.current.set(ev.pointerId, { x: ev.clientX, y: ev.clientY });\n      if (pointersRef.current.size === 1) {\n        lastMouseRef.current = { x: ev.clientX, y: ev.clientY };\n      } else if (pointersRef.current.size === 2) {\n        const pts = Array.from(pointersRef.current.values());\n        const dx = pts[0].x - pts[1].x;\n        const dy = pts[0].y - pts[1].y;\n        pinchStartRef.current = { dist: Math.hypot(dx, dy), zoom: zoomRef.current };\n      }\n    };\n    const onPointerMove = (ev) => {\n      if (!pointersRef.current.has(ev.pointerId)) return;\n      pointersRef.current.set(ev.pointerId, { x: ev.clientX, y: ev.clientY });\n\n      if (pointersRef.current.size === 1) {\n        const p = pointersRef.current.get(ev.pointerId);\n        panRef.current.x += p.x - lastMouseRef.current.x;\n        panRef.current.y += p.y - lastMouseRef.current.y;\n        lastMouseRef.current = { ...p };\n      } else if (pointersRef.current.size === 2) {\n        const pts = Array.from(pointersRef.current.values());\n        const dx = pts[0].x - pts[1].x;\n        const dy = pts[0].y - pts[1].y;\n        const dist = Math.hypot(dx, dy);\n        if (pinchStartRef.current.dist > 0) {\n          const ratio = dist / pinchStartRef.current.dist;\n          zoomRef.current = Math.max(0.5, Math.min(6, pinchStartRef.current.zoom * ratio));\n        }\n      }\n      ev.preventDefault();\n    };\n    const onPointerUp = (ev) => {\n      canvas.releasePointerCapture?.(ev.pointerId);\n      pointersRef.current.delete(ev.pointerId);\n      if (pointersRef.current.size < 2) {\n        pinchStartRef.current.dist = 0;\n      }\n    };\n    canvas.addEventListener('pointerdown', onPointerDown, { passive: false });\n    canvas.addEventListener('pointermove', onPointerMove, { passive: false });\n    canvas.addEventListener('pointerup', onPointerUp);\n    canvas.addEventListener('pointercancel', onPointerUp);\n    canvas.addEventListener('pointerleave', onPointerUp);\n\n    // ---- render\n    const draw = (ts) => {\n      // Cap a 30fps\n      if (!draw.last) draw.last = 0;\n      if (ts - draw.last < FRAME_DT_MS) { animFrameRef.current = requestAnimationFrame(draw); return; }\n      draw.last = ts;\n\n      ensureSize();\n      const w = canvas.width / dpr, h = canvas.height / dpr;\n\n      // full clear + bg\n      ctx.fillStyle = '#0a0a0a';\n      ctx.fillRect(0, 0, w, h);\n\n      const widthMeters = circuit.params?.widthMeters ?? 6;\n      const s0 = projectWorldToScreen(0, 0).scale;\n      const trackPx = Math.max(6, widthMeters * s0);\n\n      // Disegno tracciato con Path2D in world coords → proiettato via iterazione veloce\n      // BORDO/SETTORI (come prima ma iterando sugli indici worldGeom.pts)\n      const sectors = circuit.customSectors || circuitData?.customSectors || initCircuit?.customSectors || [];\n      if (Array.isArray(sectors) && sectors.length > 0) {\n        sectors.forEach((sector, idx) => {\n          const start = Math.max(0, Math.min(sector.startIdx ?? 0, worldGeom.pts.length - 1));\n          const end = Math.max(0, Math.min(sector.endIdx ?? 0, worldGeom.pts.length - 1));\n          if (end <= start) return;\n          const color = sector.color || ['#ff0000', '#00ff00', '#0000ff'][idx % 3];\n          ctx.save();\n          ctx.lineCap = 'round';\n          ctx.lineJoin = 'round';\n          ctx.strokeStyle = color;\n          ctx.lineWidth = trackPx + 3;\n          ctx.globalAlpha = 0.35;\n          ctx.beginPath();\n          for (let i = start; i <= end; i++) {\n            const p = projectWorldToScreen(worldGeom.pts[i].x, worldGeom.pts[i].y);\n            if (i === start) ctx.moveTo(p.x, p.y); else ctx.lineTo(p.x, p.y);\n          }\n          ctx.stroke();\n          ctx.restore();\n        });\n      } else {\n        // fallback bordo unico\n        ctx.strokeStyle = 'rgba(255,255,255,0.10)';\n        ctx.lineWidth = trackPx + 3;\n        ctx.lineCap = 'round';\n        ctx.lineJoin = 'round';\n        ctx.beginPath();\n        worldGeom.pts.forEach((wp, i) => {\n          const p = projectWorldToScreen(wp.x, wp.y);\n          if (i) ctx.lineTo(p.x, p.y); else ctx.moveTo(p.x, p.y);\n        });\n        ctx.closePath();\n        ctx.stroke();\n      }\n      // Asfalto\n      ctx.strokeStyle = 'rgba(80,84,90,0.95)';\n      ctx.lineWidth = trackPx;\n      ctx.lineCap = 'round';\n      ctx.lineJoin = 'round';\n      ctx.beginPath();\n      worldGeom.pts.forEach((wp, i) => {\n        const p = projectWorldToScreen(wp.x, wp.y);\n        if (i) ctx.lineTo(p.x, p.y); else ctx.moveTo(p.x, p.y);\n      });\n      ctx.closePath();\n      ctx.stroke();\n\n      // linea start\n      if (worldGeom.pts.length > 1) {\n        const p0 = projectWorldToScreen(worldGeom.pts[0].x, worldGeom.pts[0].y);\n        const p1 = projectWorldToScreen(worldGeom.pts[1].x, worldGeom.pts[1].y);\n        const ang = Math.atan2(p1.y - p0.y, p1.x - p0.x);\n        ctx.save(); ctx.translate(s0.x, s0.y); ctx.rotate(ang);\n        ctx.strokeStyle = '#ffffff'; ctx.lineWidth = Math.max(2, trackPx * 0.12);\n        ctx.beginPath(); ctx.moveTo(0, -trackPx * 0.5); ctx.lineTo(0, trackPx * 0.5); ctx.stroke(); ctx.restore();\n      }\n\n      // trails clean\n      const now = Date.now();\n      Object.keys(trailsRef.current).forEach(k => {\n        trailsRef.current[k] = (trailsRef.current[k] || []).filter(p => now - p.ts <= TRAIL_MAX_AGE_MS).slice(-TRAIL_MAX_LEN);\n      });\n\n      const drivers = snapshot?.drivers || [];\n      const sorted = [...drivers].sort((a, b) => a.position - b.position);\n\n      sorted.forEach((d, i) => {\n        const color = colorsRef.current[d.mac] || colorFromName(d.fullName || d.tag || d.mac);\n        const trail = trailsRef.current[d.mac] || [];\n        if (trail.length > 1) {\n          for (let t = 1; t < trail.length; t++) {\n            const prev = project(trail[t - 1].lat, trail[t - 1].lon);\n            const cur = project(trail[t].lat, trail[t].lon);\n            const ageFrac = Math.min(1, (now - trail[t].ts) / TRAIL_MAX_AGE_MS);\n            const alpha = 0.75 * (1 - ageFrac);\n            let rgba = color;\n            if (color.startsWith('#')) {\n              const hex = color.slice(1);\n              const full = hex.length === 3 ? hex.split('').map(c => c + c).join('') : hex;\n              const v = parseInt(full, 16), r = (v >> 16) & 255, g = (v >> 8) & 255, b = v & 255;\n              rgba = `rgba(${r},${g},${b},${alpha})`;\n            }\n            ctx.strokeStyle = rgba; ctx.lineWidth = Math.max(2, trackPx * 0.12);\n            ctx.beginPath(); ctx.moveTo(prev.x, prev.y); ctx.lineTo(cur.x, cur.y); ctx.stroke();\n          }\n        }\n        const p = project(d.lat, d.lon);\n        const r = Math.max(5, trackPx * 0.18) + (i === 0 ? 1 : 0);\n        let fill = color;\n        if (fill.startsWith('#')) {\n          const hex = fill.slice(1); const full = hex.length === 3 ? hex.split('').map(c => c + c).join('') : hex;\n          const v = parseInt(full, 16), rr = (v >> 16) & 255, gg = (v >> 8) & 255, bb = v & 255;\n          fill = `rgba(${rr},${gg},${bb},1)`;\n        }\n        ctx.shadowColor = 'rgba(0,0,0,0.5)'; ctx.shadowBlur = 4;\n        ctx.fillStyle = fill; ctx.beginPath(); ctx.arc(p.x, p.y, r, 0, Math.PI * 2); ctx.fill();\n        ctx.shadowBlur = 0; ctx.strokeStyle = '#fff'; ctx.lineWidth = 2; ctx.stroke();\n        ctx.fillStyle = '#fff'; ctx.font = 'bold 10px Roboto, sans-serif'; ctx.textAlign = 'center';\n        ctx.fillText(d.tag, p.x, p.y - (r + 8));\n      });\n\n      animFrameRef.current = requestAnimationFrame(draw);\n    };\n    draw();\n\n    return () => {\n      window.removeEventListener('resize', onResize);\n      canvas.removeEventListener('wheel', wheel);\n      canvas.removeEventListener('mousedown', mousedown);\n      canvas.removeEventListener('mousemove', mousemove);\n      canvas.removeEventListener('mouseup', mouseup);\n      canvas.removeEventListener('mouseleave', mouseup);\n      canvas.removeEventListener('pointerdown', onPointerDown);\n      canvas.removeEventListener('pointermove', onPointerMove);\n      canvas.removeEventListener('pointerup', onPointerUp);\n      canvas.removeEventListener('pointercancel', onPointerUp);\n      canvas.removeEventListener('pointerleave', onPointerUp);\n      if (animFrameRef.current) cancelAnimationFrame(animFrameRef.current);\n    };\n  }, [circuitData, initCircuit, snapshot]);\n\n  const leaderboard = useMemo(() => (!snapshot?.drivers) ? [] : [...snapshot.drivers].sort((a, b) => a.position - b.position), [snapshot]);\n  const globalBestLap = snapshot?.globalBestLap || null;\n\n  // chip di stato (no border)\n  const statusChipStyle = useMemo(() => {\n    const s = snapshot?.raceStatus || 'IN CORSO';\n    switch (s) {\n      case 'RED FLAG': return { background: 'rgba(225,6,0,.22)', color: '#ffdede' };\n      case 'YELLOW FLAG': return { background: 'rgba(241,196,15,.22)', color: '#fff3c4' };\n      case 'FINITA': return { background: 'rgba(154,163,154,.22)', color: '#f0f0f0' };\n      default: return { background: 'rgba(21,193,48,.22)', color: '#dfffe9' };\n    }\n  }, [snapshot?.raceStatus]);\n\n  const sendStatus = async (status) => {\n    try { await fetch(`${API_BASE}/api/race/status`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ status }) }); }\n    catch (e) { console.error(e); }\n  };\n  const sendPenalty = async (type) => {\n    if (!penTargetMac) return;\n    try { await fetch(`${API_BASE}/api/race/penalty`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ mac: penTargetMac, type }) }); }\n    catch (e) { console.error(e); }\n  };\n\n  const circuitName = (circuitData?.name || initCircuit?.name || snapshot?.circuit?.name || 'Circuito');\n  const circuitStatsLen = (circuitData?.stats?.lengthMeters ?? initCircuit?.stats?.lengthMeters ?? snapshot?.circuit?.stats?.lengthMeters);\n  const circuitWidth = (circuitData?.params?.widthMeters ?? initCircuit?.params?.widthMeters ?? snapshot?.circuit?.params?.widthMeters);\n\n  return (\n    <div className=\"main small-top\">\n      {/* TOP BAR — senza bordi, scroll orizzontale su mobile */}\n      <div\n        className=\"rs-live-topbar rs-live-topbar--glass\"\n      >\n        <div className=\"rs-chip-row\">\n          <span className=\"chip readonly live-pill\">\n            <span aria-hidden className={`live-dot ${blink ? 'on' : 'off'}`} /> LIVE\n          </span>\n          <span className=\"chip readonly pill\">{snapshot?.totalLaps ?? totalLaps} giri</span>\n          <span className=\"chip readonly pill\" style={{ ...statusChipStyle, fontWeight: 900 }}>{snapshot?.raceStatus || 'IN CORSO'}</span>\n          <span className=\"chip readonly pill\">{circuitName}</span>\n          {circuitStatsLen && (<span className=\"chip readonly pill\">{(+circuitStatsLen).toFixed(0)} m</span>)}\n          {circuitWidth && (<span className=\"chip readonly pill\">{circuitWidth} m larghezza</span>)}\n        </div>\n      </div>\n\n      <div className=\"rs-live-grid\">\n        <div className=\"track-card\"><canvas ref={canvasRef} className=\"track-canvas\" /></div>\n\n        <div className=\"leaderboard-card\">\n          <div className=\"lb-header\"><div className=\"lb-title\">CLASSIFICA</div><div className=\"lb-sub\">{leaderboard.length} piloti</div></div>\n\n          <div className=\"lb-list\">\n            {leaderboard.length === 0 ? (\n              <div className=\"no-drivers\"><p>Nessun dato GPS ancora disponibile…</p><small className=\"muted\">Appena arrivano i pacchetti la classifica si popola</small></div>\n            ) : (\n              leaderboard.map((d, idx) => {\n                const isLeader = idx === 0;\n                const fastest = d.bestLapTime && globalBestLap && d.bestLapTime === globalBestLap;\n                return (\n                  <div\n                    key={d.mac}\n                    className={`lb-row ${isLeader ? 'lb-leader' : ''}`}\n                    title={`${d.fullName} — Clicca per seguire`}\n                    role=\"button\"\n                    tabIndex={0}\n                    onClick={() => navigate(`/pilot/${d.mac}`)}\n                    onKeyDown={(e) => { if (e.key === 'Enter') navigate(`/pilot/${d.mac}`); }}\n                    style={{ cursor: 'pointer' }}\n                  >\n                    <div className=\"lb-pos\">{idx + 1}</div>\n                    <div className=\"lb-team\">\n                      {d.photoTeamUrl ? (\n                        <img src={`${API_BASE}${d.photoTeamUrl}`} alt={d.team} className=\"lb-team-logo\" />\n                      ) : (\n                        <div className=\"lb-team-color\" style={{ background: colorsRef.current[d.mac] || colorFromName(d.fullName || d.tag || d.mac) }} />\n                      )}\n                    </div>\n                    <div className=\"lb-name\">{d.tag}</div>\n                    <div className=\"lb-gap\">{d.gapToLeader || (isLeader ? 'LEADER' : '')}</div>\n                    <div className=\"lb-icons\">{fastest && <span className=\"lb-icon purple\" title={`Best lap ${formatLap(d.bestLapTime)}`}>⏱</span>}</div>\n                    <div className=\"lb-lap\"><span className=\"muted\">Lap</span>&nbsp;{d.lapCount}/{snapshot?.totalLaps ?? totalLaps}</div>\n                  </div>\n                );\n              })\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Dettagliata */}\n      <div className=\"leaderboard-card\" style={{ marginTop: 12, width: '100%' }}>\n        <div className=\"lb-header\" style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'baseline' }}>\n          <div className=\"lb-title\">CLASSIFICA DETTAGLIATA</div>\n          <div className=\"lb-sub\">{leaderboard.length} piloti • tempi ultimo giro e miglior giro</div>\n        </div>\n\n        {/* === INTESTAZIONE COLONNE CLASSIFICA DETTAGLIATA === */}\n        <div\n          className=\"lb-row\"\n          style={{\n            gridTemplateColumns:\n              '28px 28px 1fr 90px 90px 90px 90px 110px 110px 140px 90px',\n            fontWeight: 800,\n            background: 'rgba(255,255,255,0.05)',\n            borderBottom: '1px solid rgba(255,255,255,0.1)',\n            color: 'rgba(206, 206, 206, 0.72)',\n            marginLeft: '10px',\n            marginRight: '10px',\n            marginTop: '15px',\n          }}\n        >\n          <div>P</div>\n          <div>Team</div>\n          <div>Pilota</div>\n          <div style={{ textAlign: 'right' }}>GAP</div>\n          <div style={{ textAlign: 'right' }}>S1</div>\n          <div style={{ textAlign: 'right' }}>S2</div>\n          <div style={{ textAlign: 'right' }}>S3</div>\n          <div style={{ textAlign: 'right' }}>Ultimo</div>\n          <div style={{ textAlign: 'right' }}>Migliore</div>\n          <div style={{ textAlign: 'right' }}>Sanzioni</div>\n          <div style={{ textAlign: 'right' }}>Giri</div>\n        </div>\n\n        <div className=\"lb-list\">\n          {leaderboard.map((d, idx) => {\n            const fastest = d.bestLapTime && globalBestLap && d.bestLapTime === globalBestLap;\n            return (\n              <div\n                key={`wide-${d.mac}`}\n                className=\"lb-row\"\n                style={{\n                  gridTemplateColumns:\n                    '28px 28px 1fr 90px 90px 90px 90px 110px 110px 140px 90px',\n                  cursor: 'pointer',\n                }}\n                title={`${d.fullName} — Clicca per seguire`}\n                onClick={() => navigate(`/pilot/${d.mac}`)}\n              >\n                <div className=\"lb-pos\">{idx + 1}</div>\n                <div className=\"lb-team\">\n                  {d.photoTeamUrl ? (\n                    <img src={`${API_BASE}${d.photoTeamUrl}`} alt={d.team} className=\"lb-team-logo\" />\n                  ) : (\n                    <div\n                      className=\"lb-team-color\"\n                      style={{\n                        background:\n                          colorsRef.current[d.mac] ||\n                          colorFromName(d.fullName || d.tag || d.mac),\n                      }}\n                    />\n                  )}\n                </div>\n                <div className=\"lb-name\">{d.tag}</div>\n\n                {/* GAP */}\n                <div className=\"lb-gap\" style={{ textAlign: 'right' }}>\n                  {idx === 0 ? 'LEADER' : d.gapToLeader}\n                </div>\n\n                {/* === TEMPI SETTORI DAL SERVER === */}\n                <div className=\"lb-gap\" title=\"Settore 1\" style={{ color: '#fff' }}>\n                  {formatLap(d.lastSectorTimes?.S1 ?? d.sectorTimes?.S1)}\n                </div>\n                <div className=\"lb-gap\" title=\"Settore 2\" style={{ color: '#fff' }}>\n                  {formatLap(d.lastSectorTimes?.S2 ?? d.sectorTimes?.S2)}\n                </div>\n                <div className=\"lb-gap\" title=\"Settore 3\" style={{ color: '#fff' }}>\n                  {formatLap(d.lastSectorTimes?.S3 ?? d.sectorTimes?.S3)}\n                </div>\n\n                {/* Ultimo giro */}\n                <div\n                  className=\"lb-gap\"\n                  title=\"Ultimo giro\"\n                  style={{ fontWeight: 700, color: '#e9ffe0' }}\n                >\n                  {formatLap(d.lastLapTime)}\n                </div>\n\n                {/* Miglior giro */}\n                <div\n                  className=\"lb-gap\"\n                  title=\"Miglior giro\"\n                  style={{\n                    fontWeight: 700,\n                    color: fastest ? '#b085ff' : '#e9ffe0',\n                  }}\n                >\n                  {formatLap(d.bestLapTime)}\n                  {fastest && (\n                    <span className=\"lb-icon purple\" style={{ marginLeft: 6 }}>\n                      ⏱\n                    </span>\n                  )}\n                </div>\n\n                <div\n                  className=\"lb-gap\"\n                  title=\"Penalità assegnate\"\n                  style={{ fontWeight: 800 }}\n                >\n                  {d?.penalty?.summary || '—'}\n                </div>\n                <div className=\"lb-lap\" style={{ textAlign: 'right' }}>\n                  <span className=\"muted\">Lap</span>&nbsp;\n                  {d.lapCount}/{snapshot?.totalLaps ?? totalLaps}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* COMANDI GARA */}\n      <div className=\"leaderboard-card\" style={{ marginTop: 12, width: '100%' }}>\n        <div className=\"lb-header\"><div className=\"lb-title\">COMANDI GARA</div></div>\n        <div className=\"race-controls\" style={{ justifyContent: 'space-between', gap: 12, flexWrap: 'wrap', padding: '20px' }}>\n          <div style={{ display: 'flex', alignItems: 'center', gap: 8, flexWrap: 'wrap' }}>\n            <span className=\"muted\">Stato:</span>\n            {['IN CORSO', 'FINITA', 'RED FLAG', 'YELLOW FLAG'].map(s => (\n              <button key={s} className=\"btn-ghost\" onClick={() => sendStatus(s)} style={{ fontWeight: 700 }}>{s}</button>\n            ))}\n          </div>\n\n          <div style={{ display: 'flex', alignItems: 'center', gap: 8, flexWrap: 'wrap', marginTop: '15px' }}>\n            <span className=\"muted\">Sanzioni:</span>\n            <select className=\"input\" value={penTargetMac} onChange={(e) => setPenTargetMac(e.target.value)} style={{ width: 260 }}>\n              <option value=\"\">-- Seleziona pilota --</option>\n              {leaderboard.map(d => (<option key={d.mac} value={d.mac}>{d.tag} — {d.fullName}</option>))}\n            </select>\n            {['+5s', '+10s', '+15s', '1mo avv. squalifica', 'squalifica'].map(k => (\n              <button key={k} className=\"btn-ghost\" disabled={!penTargetMac} onClick={() => sendPenalty(k)} style={{ fontWeight: 800 }}>{k}</button>\n            ))}\n            {penTargetMac && <span className=\"muted\" style={{ marginLeft: 6 }}>Attuale: <b>{leaderboard.find(d => d.mac === penTargetMac)?.penalty?.summary || '—'}</b></span>}\n          </div>\n\n          <button style={{ marginTop: '20px' }} className=\"btn-danger\" onClick={async () => { try { await fetch(`${API_BASE}/api/race/stop`, { method: 'POST' }) } catch { }; onStopRace(); }}>Termina gara</button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}