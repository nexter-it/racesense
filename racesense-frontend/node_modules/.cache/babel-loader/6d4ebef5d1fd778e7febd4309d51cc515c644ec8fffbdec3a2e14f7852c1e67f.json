{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/racesense/racesense-frontend/src/pages/RaceLive.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport '../App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE = process.env.REACT_APP_API_BASE || `http://${window.location.hostname}:5000`;\nconst WS_URL = process.env.REACT_APP_WS_URL || `ws://${window.location.hostname}:5001`;\n\n/* ===== utils ===== */\nfunction formatLap(sec) {\n  if (!sec && sec !== 0) return '—';\n  const m = Math.floor(sec / 60);\n  const s = (sec % 60).toFixed(3).padStart(6, '0');\n  return `${m}:${s}`;\n}\n\n/* ===== component ===== */\nexport default function RaceLive({\n  raceConfig,\n  onStopRace\n}) {\n  _s();\n  var _circuit$stats, _circuit$params2, _statusColors$lbBorde;\n  const [serverState, setServerState] = useState(null); // circuito + summary iniziali\n  const [summary, setSummary] = useState(null); // aggiornato dal WS (classifica server-side)\n  const [raceStatus, setRaceStatus] = useState('IN CORSO'); // mirror lato client\n  const [pilotsIndex, setPilotsIndex] = useState({}); // pilotId -> pilot object\n  const canvasRef = useRef(null);\n  const zoomRef = useRef(1);\n  const panRef = useRef({\n    x: 0,\n    y: 0\n  });\n  const isDraggingRef = useRef(false);\n  const lastMouseRef = useRef({\n    x: 0,\n    y: 0\n  });\n  const animRef = useRef(null);\n  const dprRef = useRef(1);\n  const circuitRef = useRef(null);\n  const driverPositionsRef = useRef({}); // mac -> { lat, lon, tag, color, photoTeamUrl }\n  const summaryRef = useRef(null); // ultima summary dal server\n\n  // ===== fetch stato iniziale (se entro senza config locale) =====\n  useEffect(() => {\n    let alive = true;\n    const init = async () => {\n      if (raceConfig && raceConfig.serverMode) {\n        var _j$summary;\n        const r = await fetch(`${API_BASE}/api/race/state`);\n        const j = await r.json();\n        if (!alive) return;\n        if (!j.active) {\n          setServerState(null);\n          return;\n        }\n        setServerState(j);\n        setSummary(j.summary);\n        summaryRef.current = j.summary;\n        setRaceStatus(((_j$summary = j.summary) === null || _j$summary === void 0 ? void 0 : _j$summary.status) || 'IN CORSO');\n        setPilotsIndex(Object.fromEntries((j.pilots || []).map(p => [p.id, p])));\n        circuitRef.current = j.circuit;\n      } else {\n        // anche se raceConfig è null, provo comunque a joinare se c'è una gara\n        const r = await fetch(`${API_BASE}/api/race/state`);\n        const j = await r.json();\n        if (!alive) return;\n        if (j.active) {\n          var _j$summary2;\n          setServerState(j);\n          setSummary(j.summary);\n          summaryRef.current = j.summary;\n          setRaceStatus(((_j$summary2 = j.summary) === null || _j$summary2 === void 0 ? void 0 : _j$summary2.status) || 'IN CORSO');\n          setPilotsIndex(Object.fromEntries((j.pilots || []).map(p => [p.id, p])));\n          circuitRef.current = j.circuit;\n        }\n      }\n    };\n    init();\n    return () => {\n      alive = false;\n    };\n  }, [raceConfig]);\n\n  // ===== WebSocket: ricevo GPS per canvas + summary per classifica =====\n  useEffect(() => {\n    const ws = new WebSocket(WS_URL);\n    ws.onmessage = ev => {\n      try {\n        const msg = JSON.parse(ev.data);\n        if ((msg === null || msg === void 0 ? void 0 : msg.type) === 'race') {\n          var _msg$payload;\n          setSummary(msg.payload);\n          summaryRef.current = msg.payload; // aggiorna la ref\n          setRaceStatus(((_msg$payload = msg.payload) === null || _msg$payload === void 0 ? void 0 : _msg$payload.status) || 'IN CORSO');\n          return;\n        }\n\n        // GPS (compat: anche payload \"piano\")\n        if ((msg === null || msg === void 0 ? void 0 : msg.type) === 'gps' || msg !== null && msg !== void 0 && msg.mac && msg !== null && msg !== void 0 && msg.lat && msg !== null && msg !== void 0 && msg.lon) {\n          var _summaryRef$current;\n          const mac = String(msg.mac);\n          const lb = ((_summaryRef$current = summaryRef.current) === null || _summaryRef$current === void 0 ? void 0 : _summaryRef$current.leaderboard) || [];\n          const d = lb.find(x => x.mac === mac);\n          driverPositionsRef.current[mac] = {\n            lat: Number(msg.lat),\n            lon: Number(msg.lon),\n            tag: ((d === null || d === void 0 ? void 0 : d.tag) || 'PIL').slice(0, 4),\n            color: (d === null || d === void 0 ? void 0 : d.color) || '#C0FF03',\n            photoTeamUrl: (d === null || d === void 0 ? void 0 : d.photoTeamUrl) || null\n          };\n        }\n      } catch {}\n    };\n    ws.onerror = e => console.error('[WS]', e);\n\n    // ===== Canvas draw loop =====\n    const canvas = canvasRef.current;\n    if (!canvas) return () => ws.close();\n    const ctx = canvas.getContext('2d');\n    const dpr = window.devicePixelRatio || 1;\n    dprRef.current = dpr;\n    const ensureSize = () => {\n      const parent = canvas.parentElement;\n      const w = parent.clientWidth || 800;\n      const h = parent.clientHeight || 520;\n      if (canvas.width !== Math.floor(w * dpr) || canvas.height !== Math.floor(h * dpr)) {\n        canvas.width = Math.floor(w * dpr);\n        canvas.height = Math.floor(h * dpr);\n        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n      }\n    };\n    ensureSize();\n    const onResize = () => ensureSize();\n    window.addEventListener('resize', onResize);\n    const wheel = e => {\n      e.preventDefault();\n      zoomRef.current = Math.max(0.5, Math.min(5, zoomRef.current * (e.deltaY > 0 ? 0.9 : 1.1)));\n    };\n    const mousedown = e => {\n      isDraggingRef.current = true;\n      lastMouseRef.current = {\n        x: e.clientX,\n        y: e.clientY\n      };\n      canvas.style.cursor = 'grabbing';\n    };\n    const mousemove = e => {\n      if (!isDraggingRef.current) return;\n      const dx = e.clientX - lastMouseRef.current.x;\n      const dy = e.clientY - lastMouseRef.current.y;\n      panRef.current.x += dx;\n      panRef.current.y += dy;\n      lastMouseRef.current = {\n        x: e.clientX,\n        y: e.clientY\n      };\n    };\n    const mouseup = () => {\n      isDraggingRef.current = false;\n      canvas.style.cursor = 'grab';\n    };\n    canvas.addEventListener('wheel', wheel, {\n      passive: false\n    });\n    canvas.addEventListener('mousedown', mousedown);\n    canvas.addEventListener('mousemove', mousemove);\n    canvas.addEventListener('mouseup', mouseup);\n    canvas.addEventListener('mouseleave', mouseup);\n    canvas.style.cursor = 'grab';\n\n    // proiezione\n    const projectFactory = () => {\n      var _circuit$sectors;\n      const circuit = circuitRef.current;\n      if (!(circuit !== null && circuit !== void 0 && (_circuit$sectors = circuit.sectors) !== null && _circuit$sectors !== void 0 && _circuit$sectors.length)) return null;\n      const lats = circuit.sectors.map(s => s.lat);\n      const lons = circuit.sectors.map(s => s.lon);\n      const minLat = Math.min(...lats),\n        maxLat = Math.max(...lats);\n      const minLon = Math.min(...lons),\n        maxLon = Math.max(...lons);\n      const centerLat = (minLat + maxLat) / 2;\n      const centerLon = (minLon + maxLon) / 2;\n      const R = 6371000;\n      const centerLatRad = centerLat * Math.PI / 180;\n      const dxList = lons.map(l => (l - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad));\n      const dyList = lats.map(l => (l - centerLat) * Math.PI / 180 * R);\n      const maxDx = Math.max(...dxList.map(Math.abs));\n      const maxDy = Math.max(...dyList.map(Math.abs));\n      const padding = 40;\n      return (lat, lon, w, h) => {\n        const maxRange = Math.max(maxDx, maxDy) * 1.1;\n        const scale = Math.min(w - padding * 2, h - padding * 2) / (maxRange * 2) * zoomRef.current;\n        const dx = (lon - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad);\n        const dy = (lat - centerLat) * Math.PI / 180 * R;\n        const x = w / 2 + dx * scale + panRef.current.x;\n        const y = h / 2 - dy * scale + panRef.current.y;\n        return {\n          x,\n          y,\n          scale\n        };\n      };\n    };\n    let project = projectFactory();\n    const draw = () => {\n      var _circuit$sectors2;\n      ensureSize();\n      const circuit = circuitRef.current;\n      const w = canvas.width / dpr;\n      const h = canvas.height / dpr;\n      ctx.clearRect(0, 0, w, h);\n      ctx.fillStyle = '#0a0a0a';\n      ctx.fillRect(0, 0, w, h);\n      if (circuit !== null && circuit !== void 0 && (_circuit$sectors2 = circuit.sectors) !== null && _circuit$sectors2 !== void 0 && _circuit$sectors2.length) {\n        var _circuit$params$width, _circuit$params, _pts$;\n        if (!project) project = projectFactory();\n        const widthMeters = (_circuit$params$width = (_circuit$params = circuit.params) === null || _circuit$params === void 0 ? void 0 : _circuit$params.widthMeters) !== null && _circuit$params$width !== void 0 ? _circuit$params$width : 6;\n        const pts = circuit.sectors.map(s => project(s.lat, s.lon, w, h));\n        const scale = ((_pts$ = pts[0]) === null || _pts$ === void 0 ? void 0 : _pts$.scale) || 1;\n        const trackPx = Math.max(6, widthMeters * scale);\n        ctx.strokeStyle = 'rgba(255,255,255,0.10)';\n        ctx.lineWidth = trackPx + 4;\n        ctx.lineCap = 'round';\n        ctx.lineJoin = 'round';\n        ctx.beginPath();\n        pts.forEach((p, i) => i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y));\n        ctx.closePath();\n        ctx.stroke();\n        ctx.strokeStyle = 'rgba(80, 84, 90, 0.95)';\n        ctx.lineWidth = trackPx;\n        ctx.beginPath();\n        pts.forEach((p, i) => i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y));\n        ctx.closePath();\n        ctx.stroke();\n        if (pts.length > 1) {\n          const s0 = pts[0],\n            s1 = pts[1];\n          const ang = Math.atan2(s1.y - s0.y, s1.x - s0.x);\n          ctx.save();\n          ctx.translate(s0.x, s0.y);\n          ctx.rotate(ang);\n          ctx.strokeStyle = '#ffffff';\n          ctx.lineWidth = Math.max(2, trackPx * 0.12);\n          ctx.beginPath();\n          ctx.moveTo(0, -trackPx * 0.5);\n          ctx.lineTo(0, trackPx * 0.5);\n          ctx.stroke();\n          ctx.restore();\n        }\n      }\n\n      // markers piloti: usa la REF stabile\n      Object.entries(driverPositionsRef.current).forEach(([mac, pos]) => {\n        const p = project ? project(pos.lat, pos.lon, w, h) : null;\n        if (!p) return;\n        const teamCol = pos.color || '#C0FF03';\n        const r = Math.max(5, 6 * (zoomRef.current * 0.9));\n        ctx.shadowColor = 'rgba(0,0,0,0.5)';\n        ctx.shadowBlur = 4;\n        ctx.fillStyle = teamCol;\n        ctx.beginPath();\n        ctx.arc(p.x, p.y, r, 0, Math.PI * 2);\n        ctx.fill();\n        ctx.shadowBlur = 0;\n        ctx.strokeStyle = '#fff';\n        ctx.lineWidth = 2;\n        ctx.stroke();\n        ctx.fillStyle = '#fff';\n        ctx.font = 'bold 10px Roboto, sans-serif';\n        ctx.textAlign = 'center';\n        ctx.fillText((pos.tag || 'PIL').slice(0, 4), p.x, p.y - (r + 6));\n      });\n      animRef.current = requestAnimationFrame(draw);\n    };\n    draw();\n    return () => {\n      window.removeEventListener('resize', onResize);\n      canvas.removeEventListener('wheel', wheel);\n      canvas.removeEventListener('mousedown', mousedown);\n      canvas.removeEventListener('mousemove', mousemove);\n      canvas.removeEventListener('mouseup', mouseup);\n      canvas.removeEventListener('mouseleave', mouseup);\n      if (animRef.current) cancelAnimationFrame(animRef.current);\n      ws.close();\n    };\n  }, []); // << esegui UNA SOLA VOLTA\n\n  // ===== controlli gara (status + sanzioni) =====\n  const [penPilot, setPenPilot] = useState('');\n  const [penType, setPenType] = useState('+5s');\n  const sendStatus = async s => {\n    try {\n      setRaceStatus(s);\n      await fetch(`${API_BASE}/api/race/status`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          status: s\n        })\n      });\n    } catch {}\n  };\n  const sendPenalty = async () => {\n    if (!penPilot) return;\n    try {\n      await fetch(`${API_BASE}/api/race/penalty`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          pilotId: penPilot,\n          type: penType\n        })\n      });\n      // il server aggiornerà la summary via WS; qui basta pulire\n      setPenPilot('');\n      setPenType('+5s');\n    } catch (e) {\n      console.error(e);\n    }\n  };\n  const statusColors = useMemo(() => {\n    switch (raceStatus) {\n      case 'RED FLAG':\n        return {\n          chipBg: 'rgba(225,6,0,.15)',\n          chipBorder: '#e10600',\n          chipText: '#ffdede',\n          lbBorder: '#e10600'\n        };\n      case 'YELLOW FLAG':\n        return {\n          chipBg: 'rgba(241,196,15,.15)',\n          chipBorder: '#f1c40f',\n          chipText: '#fff3c4',\n          lbBorder: '#f1c40f'\n        };\n      case 'FINITA':\n        return {\n          chipBg: 'rgba(154,163,154,.15)',\n          chipBorder: '#9aa39a',\n          chipText: '#e0e0e0',\n          lbBorder: '#9aa39a'\n        };\n      default:\n        return {\n          chipBg: 'rgba(21,193,48,.15)',\n          chipBorder: '#15c130',\n          chipText: '#e9ffe0',\n          lbBorder: null\n        };\n    }\n  }, [raceStatus]);\n\n  // ===== render =====\n  const circuit = serverState === null || serverState === void 0 ? void 0 : serverState.circuit;\n  const board = (summary === null || summary === void 0 ? void 0 : summary.leaderboard) || [];\n  const totalLaps = (summary === null || summary === void 0 ? void 0 : summary.totalLaps) || (serverState === null || serverState === void 0 ? void 0 : serverState.totalLaps) || 0;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main small-top\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"rs-live-topbar\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rs-live-left\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            gap: 8\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            \"aria-hidden\": true,\n            style: {\n              width: 10,\n              height: 10,\n              borderRadius: '50%',\n              background: '#ff4d4f',\n              boxShadow: '0 0 12px rgba(255,77,79,.8)',\n              animation: 'blink 1.2s infinite'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 13\n          }, this), \"LIVE\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          children: [totalLaps, \" giri\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          style: {\n            background: statusColors.chipBg,\n            border: `1px solid ${statusColors.chipBorder}`,\n            color: statusColors.chipText,\n            fontWeight: 800\n          },\n          children: raceStatus\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 290,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rs-live-right\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          children: (circuit === null || circuit === void 0 ? void 0 : circuit.name) || 'Circuito'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 11\n        }, this), (circuit === null || circuit === void 0 ? void 0 : (_circuit$stats = circuit.stats) === null || _circuit$stats === void 0 ? void 0 : _circuit$stats.lengthMeters) && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          children: [circuit.stats.lengthMeters.toFixed(0), \" m\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 44\n        }, this), (circuit === null || circuit === void 0 ? void 0 : (_circuit$params2 = circuit.params) === null || _circuit$params2 === void 0 ? void 0 : _circuit$params2.widthMeters) && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          children: [circuit.params.widthMeters, \" m larghezza\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 44\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"rs-live-grid\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"track-card\",\n        children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n          ref: canvasRef,\n          className: \"track-canvas\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"leaderboard-card\",\n        style: {\n          borderColor: (_statusColors$lbBorde = statusColors.lbBorder) !== null && _statusColors$lbBorde !== void 0 ? _statusColors$lbBorde : 'var(--line)',\n          boxShadow: statusColors.lbBorder ? `0 8px 32px ${statusColors.lbBorder}33, inset 0 0 0 1px ${statusColors.lbBorder}55` : undefined\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lb-title\",\n            children: \"CLASSIFICA\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 323,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lb-sub\",\n            children: [board.length, \" piloti\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 324,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 322,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-list\",\n          children: board.map((d, idx) => {\n            const fastest = (summary === null || summary === void 0 ? void 0 : summary.bestLapOverall) && d.bestLapTime && d.bestLapTime === summary.bestLapOverall;\n            const gapText = idx === 0 ? 'LEADER' : typeof d.gap === 'string' ? `+${d.gap}` : `+${(d.gap || 0).toFixed(2)}`;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `lb-row ${idx === 0 ? 'lb-leader' : ''}`,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-pos\",\n                children: idx + 1\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 332,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-team\",\n                children: d.photoTeamUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: `${API_BASE}${d.photoTeamUrl}`,\n                  alt: \"\",\n                  className: \"lb-team-logo\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 334,\n                  columnNumber: 39\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"lb-team-color\",\n                  style: {\n                    background: d.color\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 335,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 333,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-name\",\n                children: (d.tag || 'PIL').slice(0, 4)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 337,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-gap\",\n                children: gapText\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 338,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-icons\",\n                children: [fastest && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"lb-icon purple\",\n                  children: \"\\u23F1\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 340,\n                  columnNumber: 33\n                }, this), d.penaltySeconds > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"lb-icon\",\n                  title: `${d.penaltySeconds}s penalità`,\n                  children: \"\\u26A0\\uFE0F\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 341,\n                  columnNumber: 46\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 339,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-lap\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"muted\",\n                  children: \"Lap\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 343,\n                  columnNumber: 43\n                }, this), \"\\xA0\", d.lapCount, \"/\", totalLaps]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 343,\n                columnNumber: 19\n              }, this)]\n            }, d.mac, true, {\n              fileName: _jsxFileName,\n              lineNumber: 331,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"leaderboard-card\",\n      style: {\n        marginTop: 12\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lb-header\",\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'baseline'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-title\",\n          children: \"CLASSIFICA DETTAGLIATA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 354,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-sub\",\n          children: [board.length, \" piloti \\u2022 ultimo giro e best\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 353,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lb-list\",\n        children: board.map((d, idx) => {\n          const fastest = (summary === null || summary === void 0 ? void 0 : summary.bestLapOverall) && d.bestLapTime && d.bestLapTime === summary.bestLapOverall;\n          const pen = d.penaltySeconds || 0;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lb-row\",\n            style: {\n              gridTemplateColumns: '28px 28px 1fr 90px 110px 110px 110px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-pos\",\n              children: idx + 1\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 363,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-team\",\n              children: d.photoTeamUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n                src: `${API_BASE}${d.photoTeamUrl}`,\n                alt: \"\",\n                className: \"lb-team-logo\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 365,\n                columnNumber: 37\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-team-color\",\n                style: {\n                  background: d.color\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 366,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 364,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-name\",\n              children: (d.tag || 'PIL').slice(0, 4)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 368,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              style: {\n                textAlign: 'right'\n              },\n              children: idx === 0 ? 'LEADER' : typeof d.gap === 'string' ? `+${d.gap}` : `+${(d.gap || 0).toFixed(2)}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 369,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              title: \"Ultimo giro\",\n              style: {\n                fontWeight: 700\n              },\n              children: formatLap(d.lastLapTime)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 372,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              title: \"Miglior giro\",\n              style: {\n                fontWeight: 700,\n                color: fastest ? '#b085ff' : 'inherit'\n              },\n              children: [formatLap(d.bestLapTime), fastest && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"lb-icon purple\",\n                style: {\n                  marginLeft: 6\n                },\n                children: \"\\u23F1\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 374,\n                columnNumber: 57\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 373,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              title: \"Penalit\\xE0\",\n              style: {\n                fontWeight: 700\n              },\n              children: pen > 0 ? `+${pen}s` : '—'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 376,\n              columnNumber: 17\n            }, this)]\n          }, `wide-${d.mac}`, true, {\n            fileName: _jsxFileName,\n            lineNumber: 362,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pilot-form\",\n      style: {\n        marginTop: 12\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"section-title\",\n        style: {\n          marginBottom: 10\n        },\n        children: \"COMANDI GARA\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 387,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          flexWrap: 'wrap',\n          gap: 8,\n          alignItems: 'center',\n          marginBottom: 10\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"muted\",\n          children: \"Stato:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 391,\n          columnNumber: 11\n        }, this), ['IN CORSO', 'FINITA', 'RED FLAG', 'YELLOW FLAG'].map(s => /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-ghost\",\n          onClick: () => sendStatus(s),\n          style: {\n            borderColor: raceStatus === s ? 'rgba(192,255,3,0.6)' : 'var(--line)',\n            boxShadow: raceStatus === s ? '0 0 0 2px rgba(192,255,3,0.12) inset' : 'none',\n            fontWeight: 700\n          },\n          children: s\n        }, s, false, {\n          fileName: _jsxFileName,\n          lineNumber: 393,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 390,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          flexWrap: 'wrap',\n          gap: 8,\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"muted\",\n          children: \"Sanzione:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 407,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          className: \"input\",\n          style: {\n            maxWidth: 260\n          },\n          value: penPilot,\n          onChange: e => setPenPilot(e.target.value),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"-- Pilota --\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 409,\n            columnNumber: 13\n          }, this), ((serverState === null || serverState === void 0 ? void 0 : serverState.pilots) || []).map(p => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: p.id,\n            children: [p.name, \" \", p.surname, \" (\", p.team, \")\"]\n          }, p.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 411,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 408,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          className: \"input\",\n          style: {\n            maxWidth: 220\n          },\n          value: penType,\n          onChange: e => setPenType(e.target.value),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"+5s\",\n            children: \"+5s\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 415,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"+10s\",\n            children: \"+10s\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 416,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"+15s\",\n            children: \"+15s\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 417,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"1mo avv. squalifica\",\n            children: \"1mo avv. squalifica\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 418,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"squalifica\",\n            children: \"squalifica\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 419,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 414,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-primary\",\n          onClick: sendPenalty,\n          disabled: !penPilot,\n          children: \"Applica\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 421,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginLeft: 'auto'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn-danger\",\n            onClick: async () => {\n              await fetch(`${API_BASE}/api/race/stop`, {\n                method: 'POST'\n              }).catch(() => {});\n              onStopRace();\n            },\n            children: \"Termina gara\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 424,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 423,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 406,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 386,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 287,\n    columnNumber: 5\n  }, this);\n}\n_s(RaceLive, \"GViXk5jXlIizkfKo0+zP6q49khk=\");\n_c = RaceLive;\nvar _c;\n$RefreshReg$(_c, \"RaceLive\");","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","jsxDEV","_jsxDEV","API_BASE","process","env","REACT_APP_API_BASE","window","location","hostname","WS_URL","REACT_APP_WS_URL","formatLap","sec","m","Math","floor","s","toFixed","padStart","RaceLive","raceConfig","onStopRace","_s","_circuit$stats","_circuit$params2","_statusColors$lbBorde","serverState","setServerState","summary","setSummary","raceStatus","setRaceStatus","pilotsIndex","setPilotsIndex","canvasRef","zoomRef","panRef","x","y","isDraggingRef","lastMouseRef","animRef","dprRef","circuitRef","driverPositionsRef","summaryRef","alive","init","serverMode","_j$summary","r","fetch","j","json","active","current","status","Object","fromEntries","pilots","map","p","id","circuit","_j$summary2","ws","WebSocket","onmessage","ev","msg","JSON","parse","data","type","_msg$payload","payload","mac","lat","lon","_summaryRef$current","String","lb","leaderboard","d","find","Number","tag","slice","color","photoTeamUrl","onerror","e","console","error","canvas","close","ctx","getContext","dpr","devicePixelRatio","ensureSize","parent","parentElement","w","clientWidth","h","clientHeight","width","height","setTransform","onResize","addEventListener","wheel","preventDefault","max","min","deltaY","mousedown","clientX","clientY","style","cursor","mousemove","dx","dy","mouseup","passive","projectFactory","_circuit$sectors","sectors","length","lats","lons","minLat","maxLat","minLon","maxLon","centerLat","centerLon","R","centerLatRad","PI","dxList","l","cos","dyList","maxDx","abs","maxDy","padding","maxRange","scale","project","draw","_circuit$sectors2","clearRect","fillStyle","fillRect","_circuit$params$width","_circuit$params","_pts$","widthMeters","params","pts","trackPx","strokeStyle","lineWidth","lineCap","lineJoin","beginPath","forEach","i","lineTo","moveTo","closePath","stroke","s0","s1","ang","atan2","save","translate","rotate","restore","entries","pos","teamCol","shadowColor","shadowBlur","arc","fill","font","textAlign","fillText","requestAnimationFrame","removeEventListener","cancelAnimationFrame","penPilot","setPenPilot","penType","setPenType","sendStatus","method","headers","body","stringify","sendPenalty","pilotId","statusColors","chipBg","chipBorder","chipText","lbBorder","board","totalLaps","className","children","display","alignItems","gap","borderRadius","background","boxShadow","animation","fileName","_jsxFileName","lineNumber","columnNumber","border","fontWeight","name","stats","lengthMeters","ref","borderColor","undefined","idx","fastest","bestLapOverall","bestLapTime","gapText","src","alt","penaltySeconds","title","lapCount","marginTop","justifyContent","pen","gridTemplateColumns","lastLapTime","marginLeft","marginBottom","flexWrap","onClick","maxWidth","value","onChange","target","surname","team","disabled","catch","_c","$RefreshReg$"],"sources":["/home/ubuntu/racesense/racesense-frontend/src/pages/RaceLive.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from 'react';\nimport '../App.css';\n\nconst API_BASE = process.env.REACT_APP_API_BASE || `http://${window.location.hostname}:5000`;\nconst WS_URL = process.env.REACT_APP_WS_URL || `ws://${window.location.hostname}:5001`;\n\n/* ===== utils ===== */\nfunction formatLap(sec) {\n  if (!sec && sec !== 0) return '—';\n  const m = Math.floor(sec / 60);\n  const s = (sec % 60).toFixed(3).padStart(6, '0');\n  return `${m}:${s}`;\n}\n\n/* ===== component ===== */\nexport default function RaceLive({ raceConfig, onStopRace }) {\n  const [serverState, setServerState] = useState(null);       // circuito + summary iniziali\n  const [summary, setSummary] = useState(null);               // aggiornato dal WS (classifica server-side)\n  const [raceStatus, setRaceStatus] = useState('IN CORSO');   // mirror lato client\n  const [pilotsIndex, setPilotsIndex] = useState({});         // pilotId -> pilot object\n  const canvasRef = useRef(null);\n  const zoomRef = useRef(1);\n  const panRef = useRef({ x: 0, y: 0 });\n  const isDraggingRef = useRef(false);\n  const lastMouseRef = useRef({ x: 0, y: 0 });\n  const animRef = useRef(null);\n  const dprRef = useRef(1);\n  const circuitRef = useRef(null);\n\n  const driverPositionsRef = useRef({}); // mac -> { lat, lon, tag, color, photoTeamUrl }\n  const summaryRef = useRef(null);       // ultima summary dal server\n\n\n  // ===== fetch stato iniziale (se entro senza config locale) =====\n  useEffect(() => {\n    let alive = true;\n\n    const init = async () => {\n      if (raceConfig && raceConfig.serverMode) {\n        const r = await fetch(`${API_BASE}/api/race/state`);\n        const j = await r.json();\n        if (!alive) return;\n        if (!j.active) {\n          setServerState(null);\n          return;\n        }\n        setServerState(j);\n        setSummary(j.summary);\n        summaryRef.current = j.summary;\n        setRaceStatus(j.summary?.status || 'IN CORSO');\n        setPilotsIndex(Object.fromEntries((j.pilots || []).map(p => [p.id, p])));\n        circuitRef.current = j.circuit;\n      } else {\n        // anche se raceConfig è null, provo comunque a joinare se c'è una gara\n        const r = await fetch(`${API_BASE}/api/race/state`);\n        const j = await r.json();\n        if (!alive) return;\n        if (j.active) {\n          setServerState(j);\n          setSummary(j.summary);\n          summaryRef.current = j.summary;\n          setRaceStatus(j.summary?.status || 'IN CORSO');\n          setPilotsIndex(Object.fromEntries((j.pilots || []).map(p => [p.id, p])));\n          circuitRef.current = j.circuit;\n        }\n      }\n    };\n    init();\n    return () => { alive = false; };\n  }, [raceConfig]);\n\n  // ===== WebSocket: ricevo GPS per canvas + summary per classifica =====\n  useEffect(() => {\n    const ws = new WebSocket(WS_URL);\n\n    ws.onmessage = (ev) => {\n      try {\n        const msg = JSON.parse(ev.data);\n        if (msg?.type === 'race') {\n          setSummary(msg.payload);\n          summaryRef.current = msg.payload;  // aggiorna la ref\n          setRaceStatus(msg.payload?.status || 'IN CORSO');\n          return;\n        }\n\n        // GPS (compat: anche payload \"piano\")\n        if (msg?.type === 'gps' || (msg?.mac && msg?.lat && msg?.lon)) {\n          const mac = String(msg.mac);\n          const lb = summaryRef.current?.leaderboard || [];\n          const d = lb.find(x => x.mac === mac);\n\n          driverPositionsRef.current[mac] = {\n            lat: Number(msg.lat),\n            lon: Number(msg.lon),\n            tag: (d?.tag || 'PIL').slice(0, 4),\n            color: d?.color || '#C0FF03',\n            photoTeamUrl: d?.photoTeamUrl || null\n          };\n        }\n      } catch { }\n    };\n\n    ws.onerror = e => console.error('[WS]', e);\n\n    // ===== Canvas draw loop =====\n    const canvas = canvasRef.current;\n    if (!canvas) return () => ws.close();\n    const ctx = canvas.getContext('2d');\n    const dpr = window.devicePixelRatio || 1;\n    dprRef.current = dpr;\n\n    const ensureSize = () => {\n      const parent = canvas.parentElement;\n      const w = parent.clientWidth || 800;\n      const h = parent.clientHeight || 520;\n      if (canvas.width !== Math.floor(w * dpr) || canvas.height !== Math.floor(h * dpr)) {\n        canvas.width = Math.floor(w * dpr);\n        canvas.height = Math.floor(h * dpr);\n        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n      }\n    };\n    ensureSize();\n    const onResize = () => ensureSize();\n    window.addEventListener('resize', onResize);\n\n    const wheel = (e) => { e.preventDefault(); zoomRef.current = Math.max(0.5, Math.min(5, zoomRef.current * (e.deltaY > 0 ? 0.9 : 1.1))); };\n    const mousedown = (e) => { isDraggingRef.current = true; lastMouseRef.current = { x: e.clientX, y: e.clientY }; canvas.style.cursor = 'grabbing'; };\n    const mousemove = (e) => {\n      if (!isDraggingRef.current) return;\n      const dx = e.clientX - lastMouseRef.current.x;\n      const dy = e.clientY - lastMouseRef.current.y;\n      panRef.current.x += dx; panRef.current.y += dy;\n      lastMouseRef.current = { x: e.clientX, y: e.clientY };\n    };\n    const mouseup = () => { isDraggingRef.current = false; canvas.style.cursor = 'grab'; };\n    canvas.addEventListener('wheel', wheel, { passive: false });\n    canvas.addEventListener('mousedown', mousedown);\n    canvas.addEventListener('mousemove', mousemove);\n    canvas.addEventListener('mouseup', mouseup);\n    canvas.addEventListener('mouseleave', mouseup);\n    canvas.style.cursor = 'grab';\n\n    // proiezione\n    const projectFactory = () => {\n      const circuit = circuitRef.current;\n      if (!circuit?.sectors?.length) return null;\n      const lats = circuit.sectors.map(s => s.lat);\n      const lons = circuit.sectors.map(s => s.lon);\n      const minLat = Math.min(...lats), maxLat = Math.max(...lats);\n      const minLon = Math.min(...lons), maxLon = Math.max(...lons);\n      const centerLat = (minLat + maxLat) / 2;\n      const centerLon = (minLon + maxLon) / 2;\n      const R = 6371000;\n      const centerLatRad = centerLat * Math.PI / 180;\n      const dxList = lons.map(l => (l - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad));\n      const dyList = lats.map(l => (l - centerLat) * Math.PI / 180 * R);\n      const maxDx = Math.max(...dxList.map(Math.abs));\n      const maxDy = Math.max(...dyList.map(Math.abs));\n      const padding = 40;\n      return (lat, lon, w, h) => {\n        const maxRange = Math.max(maxDx, maxDy) * 1.1;\n        const scale = Math.min(w - padding * 2, h - padding * 2) / (maxRange * 2) * zoomRef.current;\n        const dx = (lon - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad);\n        const dy = (lat - centerLat) * Math.PI / 180 * R;\n        const x = w / 2 + dx * scale + panRef.current.x;\n        const y = h / 2 - dy * scale + panRef.current.y;\n        return { x, y, scale };\n      };\n    };\n    let project = projectFactory();\n\n    const draw = () => {\n      ensureSize();\n      const circuit = circuitRef.current;\n      const w = canvas.width / dpr;\n      const h = canvas.height / dpr;\n      ctx.clearRect(0, 0, w, h);\n      ctx.fillStyle = '#0a0a0a';\n      ctx.fillRect(0, 0, w, h);\n\n      if (circuit?.sectors?.length) {\n        if (!project) project = projectFactory();\n\n        const widthMeters = circuit.params?.widthMeters ?? 6;\n        const pts = circuit.sectors.map(s => project(s.lat, s.lon, w, h));\n        const scale = pts[0]?.scale || 1;\n        const trackPx = Math.max(6, widthMeters * scale);\n\n        ctx.strokeStyle = 'rgba(255,255,255,0.10)';\n        ctx.lineWidth = trackPx + 4;\n        ctx.lineCap = 'round';\n        ctx.lineJoin = 'round';\n        ctx.beginPath();\n        pts.forEach((p, i) => i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y));\n        ctx.closePath(); ctx.stroke();\n\n        ctx.strokeStyle = 'rgba(80, 84, 90, 0.95)';\n        ctx.lineWidth = trackPx;\n        ctx.beginPath();\n        pts.forEach((p, i) => i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y));\n        ctx.closePath(); ctx.stroke();\n\n        if (pts.length > 1) {\n          const s0 = pts[0], s1 = pts[1];\n          const ang = Math.atan2(s1.y - s0.y, s1.x - s0.x);\n          ctx.save(); ctx.translate(s0.x, s0.y); ctx.rotate(ang);\n          ctx.strokeStyle = '#ffffff';\n          ctx.lineWidth = Math.max(2, trackPx * 0.12);\n          ctx.beginPath(); ctx.moveTo(0, -trackPx * 0.5); ctx.lineTo(0, trackPx * 0.5); ctx.stroke();\n          ctx.restore();\n        }\n      }\n\n      // markers piloti: usa la REF stabile\n      Object.entries(driverPositionsRef.current).forEach(([mac, pos]) => {\n        const p = project ? project(pos.lat, pos.lon, w, h) : null;\n        if (!p) return;\n        const teamCol = pos.color || '#C0FF03';\n        const r = Math.max(5, 6 * (zoomRef.current * 0.9));\n        ctx.shadowColor = 'rgba(0,0,0,0.5)'; ctx.shadowBlur = 4;\n        ctx.fillStyle = teamCol; ctx.beginPath(); ctx.arc(p.x, p.y, r, 0, Math.PI * 2); ctx.fill();\n        ctx.shadowBlur = 0; ctx.strokeStyle = '#fff'; ctx.lineWidth = 2; ctx.stroke();\n        ctx.fillStyle = '#fff'; ctx.font = 'bold 10px Roboto, sans-serif'; ctx.textAlign = 'center';\n        ctx.fillText((pos.tag || 'PIL').slice(0, 4), p.x, p.y - (r + 6));\n      });\n\n      animRef.current = requestAnimationFrame(draw);\n    };\n    draw();\n\n    return () => {\n      window.removeEventListener('resize', onResize);\n      canvas.removeEventListener('wheel', wheel);\n      canvas.removeEventListener('mousedown', mousedown);\n      canvas.removeEventListener('mousemove', mousemove);\n      canvas.removeEventListener('mouseup', mouseup);\n      canvas.removeEventListener('mouseleave', mouseup);\n      if (animRef.current) cancelAnimationFrame(animRef.current);\n      ws.close();\n    };\n  }, []); // << esegui UNA SOLA VOLTA\n\n\n  // ===== controlli gara (status + sanzioni) =====\n  const [penPilot, setPenPilot] = useState('');\n  const [penType, setPenType] = useState('+5s');\n\n  const sendStatus = async (s) => {\n    try {\n      setRaceStatus(s);\n      await fetch(`${API_BASE}/api/race/status`, {\n        method: 'POST', headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ status: s })\n      });\n    } catch { }\n  };\n  const sendPenalty = async () => {\n    if (!penPilot) return;\n    try {\n      await fetch(`${API_BASE}/api/race/penalty`, {\n        method: 'POST', headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ pilotId: penPilot, type: penType })\n      });\n      // il server aggiornerà la summary via WS; qui basta pulire\n      setPenPilot('');\n      setPenType('+5s');\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  const statusColors = useMemo(() => {\n    switch (raceStatus) {\n      case 'RED FLAG': return { chipBg: 'rgba(225,6,0,.15)', chipBorder: '#e10600', chipText: '#ffdede', lbBorder: '#e10600' };\n      case 'YELLOW FLAG': return { chipBg: 'rgba(241,196,15,.15)', chipBorder: '#f1c40f', chipText: '#fff3c4', lbBorder: '#f1c40f' };\n      case 'FINITA': return { chipBg: 'rgba(154,163,154,.15)', chipBorder: '#9aa39a', chipText: '#e0e0e0', lbBorder: '#9aa39a' };\n      default: return { chipBg: 'rgba(21,193,48,.15)', chipBorder: '#15c130', chipText: '#e9ffe0', lbBorder: null };\n    }\n  }, [raceStatus]);\n\n  // ===== render =====\n  const circuit = serverState?.circuit;\n  const board = summary?.leaderboard || [];\n  const totalLaps = summary?.totalLaps || serverState?.totalLaps || 0;\n\n  return (\n    <div className=\"main small-top\">\n      {/* Top bar */}\n      <div className=\"rs-live-topbar\">\n        <div className=\"rs-live-left\">\n          <span className=\"chip readonly\" style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n            <span aria-hidden style={{\n              width: 10, height: 10, borderRadius: '50%', background: '#ff4d4f',\n              boxShadow: '0 0 12px rgba(255,77,79,.8)', animation: 'blink 1.2s infinite'\n            }} />\n            LIVE\n          </span>\n          <span className=\"chip readonly\">{totalLaps} giri</span>\n          <span className=\"chip readonly\" style={{\n            background: statusColors.chipBg, border: `1px solid ${statusColors.chipBorder}`,\n            color: statusColors.chipText, fontWeight: 800\n          }}>{raceStatus}</span>\n        </div>\n        <div className=\"rs-live-right\">\n          <span className=\"chip readonly\">{circuit?.name || 'Circuito'}</span>\n          {circuit?.stats?.lengthMeters && <span className=\"chip readonly\">{circuit.stats.lengthMeters.toFixed(0)} m</span>}\n          {circuit?.params?.widthMeters && <span className=\"chip readonly\">{circuit.params.widthMeters} m larghezza</span>}\n        </div>\n      </div>\n\n      {/* Griglia principale */}\n      <div className=\"rs-live-grid\">\n        <div className=\"track-card\">\n          <canvas ref={canvasRef} className=\"track-canvas\" />\n        </div>\n\n        {/* classifica laterale (server-side) */}\n        <div className=\"leaderboard-card\" style={{\n          borderColor: statusColors.lbBorder ?? 'var(--line)',\n          boxShadow: statusColors.lbBorder ? `0 8px 32px ${statusColors.lbBorder}33, inset 0 0 0 1px ${statusColors.lbBorder}55` : undefined\n        }}>\n          <div className=\"lb-header\">\n            <div className=\"lb-title\">CLASSIFICA</div>\n            <div className=\"lb-sub\">{board.length} piloti</div>\n          </div>\n          <div className=\"lb-list\">\n            {board.map((d, idx) => {\n              const fastest = summary?.bestLapOverall && d.bestLapTime && d.bestLapTime === summary.bestLapOverall;\n              const gapText = idx === 0 ? 'LEADER' : (typeof d.gap === 'string' ? `+${d.gap}` : `+${(d.gap || 0).toFixed(2)}`);\n              return (\n                <div key={d.mac} className={`lb-row ${idx === 0 ? 'lb-leader' : ''}`}>\n                  <div className=\"lb-pos\">{idx + 1}</div>\n                  <div className=\"lb-team\">\n                    {d.photoTeamUrl ? <img src={`${API_BASE}${d.photoTeamUrl}`} alt=\"\" className=\"lb-team-logo\" /> :\n                      <div className=\"lb-team-color\" style={{ background: d.color }} />}\n                  </div>\n                  <div className=\"lb-name\">{(d.tag || 'PIL').slice(0, 4)}</div>\n                  <div className=\"lb-gap\">{gapText}</div>\n                  <div className=\"lb-icons\">\n                    {fastest && <span className=\"lb-icon purple\">⏱</span>}\n                    {d.penaltySeconds > 0 && <span className=\"lb-icon\" title={`${d.penaltySeconds}s penalità`}>⚠️</span>}\n                  </div>\n                  <div className=\"lb-lap\"><span className=\"muted\">Lap</span>&nbsp;{d.lapCount}/{totalLaps}</div>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      </div>\n\n      {/* Classifica full-width con tempi + penalità */}\n      <div className=\"leaderboard-card\" style={{ marginTop: 12 }}>\n        <div className=\"lb-header\" style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'baseline' }}>\n          <div className=\"lb-title\">CLASSIFICA DETTAGLIATA</div>\n          <div className=\"lb-sub\">{board.length} piloti • ultimo giro e best</div>\n        </div>\n        <div className=\"lb-list\">\n          {board.map((d, idx) => {\n            const fastest = summary?.bestLapOverall && d.bestLapTime && d.bestLapTime === summary.bestLapOverall;\n            const pen = d.penaltySeconds || 0;\n            return (\n              <div key={`wide-${d.mac}`} className=\"lb-row\" style={{ gridTemplateColumns: '28px 28px 1fr 90px 110px 110px 110px' }}>\n                <div className=\"lb-pos\">{idx + 1}</div>\n                <div className=\"lb-team\">\n                  {d.photoTeamUrl ? <img src={`${API_BASE}${d.photoTeamUrl}`} alt=\"\" className=\"lb-team-logo\" /> :\n                    <div className=\"lb-team-color\" style={{ background: d.color }} />}\n                </div>\n                <div className=\"lb-name\">{(d.tag || 'PIL').slice(0, 4)}</div>\n                <div className=\"lb-gap\" style={{ textAlign: 'right' }}>\n                  {idx === 0 ? 'LEADER' : (typeof d.gap === 'string' ? `+${d.gap}` : `+${(d.gap || 0).toFixed(2)}`)}\n                </div>\n                <div className=\"lb-gap\" title=\"Ultimo giro\" style={{ fontWeight: 700 }}>{formatLap(d.lastLapTime)}</div>\n                <div className=\"lb-gap\" title=\"Miglior giro\" style={{ fontWeight: 700, color: fastest ? '#b085ff' : 'inherit' }}>\n                  {formatLap(d.bestLapTime)}{fastest && <span className=\"lb-icon purple\" style={{ marginLeft: 6 }}>⏱</span>}\n                </div>\n                <div className=\"lb-gap\" title=\"Penalità\" style={{ fontWeight: 700 }}>\n                  {pen > 0 ? `+${pen}s` : '—'}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* ===== COMANDI GARA ===== */}\n      <div className=\"pilot-form\" style={{ marginTop: 12 }}>\n        <h3 className=\"section-title\" style={{ marginBottom: 10 }}>COMANDI GARA</h3>\n\n        {/* riga 1: stato gara */}\n        <div style={{ display: 'flex', flexWrap: 'wrap', gap: 8, alignItems: 'center', marginBottom: 10 }}>\n          <span className=\"muted\">Stato:</span>\n          {['IN CORSO', 'FINITA', 'RED FLAG', 'YELLOW FLAG'].map(s => (\n            <button key={s} className=\"btn-ghost\"\n              onClick={() => sendStatus(s)}\n              style={{\n                borderColor: raceStatus === s ? 'rgba(192,255,3,0.6)' : 'var(--line)',\n                boxShadow: raceStatus === s ? '0 0 0 2px rgba(192,255,3,0.12) inset' : 'none',\n                fontWeight: 700\n              }}>\n              {s}\n            </button>\n          ))}\n        </div>\n\n        {/* riga 2: sanzioni */}\n        <div style={{ display: 'flex', flexWrap: 'wrap', gap: 8, alignItems: 'center' }}>\n          <span className=\"muted\">Sanzione:</span>\n          <select className=\"input\" style={{ maxWidth: 260 }} value={penPilot} onChange={e => setPenPilot(e.target.value)}>\n            <option value=\"\">-- Pilota --</option>\n            {(serverState?.pilots || []).map(p => (\n              <option key={p.id} value={p.id}>{p.name} {p.surname} ({p.team})</option>\n            ))}\n          </select>\n          <select className=\"input\" style={{ maxWidth: 220 }} value={penType} onChange={e => setPenType(e.target.value)}>\n            <option value=\"+5s\">+5s</option>\n            <option value=\"+10s\">+10s</option>\n            <option value=\"+15s\">+15s</option>\n            <option value=\"1mo avv. squalifica\">1mo avv. squalifica</option>\n            <option value=\"squalifica\">squalifica</option>\n          </select>\n          <button className=\"btn-primary\" onClick={sendPenalty} disabled={!penPilot}>Applica</button>\n\n          <div style={{ marginLeft: 'auto' }}>\n            <button className=\"btn-danger\" onClick={async () => {\n              await fetch(`${API_BASE}/api/race/stop`, { method: 'POST' }).catch(() => { });\n              onStopRace();\n            }}>Termina gara</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}