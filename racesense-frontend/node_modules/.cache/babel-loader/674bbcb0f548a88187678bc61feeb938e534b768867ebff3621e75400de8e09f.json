{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/racesense/racesense-frontend/src/pages/PilotLive.jsx\",\n  _s = $RefreshSig$();\n// src/pages/PilotLive.jsx\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport '../App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE = process.env.REACT_APP_API_BASE || `http://${window.location.hostname}:5000`;\nconst WS_URL = process.env.REACT_APP_WS_URL || `ws://${window.location.hostname}:5001`;\nconst PALETTE = ['#C0FF03', '#2ED8A7', '#6AA9FF', '#FF7A59', '#B085FF', '#FFD166', '#EF476F', '#06D6A0', '#118AB2', '#FFE66D', '#F78C6B', '#8AC926'];\nfunction colorForKey(key) {\n  let h = 0;\n  for (let i = 0; i < key.length; i++) h = h * 31 + key.charCodeAt(i) >>> 0;\n  return PALETTE[h % PALETTE.length];\n}\nconst formatLap = s => {\n  if (!s && s !== 0) return '—';\n  const m = Math.floor(s / 60);\n  const sec = (s % 60).toFixed(3);\n  return `${m}:${sec.padStart(6, '0')}`;\n};\nexport default function PilotLive() {\n  _s();\n  var _driver$position, _driver$lapCount, _driver$speedKmh, _driver$penalty, _driver$gforce$lat$to, _driver$gforce, _driver$gforce$lat, _driver$gforce$lat$to2, _driver$gforce$long$t, _driver$gforce2, _driver$gforce2$long, _driver$gforce2$long$, _driver$gforce$vert$t, _driver$gforce3, _driver$gforce3$vert, _driver$gforce3$vert$, _driver$gforce$total$, _driver$gforce4, _driver$gforce4$total, _driver$gforce4$total2, _driver$lapTimes;\n  const {\n    mac\n  } = useParams();\n  const navigate = useNavigate();\n  const [circuit, setCircuit] = useState(null);\n  const [raceStatus, setRaceStatus] = useState('IN CORSO');\n  const [totalLaps, setTotalLaps] = useState(0);\n  const [driver, setDriver] = useState(null);\n  const color = useMemo(() => colorForKey((mac || '') + ((driver === null || driver === void 0 ? void 0 : driver.team) || '') + ((driver === null || driver === void 0 ? void 0 : driver.tag) || '')), [mac, driver]);\n\n  // trail\n  const trailsRef = useRef([]);\n  const TRAIL_MAX_AGE_MS = 30000;\n  const TRAIL_MAX_LEN = 160;\n\n  // canvas refs\n  const canvasRef = useRef(null);\n  const animFrameRef = useRef(null);\n  const zoomRef = useRef(1);\n  const panRef = useRef({\n    x: 0,\n    y: 0\n  });\n  const isDraggingRef = useRef(false);\n  const lastMouseRef = useRef({\n    x: 0,\n    y: 0\n  });\n\n  // Bootstrap stato pilota (API) + circuito\n  useEffect(() => {\n    let cancelled = false;\n    const load = async () => {\n      try {\n        const r = await fetch(`${API_BASE}/api/race/pilot/${mac}`);\n        if (!r.ok) throw new Error('Pilota non trovato o gara non attiva');\n        const j = await r.json();\n        if (cancelled) return;\n        setCircuit(j.circuit || null);\n        setRaceStatus(j.raceStatus || 'IN CORSO');\n        setTotalLaps(j.totalLaps || 0);\n        setDriver(j.pilot || null);\n      } catch (e) {\n        console.error(e);\n        setDriver(null);\n      }\n    };\n    load();\n    return () => {\n      cancelled = true;\n    };\n  }, [mac]);\n\n  // WebSocket: filtra solo il pilota richiesto\n  useEffect(() => {\n    const ws = new WebSocket(WS_URL);\n    ws.onmessage = event => {\n      try {\n        const data = JSON.parse(event.data);\n        if ((data === null || data === void 0 ? void 0 : data.type) === 'race_snapshot') {\n          setRaceStatus(data.raceStatus || 'IN CORSO');\n          setTotalLaps(data.totalLaps || 0);\n          setCircuit(data.circuit || null);\n          const d = (data.drivers || []).find(x => String(x.mac).toUpperCase() === String(mac).toUpperCase());\n          if (d) {\n            const now = Date.now();\n            const t = trailsRef.current || [];\n            trailsRef.current = [...t, {\n              lat: d.lat,\n              lon: d.lon,\n              ts: now\n            }].slice(-TRAIL_MAX_LEN);\n            setDriver(d);\n          }\n        } else if ((data === null || data === void 0 ? void 0 : data.type) === 'race_inactive') {\n          setRaceStatus('FINITA');\n        }\n      } catch {}\n    };\n    ws.onerror = e => console.error('[PilotLive] WS error', e);\n    return () => {\n      try {\n        ws.close();\n      } catch {}\n    };\n  }, [mac]);\n\n  // Canvas rendering\n  useEffect(() => {\n    if (!circuit || !(circuit !== null && circuit !== void 0 && circuit.params) || !canvasRef.current) return;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    const dpr = window.devicePixelRatio || 1;\n    const ensureSize = () => {\n      const w = canvas.parentElement.clientWidth || 600;\n      const h = canvas.parentElement.clientHeight || 520;\n      if (canvas.width !== Math.floor(w * dpr) || canvas.height !== Math.floor(h * dpr)) {\n        canvas.width = Math.floor(w * dpr);\n        canvas.height = Math.floor(h * dpr);\n        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n      }\n    };\n    const onResize = () => ensureSize();\n    ensureSize();\n    window.addEventListener('resize', onResize);\n    const wheel = e => {\n      e.preventDefault();\n      zoomRef.current = Math.max(0.5, Math.min(5, zoomRef.current * (e.deltaY > 0 ? 0.9 : 1.1)));\n    };\n    const mousedown = e => {\n      isDraggingRef.current = true;\n      lastMouseRef.current = {\n        x: e.clientX,\n        y: e.clientY\n      };\n      canvas.style.cursor = 'grabbing';\n    };\n    const mousemove = e => {\n      if (!isDraggingRef.current) return;\n      panRef.current.x += e.clientX - lastMouseRef.current.x;\n      panRef.current.y += e.clientY - lastMouseRef.current.y;\n      lastMouseRef.current = {\n        x: e.clientX,\n        y: e.clientY\n      };\n    };\n    const mouseup = () => {\n      isDraggingRef.current = false;\n      canvas.style.cursor = 'grab';\n    };\n    canvas.addEventListener('wheel', wheel, {\n      passive: false\n    });\n    canvas.addEventListener('mousedown', mousedown);\n    canvas.addEventListener('mousemove', mousemove);\n    canvas.addEventListener('mouseup', mouseup);\n    canvas.addEventListener('mouseleave', mouseup);\n    canvas.style.cursor = 'grab';\n    const sectors = window.__RACESENSE_SECTORS_CACHE__ = window.__RACESENSE_SECTORS_CACHE__ || circuit.sectors || [];\n    // NB: la route /api/race/pilot/:mac non ritorna i sectors (solo meta);\n    // ma in /race li abbiamo già; per sicurezza il PilotLive si affida al circuito nel WS snapshot.\n    // Se non arrivassero, puoi adattare il backend a inviare anche sectors in snapshot (non necessario se già inviati altrove).\n\n    const lats = ((circuit === null || circuit === void 0 ? void 0 : circuit.sectors) || []).map(s => s.lat);\n    const lons = ((circuit === null || circuit === void 0 ? void 0 : circuit.sectors) || []).map(s => s.lon);\n    if (!lats.length || !lons.length) {\n      // fallback: usa last cache dal WS (se presente nello snapshot di /race/state)\n    }\n    const minLat = Math.min(...lats),\n      maxLat = Math.max(...lats);\n    const minLon = Math.min(...lons),\n      maxLon = Math.max(...lons);\n    const centerLat = (minLat + maxLat) / 2,\n      centerLon = (minLon + maxLon) / 2;\n    const R = 6371000,\n      centerLatRad = centerLat * Math.PI / 180;\n    const dxList = lons.map(l => (l - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad));\n    const dyList = lats.map(l => (l - centerLat) * Math.PI / 180 * R);\n    const maxDx = Math.max(...dxList.map(Math.abs));\n    const maxDy = Math.max(...dyList.map(Math.abs));\n    const padding = 40;\n    const project = (lat, lon) => {\n      const w = canvas.width / dpr,\n        h = canvas.height / dpr;\n      const maxRange = Math.max(maxDx, maxDy) * 1.1;\n      const scale = Math.min(w - padding * 2, h - padding * 2) / (maxRange * 2) * zoomRef.current;\n      const dx = (lon - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad);\n      const dy = (lat - centerLat) * Math.PI / 180 * R;\n      return {\n        x: w / 2 + dx * scale + panRef.current.x,\n        y: h / 2 - dy * scale + panRef.current.y,\n        scale\n      };\n    };\n    const draw = () => {\n      var _circuit$params$width, _circuit$params, _pts$;\n      ensureSize();\n      const w = canvas.width / dpr,\n        h = canvas.height / dpr;\n      ctx.clearRect(0, 0, w, h);\n      ctx.fillStyle = '#0a0a0a';\n      ctx.fillRect(0, 0, w, h);\n      const widthMeters = (_circuit$params$width = circuit === null || circuit === void 0 ? void 0 : (_circuit$params = circuit.params) === null || _circuit$params === void 0 ? void 0 : _circuit$params.widthMeters) !== null && _circuit$params$width !== void 0 ? _circuit$params$width : 6;\n      const pts = ((circuit === null || circuit === void 0 ? void 0 : circuit.sectors) || []).map(s => project(s.lat, s.lon));\n      const scale = ((_pts$ = pts[0]) === null || _pts$ === void 0 ? void 0 : _pts$.scale) || 1;\n      const trackPx = Math.max(6, widthMeters * scale);\n      ctx.strokeStyle = 'rgba(255,255,255,0.10)';\n      ctx.lineWidth = trackPx + 4;\n      ctx.lineCap = 'round';\n      ctx.lineJoin = 'round';\n      ctx.beginPath();\n      pts.forEach((p, i) => i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y));\n      ctx.closePath();\n      ctx.stroke();\n      ctx.strokeStyle = 'rgba(80,84,90,0.95)';\n      ctx.lineWidth = trackPx;\n      ctx.beginPath();\n      pts.forEach((p, i) => i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y));\n      ctx.closePath();\n      ctx.stroke();\n      if (pts.length > 1) {\n        const s0 = pts[0],\n          s1 = pts[1];\n        const ang = Math.atan2(s1.y - s0.y, s1.x - s0.x);\n        ctx.save();\n        ctx.translate(s0.x, s0.y);\n        ctx.rotate(ang);\n        ctx.strokeStyle = '#ffffff';\n        ctx.lineWidth = Math.max(2, trackPx * 0.12);\n        ctx.beginPath();\n        ctx.moveTo(0, -trackPx * 0.5);\n        ctx.lineTo(0, trackPx * 0.5);\n        ctx.stroke();\n        ctx.restore();\n      }\n\n      // trail singolo\n      const now = Date.now();\n      trailsRef.current = (trailsRef.current || []).filter(p => now - p.ts <= TRAIL_MAX_AGE_MS).slice(-TRAIL_MAX_LEN);\n      const trail = trailsRef.current || [];\n      if (trail.length > 1) {\n        for (let t = 1; t < trail.length; t++) {\n          const prev = project(trail[t - 1].lat, trail[t - 1].lon);\n          const cur = project(trail[t].lat, trail[t].lon);\n          const ageFrac = Math.min(1, (now - trail[t].ts) / TRAIL_MAX_AGE_MS);\n          const alpha = 0.8 * (1 - ageFrac);\n          let rgba = color;\n          if (color.startsWith('#')) {\n            const hex = color.slice(1),\n              full = hex.length === 3 ? hex.split('').map(c => c + c).join('') : hex;\n            const v = parseInt(full, 16),\n              r = v >> 16 & 255,\n              g = v >> 8 & 255,\n              b = v & 255;\n            rgba = `rgba(${r},${g},${b},${alpha})`;\n          }\n          ctx.strokeStyle = rgba;\n          ctx.lineWidth = Math.max(2, trackPx * 0.12);\n          ctx.beginPath();\n          ctx.moveTo(prev.x, prev.y);\n          ctx.lineTo(cur.x, cur.y);\n          ctx.stroke();\n        }\n      }\n\n      // dot pilota\n      if (driver) {\n        const p = project(driver.lat, driver.lon);\n        const r = Math.max(6, trackPx * 0.2);\n        let fill = color;\n        if (fill.startsWith('#')) {\n          const hex = fill.slice(1),\n            full = hex.length === 3 ? hex.split('').map(c => c + c).join('') : hex;\n          const v = parseInt(full, 16),\n            rr = v >> 16 & 255,\n            gg = v >> 8 & 255,\n            bb = v & 255;\n          fill = `rgba(${rr},${gg},${bb},1)`;\n        }\n        ctx.shadowColor = 'rgba(0,0,0,0.5)';\n        ctx.shadowBlur = 4;\n        ctx.fillStyle = fill;\n        ctx.beginPath();\n        ctx.arc(p.x, p.y, r, 0, Math.PI * 2);\n        ctx.fill();\n        ctx.shadowBlur = 0;\n        ctx.strokeStyle = '#fff';\n        ctx.lineWidth = 2;\n        ctx.stroke();\n        ctx.fillStyle = '#fff';\n        ctx.font = 'bold 11px Roboto, sans-serif';\n        ctx.textAlign = 'center';\n        ctx.fillText(driver.tag || 'PIL', p.x, p.y - (r + 10));\n      }\n      animFrameRef.current = requestAnimationFrame(draw);\n    };\n    draw();\n    return () => {\n      window.removeEventListener('resize', onResize);\n      canvas.removeEventListener('wheel', wheel);\n      canvas.removeEventListener('mousedown', mousedown);\n      canvas.removeEventListener('mousemove', mousemove);\n      canvas.removeEventListener('mouseup', mouseup);\n      canvas.removeEventListener('mouseleave', mouseup);\n      if (animFrameRef.current) cancelAnimationFrame(animFrameRef.current);\n    };\n  }, [circuit, driver, color]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main small-top\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"rs-live-topbar\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rs-live-left\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          children: \"PILOTA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          style: {\n            fontWeight: 800\n          },\n          children: (driver === null || driver === void 0 ? void 0 : driver.tag) || mac\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          children: (driver === null || driver === void 0 ? void 0 : driver.fullName) || '—'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          children: [totalLaps, \" giri\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          style: {\n            fontWeight: 900\n          },\n          children: raceStatus\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rs-live-right\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-ghost\",\n          onClick: () => navigate('/race'),\n          children: \"\\u2B05 Torna alla gara\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"rs-live-grid\",\n      style: {\n        gridTemplateColumns: '1fr 420px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"track-card\",\n        children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n          ref: canvasRef,\n          className: \"track-canvas\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"leaderboard-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-header\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lb-title\",\n            children: \"DETTAGLI PILOTA\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 48\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-list\",\n          style: {\n            maxHeight: 'unset'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lb-row\",\n            style: {\n              gridTemplateColumns: '1fr 1fr 1fr'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"muted\",\n                children: \"Posizione\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 254,\n                columnNumber: 34\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontWeight: 900\n                },\n                children: (_driver$position = driver === null || driver === void 0 ? void 0 : driver.position) !== null && _driver$position !== void 0 ? _driver$position : '—'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 254,\n                columnNumber: 72\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 254,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"muted\",\n                children: \"Lap\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 255,\n                columnNumber: 34\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontWeight: 900\n                },\n                children: [(_driver$lapCount = driver === null || driver === void 0 ? void 0 : driver.lapCount) !== null && _driver$lapCount !== void 0 ? _driver$lapCount : 0, \"/\", totalLaps]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 255,\n                columnNumber: 66\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 255,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"muted\",\n                children: \"Velocit\\xE0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 256,\n                columnNumber: 34\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontWeight: 900\n                },\n                children: [((_driver$speedKmh = driver === null || driver === void 0 ? void 0 : driver.speedKmh) !== null && _driver$speedKmh !== void 0 ? _driver$speedKmh : 0).toFixed(1), \" km/h\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 256,\n                columnNumber: 71\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 256,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 253,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lb-row\",\n            style: {\n              gridTemplateColumns: '1fr 1fr 1fr'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"muted\",\n                children: \"Ultimo giro\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 260,\n                columnNumber: 34\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontWeight: 900\n                },\n                children: formatLap(driver === null || driver === void 0 ? void 0 : driver.lastLapTime)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 260,\n                columnNumber: 74\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"muted\",\n                children: \"Miglior giro\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 261,\n                columnNumber: 34\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontWeight: 900\n                },\n                children: formatLap(driver === null || driver === void 0 ? void 0 : driver.bestLapTime)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 261,\n                columnNumber: 75\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 261,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"muted\",\n                children: \"Penalit\\xE0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 262,\n                columnNumber: 34\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontWeight: 900\n                },\n                children: (driver === null || driver === void 0 ? void 0 : (_driver$penalty = driver.penalty) === null || _driver$penalty === void 0 ? void 0 : _driver$penalty.summary) || '—'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 262,\n                columnNumber: 71\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lb-row\",\n            style: {\n              gridTemplateColumns: '1fr 1fr 1fr 1fr'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"muted\",\n                children: \"G-Lat\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 267,\n                columnNumber: 34\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontWeight: 900\n                },\n                children: (_driver$gforce$lat$to = driver === null || driver === void 0 ? void 0 : (_driver$gforce = driver.gforce) === null || _driver$gforce === void 0 ? void 0 : (_driver$gforce$lat = _driver$gforce.lat) === null || _driver$gforce$lat === void 0 ? void 0 : (_driver$gforce$lat$to2 = _driver$gforce$lat.toFixed) === null || _driver$gforce$lat$to2 === void 0 ? void 0 : _driver$gforce$lat$to2.call(_driver$gforce$lat, 2)) !== null && _driver$gforce$lat$to !== void 0 ? _driver$gforce$lat$to : '—'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 267,\n                columnNumber: 68\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 267,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"muted\",\n                children: \"G-Long\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 268,\n                columnNumber: 34\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontWeight: 900\n                },\n                children: (_driver$gforce$long$t = driver === null || driver === void 0 ? void 0 : (_driver$gforce2 = driver.gforce) === null || _driver$gforce2 === void 0 ? void 0 : (_driver$gforce2$long = _driver$gforce2.long) === null || _driver$gforce2$long === void 0 ? void 0 : (_driver$gforce2$long$ = _driver$gforce2$long.toFixed) === null || _driver$gforce2$long$ === void 0 ? void 0 : _driver$gforce2$long$.call(_driver$gforce2$long, 2)) !== null && _driver$gforce$long$t !== void 0 ? _driver$gforce$long$t : '—'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 268,\n                columnNumber: 69\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 268,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"muted\",\n                children: \"G-Vert\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 269,\n                columnNumber: 34\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontWeight: 900\n                },\n                children: (_driver$gforce$vert$t = driver === null || driver === void 0 ? void 0 : (_driver$gforce3 = driver.gforce) === null || _driver$gforce3 === void 0 ? void 0 : (_driver$gforce3$vert = _driver$gforce3.vert) === null || _driver$gforce3$vert === void 0 ? void 0 : (_driver$gforce3$vert$ = _driver$gforce3$vert.toFixed) === null || _driver$gforce3$vert$ === void 0 ? void 0 : _driver$gforce3$vert$.call(_driver$gforce3$vert, 2)) !== null && _driver$gforce$vert$t !== void 0 ? _driver$gforce$vert$t : '—'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 269,\n                columnNumber: 69\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"muted\",\n                children: \"G-Total\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 270,\n                columnNumber: 34\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontWeight: 900\n                },\n                children: (_driver$gforce$total$ = driver === null || driver === void 0 ? void 0 : (_driver$gforce4 = driver.gforce) === null || _driver$gforce4 === void 0 ? void 0 : (_driver$gforce4$total = _driver$gforce4.total) === null || _driver$gforce4$total === void 0 ? void 0 : (_driver$gforce4$total2 = _driver$gforce4$total.toFixed) === null || _driver$gforce4$total2 === void 0 ? void 0 : _driver$gforce4$total2.call(_driver$gforce4$total, 2)) !== null && _driver$gforce$total$ !== void 0 ? _driver$gforce$total$ : '—'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 270,\n                columnNumber: 70\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 266,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"pilot-form\",\n            style: {\n              marginTop: 12\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"section-title\",\n              style: {\n                margin: 0,\n                fontSize: '1.2rem'\n              },\n              children: \"Tempi di tutti i giri\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 275,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-list\",\n              style: {\n                maxHeight: '40vh'\n              },\n              children: driver !== null && driver !== void 0 && (_driver$lapTimes = driver.lapTimes) !== null && _driver$lapTimes !== void 0 && _driver$lapTimes.length ? driver.lapTimes.map((t, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-row\",\n                style: {\n                  gridTemplateColumns: '80px 1fr 1fr'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"lb-pos\",\n                  children: i + 1\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 279,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"lb-name\",\n                  children: \"Tempo\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 280,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"lb-gap\",\n                  style: {\n                    textAlign: 'right',\n                    color: '#e9ffe0',\n                    fontWeight: 900\n                  },\n                  children: formatLap(t)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 281,\n                  columnNumber: 41\n                }, this)]\n              }, i, true, {\n                fileName: _jsxFileName,\n                lineNumber: 278,\n                columnNumber: 37\n              }, this)) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"muted\",\n                children: \"Nessun giro completato ancora\\u2026\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 284,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 276,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 274,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 230,\n    columnNumber: 9\n  }, this);\n}\n_s(PilotLive, \"p/Dr9xxBUKW8t3ugoWf6VNwHFLo=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = PilotLive;\nvar _c;\n$RefreshReg$(_c, \"PilotLive\");","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","useParams","useNavigate","jsxDEV","_jsxDEV","API_BASE","process","env","REACT_APP_API_BASE","window","location","hostname","WS_URL","REACT_APP_WS_URL","PALETTE","colorForKey","key","h","i","length","charCodeAt","formatLap","s","m","Math","floor","sec","toFixed","padStart","PilotLive","_s","_driver$position","_driver$lapCount","_driver$speedKmh","_driver$penalty","_driver$gforce$lat$to","_driver$gforce","_driver$gforce$lat","_driver$gforce$lat$to2","_driver$gforce$long$t","_driver$gforce2","_driver$gforce2$long","_driver$gforce2$long$","_driver$gforce$vert$t","_driver$gforce3","_driver$gforce3$vert","_driver$gforce3$vert$","_driver$gforce$total$","_driver$gforce4","_driver$gforce4$total","_driver$gforce4$total2","_driver$lapTimes","mac","navigate","circuit","setCircuit","raceStatus","setRaceStatus","totalLaps","setTotalLaps","driver","setDriver","color","team","tag","trailsRef","TRAIL_MAX_AGE_MS","TRAIL_MAX_LEN","canvasRef","animFrameRef","zoomRef","panRef","x","y","isDraggingRef","lastMouseRef","cancelled","load","r","fetch","ok","Error","j","json","pilot","e","console","error","ws","WebSocket","onmessage","event","data","JSON","parse","type","d","drivers","find","String","toUpperCase","now","Date","t","current","lat","lon","ts","slice","onerror","close","params","canvas","ctx","getContext","dpr","devicePixelRatio","ensureSize","w","parentElement","clientWidth","clientHeight","width","height","setTransform","onResize","addEventListener","wheel","preventDefault","max","min","deltaY","mousedown","clientX","clientY","style","cursor","mousemove","mouseup","passive","sectors","__RACESENSE_SECTORS_CACHE__","lats","map","lons","minLat","maxLat","minLon","maxLon","centerLat","centerLon","R","centerLatRad","PI","dxList","l","cos","dyList","maxDx","abs","maxDy","padding","project","maxRange","scale","dx","dy","draw","_circuit$params$width","_circuit$params","_pts$","clearRect","fillStyle","fillRect","widthMeters","pts","trackPx","strokeStyle","lineWidth","lineCap","lineJoin","beginPath","forEach","p","lineTo","moveTo","closePath","stroke","s0","s1","ang","atan2","save","translate","rotate","restore","filter","trail","prev","cur","ageFrac","alpha","rgba","startsWith","hex","full","split","c","join","v","parseInt","g","b","fill","rr","gg","bb","shadowColor","shadowBlur","arc","font","textAlign","fillText","requestAnimationFrame","removeEventListener","cancelAnimationFrame","className","children","fileName","_jsxFileName","lineNumber","columnNumber","fontWeight","fullName","onClick","gridTemplateColumns","ref","maxHeight","position","lapCount","speedKmh","lastLapTime","bestLapTime","penalty","summary","gforce","call","long","vert","total","marginTop","margin","fontSize","lapTimes","_c","$RefreshReg$"],"sources":["/home/ubuntu/racesense/racesense-frontend/src/pages/PilotLive.jsx"],"sourcesContent":["// src/pages/PilotLive.jsx\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport '../App.css';\n\nconst API_BASE = process.env.REACT_APP_API_BASE || `http://${window.location.hostname}:5000`;\nconst WS_URL = process.env.REACT_APP_WS_URL || `ws://${window.location.hostname}:5001`;\n\nconst PALETTE = ['#C0FF03', '#2ED8A7', '#6AA9FF', '#FF7A59', '#B085FF', '#FFD166', '#EF476F', '#06D6A0', '#118AB2', '#FFE66D', '#F78C6B', '#8AC926'];\nfunction colorForKey(key) {\n    let h = 0; for (let i = 0; i < key.length; i++) h = (h * 31 + key.charCodeAt(i)) >>> 0;\n    return PALETTE[h % PALETTE.length];\n}\nconst formatLap = (s) => {\n    if (!s && s !== 0) return '—';\n    const m = Math.floor(s / 60);\n    const sec = (s % 60).toFixed(3);\n    return `${m}:${sec.padStart(6, '0')}`;\n};\n\nexport default function PilotLive() {\n    const { mac } = useParams();\n    const navigate = useNavigate();\n    const [circuit, setCircuit] = useState(null);\n    const [raceStatus, setRaceStatus] = useState('IN CORSO');\n    const [totalLaps, setTotalLaps] = useState(0);\n    const [driver, setDriver] = useState(null);\n\n    const color = useMemo(() => colorForKey((mac || '') + (driver?.team || '') + (driver?.tag || '')), [mac, driver]);\n\n    // trail\n    const trailsRef = useRef([]);\n    const TRAIL_MAX_AGE_MS = 30000;\n    const TRAIL_MAX_LEN = 160;\n\n    // canvas refs\n    const canvasRef = useRef(null);\n    const animFrameRef = useRef(null);\n    const zoomRef = useRef(1);\n    const panRef = useRef({ x: 0, y: 0 });\n    const isDraggingRef = useRef(false);\n    const lastMouseRef = useRef({ x: 0, y: 0 });\n\n    // Bootstrap stato pilota (API) + circuito\n    useEffect(() => {\n        let cancelled = false;\n        const load = async () => {\n            try {\n                const r = await fetch(`${API_BASE}/api/race/pilot/${mac}`);\n                if (!r.ok) throw new Error('Pilota non trovato o gara non attiva');\n                const j = await r.json();\n                if (cancelled) return;\n                setCircuit(j.circuit || null);\n                setRaceStatus(j.raceStatus || 'IN CORSO');\n                setTotalLaps(j.totalLaps || 0);\n                setDriver(j.pilot || null);\n            } catch (e) {\n                console.error(e);\n                setDriver(null);\n            }\n        };\n        load();\n        return () => { cancelled = true; };\n    }, [mac]);\n\n    // WebSocket: filtra solo il pilota richiesto\n    useEffect(() => {\n        const ws = new WebSocket(WS_URL);\n        ws.onmessage = (event) => {\n            try {\n                const data = JSON.parse(event.data);\n                if (data?.type === 'race_snapshot') {\n                    setRaceStatus(data.raceStatus || 'IN CORSO');\n                    setTotalLaps(data.totalLaps || 0);\n                    setCircuit(data.circuit || null);\n                    const d = (data.drivers || []).find(x => String(x.mac).toUpperCase() === String(mac).toUpperCase());\n                    if (d) {\n                        const now = Date.now();\n                        const t = trailsRef.current || [];\n                        trailsRef.current = [...t, { lat: d.lat, lon: d.lon, ts: now }].slice(-TRAIL_MAX_LEN);\n                        setDriver(d);\n                    }\n                } else if (data?.type === 'race_inactive') {\n                    setRaceStatus('FINITA');\n                }\n            } catch { }\n        };\n        ws.onerror = (e) => console.error('[PilotLive] WS error', e);\n        return () => { try { ws.close(); } catch { } };\n    }, [mac]);\n\n    // Canvas rendering\n    useEffect(() => {\n        if (!circuit || !circuit?.params || !canvasRef.current) return;\n\n        const canvas = canvasRef.current;\n        const ctx = canvas.getContext('2d');\n        const dpr = window.devicePixelRatio || 1;\n\n        const ensureSize = () => {\n            const w = canvas.parentElement.clientWidth || 600;\n            const h = canvas.parentElement.clientHeight || 520;\n            if (canvas.width !== Math.floor(w * dpr) || canvas.height !== Math.floor(h * dpr)) {\n                canvas.width = Math.floor(w * dpr); canvas.height = Math.floor(h * dpr);\n                ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n            }\n        };\n        const onResize = () => ensureSize();\n        ensureSize();\n        window.addEventListener('resize', onResize);\n\n        const wheel = (e) => { e.preventDefault(); zoomRef.current = Math.max(0.5, Math.min(5, zoomRef.current * (e.deltaY > 0 ? 0.9 : 1.1))); };\n        const mousedown = (e) => { isDraggingRef.current = true; lastMouseRef.current = { x: e.clientX, y: e.clientY }; canvas.style.cursor = 'grabbing'; };\n        const mousemove = (e) => { if (!isDraggingRef.current) return; panRef.current.x += e.clientX - lastMouseRef.current.x; panRef.current.y += e.clientY - lastMouseRef.current.y; lastMouseRef.current = { x: e.clientX, y: e.clientY }; };\n        const mouseup = () => { isDraggingRef.current = false; canvas.style.cursor = 'grab'; };\n        canvas.addEventListener('wheel', wheel, { passive: false });\n        canvas.addEventListener('mousedown', mousedown);\n        canvas.addEventListener('mousemove', mousemove);\n        canvas.addEventListener('mouseup', mouseup);\n        canvas.addEventListener('mouseleave', mouseup);\n        canvas.style.cursor = 'grab';\n\n        const sectors = (window.__RACESENSE_SECTORS_CACHE__ = window.__RACESENSE_SECTORS_CACHE__ || circuit.sectors || []);\n        // NB: la route /api/race/pilot/:mac non ritorna i sectors (solo meta);\n        // ma in /race li abbiamo già; per sicurezza il PilotLive si affida al circuito nel WS snapshot.\n        // Se non arrivassero, puoi adattare il backend a inviare anche sectors in snapshot (non necessario se già inviati altrove).\n\n        const lats = (circuit?.sectors || []).map(s => s.lat);\n        const lons = (circuit?.sectors || []).map(s => s.lon);\n        if (!lats.length || !lons.length) {\n            // fallback: usa last cache dal WS (se presente nello snapshot di /race/state)\n        }\n        const minLat = Math.min(...lats), maxLat = Math.max(...lats);\n        const minLon = Math.min(...lons), maxLon = Math.max(...lons);\n        const centerLat = (minLat + maxLat) / 2, centerLon = (minLon + maxLon) / 2;\n        const R = 6371000, centerLatRad = centerLat * Math.PI / 180;\n        const dxList = lons.map(l => (l - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad));\n        const dyList = lats.map(l => (l - centerLat) * Math.PI / 180 * R);\n        const maxDx = Math.max(...dxList.map(Math.abs));\n        const maxDy = Math.max(...dyList.map(Math.abs));\n        const padding = 40;\n\n        const project = (lat, lon) => {\n            const w = canvas.width / dpr, h = canvas.height / dpr;\n            const maxRange = Math.max(maxDx, maxDy) * 1.1;\n            const scale = Math.min(w - padding * 2, h - padding * 2) / (maxRange * 2) * zoomRef.current;\n            const dx = (lon - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad);\n            const dy = (lat - centerLat) * Math.PI / 180 * R;\n            return { x: w / 2 + dx * scale + panRef.current.x, y: h / 2 - dy * scale + panRef.current.y, scale };\n        };\n\n        const draw = () => {\n            ensureSize();\n            const w = canvas.width / dpr, h = canvas.height / dpr;\n            ctx.clearRect(0, 0, w, h);\n            ctx.fillStyle = '#0a0a0a'; ctx.fillRect(0, 0, w, h);\n\n            const widthMeters = circuit?.params?.widthMeters ?? 6;\n            const pts = (circuit?.sectors || []).map(s => project(s.lat, s.lon));\n            const scale = pts[0]?.scale || 1;\n            const trackPx = Math.max(6, widthMeters * scale);\n\n            ctx.strokeStyle = 'rgba(255,255,255,0.10)'; ctx.lineWidth = trackPx + 4; ctx.lineCap = 'round'; ctx.lineJoin = 'round';\n            ctx.beginPath(); pts.forEach((p, i) => i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y)); ctx.closePath(); ctx.stroke();\n            ctx.strokeStyle = 'rgba(80,84,90,0.95)'; ctx.lineWidth = trackPx;\n            ctx.beginPath(); pts.forEach((p, i) => i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y)); ctx.closePath(); ctx.stroke();\n\n            if (pts.length > 1) {\n                const s0 = pts[0], s1 = pts[1]; const ang = Math.atan2(s1.y - s0.y, s1.x - s0.x);\n                ctx.save(); ctx.translate(s0.x, s0.y); ctx.rotate(ang);\n                ctx.strokeStyle = '#ffffff'; ctx.lineWidth = Math.max(2, trackPx * 0.12);\n                ctx.beginPath(); ctx.moveTo(0, -trackPx * 0.5); ctx.lineTo(0, trackPx * 0.5); ctx.stroke(); ctx.restore();\n            }\n\n            // trail singolo\n            const now = Date.now();\n            trailsRef.current = (trailsRef.current || []).filter(p => now - p.ts <= TRAIL_MAX_AGE_MS).slice(-TRAIL_MAX_LEN);\n            const trail = trailsRef.current || [];\n            if (trail.length > 1) {\n                for (let t = 1; t < trail.length; t++) {\n                    const prev = project(trail[t - 1].lat, trail[t - 1].lon);\n                    const cur = project(trail[t].lat, trail[t].lon);\n                    const ageFrac = Math.min(1, (now - trail[t].ts) / TRAIL_MAX_AGE_MS);\n                    const alpha = 0.8 * (1 - ageFrac);\n                    let rgba = color;\n                    if (color.startsWith('#')) {\n                        const hex = color.slice(1), full = hex.length === 3 ? hex.split('').map(c => c + c).join('') : hex;\n                        const v = parseInt(full, 16), r = (v >> 16) & 255, g = (v >> 8) & 255, b = v & 255;\n                        rgba = `rgba(${r},${g},${b},${alpha})`;\n                    }\n                    ctx.strokeStyle = rgba; ctx.lineWidth = Math.max(2, trackPx * 0.12);\n                    ctx.beginPath(); ctx.moveTo(prev.x, prev.y); ctx.lineTo(cur.x, cur.y); ctx.stroke();\n                }\n            }\n\n            // dot pilota\n            if (driver) {\n                const p = project(driver.lat, driver.lon);\n                const r = Math.max(6, trackPx * 0.2);\n                let fill = color;\n                if (fill.startsWith('#')) {\n                    const hex = fill.slice(1), full = hex.length === 3 ? hex.split('').map(c => c + c).join('') : hex;\n                    const v = parseInt(full, 16), rr = (v >> 16) & 255, gg = (v >> 8) & 255, bb = v & 255;\n                    fill = `rgba(${rr},${gg},${bb},1)`;\n                }\n                ctx.shadowColor = 'rgba(0,0,0,0.5)'; ctx.shadowBlur = 4;\n                ctx.fillStyle = fill; ctx.beginPath(); ctx.arc(p.x, p.y, r, 0, Math.PI * 2); ctx.fill();\n                ctx.shadowBlur = 0; ctx.strokeStyle = '#fff'; ctx.lineWidth = 2; ctx.stroke();\n\n                ctx.fillStyle = '#fff'; ctx.font = 'bold 11px Roboto, sans-serif'; ctx.textAlign = 'center';\n                ctx.fillText(driver.tag || 'PIL', p.x, p.y - (r + 10));\n            }\n\n            animFrameRef.current = requestAnimationFrame(draw);\n        };\n        draw();\n\n        return () => {\n            window.removeEventListener('resize', onResize);\n            canvas.removeEventListener('wheel', wheel);\n            canvas.removeEventListener('mousedown', mousedown);\n            canvas.removeEventListener('mousemove', mousemove);\n            canvas.removeEventListener('mouseup', mouseup);\n            canvas.removeEventListener('mouseleave', mouseup);\n            if (animFrameRef.current) cancelAnimationFrame(animFrameRef.current);\n        };\n    }, [circuit, driver, color]);\n\n    return (\n        <div className=\"main small-top\">\n            <div className=\"rs-live-topbar\">\n                <div className=\"rs-live-left\">\n                    <span className=\"chip readonly\">PILOTA</span>\n                    <span className=\"chip readonly\" style={{ fontWeight: 800 }}>{driver?.tag || mac}</span>\n                    <span className=\"chip readonly\">{driver?.fullName || '—'}</span>\n                    <span className=\"chip readonly\">{totalLaps} giri</span>\n                    <span className=\"chip readonly\" style={{ fontWeight: 900 }}>{raceStatus}</span>\n                </div>\n                <div className=\"rs-live-right\">\n                    <button className=\"btn-ghost\" onClick={() => navigate('/race')}>⬅ Torna alla gara</button>\n                </div>\n            </div>\n\n            <div className=\"rs-live-grid\" style={{ gridTemplateColumns: '1fr 420px' }}>\n                <div className=\"track-card\">\n                    <canvas ref={canvasRef} className=\"track-canvas\" />\n                </div>\n\n                <div className=\"leaderboard-card\">\n                    <div className=\"lb-header\"><div className=\"lb-title\">DETTAGLI PILOTA</div></div>\n                    <div className=\"lb-list\" style={{ maxHeight: 'unset' }}>\n                        {/* Info veloci */}\n                        <div className=\"lb-row\" style={{ gridTemplateColumns: '1fr 1fr 1fr' }}>\n                            <div><div className=\"muted\">Posizione</div><div style={{ fontWeight: 900 }}>{driver?.position ?? '—'}</div></div>\n                            <div><div className=\"muted\">Lap</div><div style={{ fontWeight: 900 }}>{driver?.lapCount ?? 0}/{totalLaps}</div></div>\n                            <div><div className=\"muted\">Velocità</div><div style={{ fontWeight: 900 }}>{(driver?.speedKmh ?? 0).toFixed(1)} km/h</div></div>\n                        </div>\n\n                        <div className=\"lb-row\" style={{ gridTemplateColumns: '1fr 1fr 1fr' }}>\n                            <div><div className=\"muted\">Ultimo giro</div><div style={{ fontWeight: 900 }}>{formatLap(driver?.lastLapTime)}</div></div>\n                            <div><div className=\"muted\">Miglior giro</div><div style={{ fontWeight: 900 }}>{formatLap(driver?.bestLapTime)}</div></div>\n                            <div><div className=\"muted\">Penalità</div><div style={{ fontWeight: 900 }}>{driver?.penalty?.summary || '—'}</div></div>\n                        </div>\n\n                        {/* Forze G */}\n                        <div className=\"lb-row\" style={{ gridTemplateColumns: '1fr 1fr 1fr 1fr' }}>\n                            <div><div className=\"muted\">G-Lat</div><div style={{ fontWeight: 900 }}>{driver?.gforce?.lat?.toFixed?.(2) ?? '—'}</div></div>\n                            <div><div className=\"muted\">G-Long</div><div style={{ fontWeight: 900 }}>{driver?.gforce?.long?.toFixed?.(2) ?? '—'}</div></div>\n                            <div><div className=\"muted\">G-Vert</div><div style={{ fontWeight: 900 }}>{driver?.gforce?.vert?.toFixed?.(2) ?? '—'}</div></div>\n                            <div><div className=\"muted\">G-Total</div><div style={{ fontWeight: 900 }}>{driver?.gforce?.total?.toFixed?.(2) ?? '—'}</div></div>\n                        </div>\n\n                        {/* Lap times list */}\n                        <div className=\"pilot-form\" style={{ marginTop: 12 }}>\n                            <div className=\"section-title\" style={{ margin: 0, fontSize: '1.2rem' }}>Tempi di tutti i giri</div>\n                            <div className=\"lb-list\" style={{ maxHeight: '40vh' }}>\n                                {driver?.lapTimes?.length ? driver.lapTimes.map((t, i) => (\n                                    <div key={i} className=\"lb-row\" style={{ gridTemplateColumns: '80px 1fr 1fr' }}>\n                                        <div className=\"lb-pos\">{i + 1}</div>\n                                        <div className=\"lb-name\">Tempo</div>\n                                        <div className=\"lb-gap\" style={{ textAlign: 'right', color: '#e9ffe0', fontWeight: 900 }}>{formatLap(t)}</div>\n                                    </div>\n                                )) : (\n                                    <div className=\"muted\">Nessun giro completato ancora…</div>\n                                )}\n                            </div>\n                        </div>\n\n                    </div>\n                </div>\n            </div>\n\n        </div>\n    );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}