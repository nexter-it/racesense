{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/racesense/racesense-frontend/src/pages/RaceSetup.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport '../App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE = process.env.REACT_APP_API_BASE || `http://${window.location.hostname}:5000`;\nconst WS_URL = process.env.REACT_APP_WS_URL || `ws://${window.location.hostname}:5001`;\nexport default function RaceSetup({\n  onStartRace\n}) {\n  _s();\n  var _circuitData$stats, _circuitData$stats$le, _circuitData$sectors, _circuitData$params;\n  const [circuits, setCircuits] = useState([]);\n  const [pilots, setPilots] = useState([]);\n  const [selectedCircuit, setSelectedCircuit] = useState(null);\n  const [circuitData, setCircuitData] = useState(null);\n  const [totalLaps, setTotalLaps] = useState(10);\n  const [activeDevices, setActiveDevices] = useState({});\n  const [deviceAssignments, setDeviceAssignments] = useState({}); // mac -> pilotId\n  const wsRef = useRef(null);\n  const timeouts = useRef({});\n  useEffect(() => {\n    fetch(`${API_BASE}/api/circuits`).then(r => r.json()).then(setCircuits).catch(() => {});\n    fetch(`${API_BASE}/api/pilots`).then(r => r.json()).then(setPilots).catch(() => {});\n  }, []);\n  useEffect(() => {\n    if (!selectedCircuit) return;\n    fetch(`${API_BASE}/api/circuits/${selectedCircuit}`).then(r => r.json()).then(setCircuitData).catch(() => {});\n  }, [selectedCircuit]);\n\n  // WebSocket solo per vedere i device attivi mentre configuro\n  useEffect(() => {\n    const ws = new WebSocket(WS_URL);\n    wsRef.current = ws;\n    ws.onmessage = ev => {\n      try {\n        const d = JSON.parse(ev.data);\n        // manteniamo compatibilità: il server invia {type:'gps', ...}\n        const isGps = (d === null || d === void 0 ? void 0 : d.type) === 'gps' || (d === null || d === void 0 ? void 0 : d.mac) && (d === null || d === void 0 ? void 0 : d.lat) && (d === null || d === void 0 ? void 0 : d.lon);\n        if (!isGps) return;\n        const mac = d.mac;\n        setActiveDevices(prev => ({\n          ...prev,\n          [mac]: {\n            lastSeen: Date.now(),\n            lat: d.lat,\n            lon: d.lon,\n            speed: d.speedKmh || 0\n          }\n        }));\n        if (timeouts.current[mac]) clearTimeout(timeouts.current[mac]);\n        timeouts.current[mac] = setTimeout(() => {\n          setActiveDevices(prev => {\n            const c = {\n              ...prev\n            };\n            delete c[mac];\n            return c;\n          });\n        }, 5000);\n      } catch {}\n    };\n    return () => {\n      Object.values(timeouts.current).forEach(clearTimeout);\n      ws.close();\n    };\n  }, []);\n  const assign = (mac, pilotId) => setDeviceAssignments(p => ({\n    ...p,\n    [mac]: pilotId\n  }));\n  const handleStart = async () => {\n    if (!selectedCircuit) return alert('Seleziona un circuito');\n    const assigned = Object.keys(deviceAssignments).filter(m => deviceAssignments[m]);\n    if (assigned.length === 0) return alert('Assegna almeno un pilota a un device');\n    try {\n      const res = await fetch(`${API_BASE}/api/race/start`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          circuitId: selectedCircuit,\n          totalLaps,\n          assignments: deviceAssignments\n        })\n      });\n      const j = await res.json();\n      if (!res.ok) throw new Error(j.error || 'Errore avvio gara');\n      // passa una config minimale: RaceLive lavorerà in \"server mode\"\n      onStartRace({\n        serverMode: true\n      });\n    } catch (e) {\n      alert(e.message);\n    }\n  };\n  const activeMacs = Object.keys(activeDevices);\n  const assignedCount = Object.values(deviceAssignments).filter(Boolean).length;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"race-setup-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"setup-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"setup-logo\",\n        children: \"RACESENSE\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"setup-title\",\n        children: \"CONFIGURAZIONE GARA\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"setup-content\",\n      children: [/*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"setup-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"section-title\",\n          children: \"CIRCUITO\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"circuits-grid\",\n          children: circuits.map(c => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `circuit-card ${selectedCircuit === c.id ? 'selected' : ''}`,\n            onClick: () => setSelectedCircuit(c.id),\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"circuit-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"circuit-name\",\n                children: c.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 96,\n                columnNumber: 19\n              }, this), selectedCircuit === c.id && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"check\",\n                children: \"\\u2713\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 97,\n                columnNumber: 48\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 95,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"circuit-stats\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"stat\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"stat-icon\",\n                  children: \"LUNG\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 100,\n                  columnNumber: 41\n                }, this), (c.lengthMeters || 0).toFixed(0), \"m\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 100,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"stat\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"stat-icon\",\n                  children: \"PTS\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 101,\n                  columnNumber: 41\n                }, this), c.points || 0]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 101,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 99,\n              columnNumber: 17\n            }, this)]\n          }, c.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 11\n        }, this), circuitData && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"circuit-details\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"detail\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Lunghezza\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 39\n            }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: [(_circuitData$stats = circuitData.stats) === null || _circuitData$stats === void 0 ? void 0 : (_circuitData$stats$le = _circuitData$stats.lengthMeters) === null || _circuitData$stats$le === void 0 ? void 0 : _circuitData$stats$le.toFixed(0), \"m\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 61\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"detail\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Settori\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 109,\n              columnNumber: 39\n            }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: ((_circuitData$sectors = circuitData.sectors) === null || _circuitData$sectors === void 0 ? void 0 : _circuitData$sectors.length) || 0\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 109,\n              columnNumber: 59\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"detail\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Larghezza\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 110,\n              columnNumber: 39\n            }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: [((_circuitData$params = circuitData.params) === null || _circuitData$params === void 0 ? void 0 : _circuitData$params.widthMeters) || 6, \"m\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 110,\n              columnNumber: 61\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"setup-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"section-title\",\n          children: [\"DEVICE ATTIVI (\", activeMacs.length, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 11\n        }, this), activeMacs.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"no-devices\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"no-devices-icon\",\n            children: \"GPS\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Nessun device GPS attivo\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n            children: \"Avvia il simulatore o connetti i device\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"devices-list\",\n          children: activeMacs.map(mac => {\n            const dev = activeDevices[mac];\n            const assignedPilot = pilots.find(p => p.id === deviceAssignments[mac]);\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `device-card ${assignedPilot ? 'assigned' : ''}`,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"device-info\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"device-header\",\n                  children: /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"device-mac\",\n                    children: mac\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 133,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 132,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"device-data\",\n                  children: /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"device-stat\",\n                    children: [\"SPEED: \", dev.speed.toFixed(1), \" km/h\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 136,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 135,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 131,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"device-assignment\",\n                children: [/*#__PURE__*/_jsxDEV(\"select\", {\n                  className: \"pilot-select\",\n                  value: deviceAssignments[mac] || '',\n                  onChange: e => assign(mac, e.target.value),\n                  children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"\",\n                    children: \"-- Assegna Pilota --\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 141,\n                    columnNumber: 25\n                  }, this), pilots.map(p => /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: p.id,\n                    children: [p.name, \" \", p.surname, \" (\", p.team, \")\"]\n                  }, p.id, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 142,\n                    columnNumber: 42\n                  }, this))]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 140,\n                  columnNumber: 23\n                }, this), assignedPilot && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"assigned-pilot\",\n                  children: [assignedPilot.photoDriverUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: `${API_BASE}${assignedPilot.photoDriverUrl}`,\n                    alt: \"\",\n                    className: \"pilot-photo\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 147,\n                    columnNumber: 31\n                  }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"pilot-color\",\n                    style: {\n                      background: assignedPilot.color || '#fff'\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 148,\n                    columnNumber: 31\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"pilot-details\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"pilot-name\",\n                      children: [assignedPilot.name, \" \", assignedPilot.surname]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 150,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"pilot-team\",\n                      children: assignedPilot.team\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 151,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 149,\n                    columnNumber: 27\n                  }, this), assignedPilot.photoTeamUrl && /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: `${API_BASE}${assignedPilot.photoTeamUrl}`,\n                    alt: \"\",\n                    className: \"team-logo\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 153,\n                    columnNumber: 58\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 145,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 139,\n                columnNumber: 21\n              }, this)]\n            }, mac, true, {\n              fileName: _jsxFileName,\n              lineNumber: 130,\n              columnNumber: 19\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"setup-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"section-title\",\n          children: \"NUMERO GIRI\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"laps-selector\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"lap-btn\",\n            onClick: () => setTotalLaps(Math.max(1, totalLaps - 1)),\n            children: \"\\u2212\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"laps-display\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"laps-number\",\n              children: totalLaps\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"laps-label\",\n              children: \"GIRI\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 171,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"lap-btn\",\n            onClick: () => setTotalLaps(totalLaps + 1),\n            children: \"+\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"start-btn\",\n        disabled: !selectedCircuit || assignedCount === 0,\n        onClick: handleStart,\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"start-icon\",\n          children: \"START\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"start-text\",\n          children: \"AVVIA GARA (Server)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"start-info\",\n          children: selectedCircuit && assignedCount > 0 ? `${assignedCount} ${assignedCount === 1 ? 'pilota' : 'piloti'} × ${totalLaps} giri` : 'Configura gara per iniziare'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n}\n_s(RaceSetup, \"XMiNe2tuhjZyKE3FbmY98dkzma0=\");\n_c = RaceSetup;\nvar _c;\n$RefreshReg$(_c, \"RaceSetup\");","map":{"version":3,"names":["React","useState","useEffect","useRef","jsxDEV","_jsxDEV","API_BASE","process","env","REACT_APP_API_BASE","window","location","hostname","WS_URL","REACT_APP_WS_URL","RaceSetup","onStartRace","_s","_circuitData$stats","_circuitData$stats$le","_circuitData$sectors","_circuitData$params","circuits","setCircuits","pilots","setPilots","selectedCircuit","setSelectedCircuit","circuitData","setCircuitData","totalLaps","setTotalLaps","activeDevices","setActiveDevices","deviceAssignments","setDeviceAssignments","wsRef","timeouts","fetch","then","r","json","catch","ws","WebSocket","current","onmessage","ev","d","JSON","parse","data","isGps","type","mac","lat","lon","prev","lastSeen","Date","now","speed","speedKmh","clearTimeout","setTimeout","c","Object","values","forEach","close","assign","pilotId","p","handleStart","alert","assigned","keys","filter","m","length","res","method","headers","body","stringify","circuitId","assignments","j","ok","Error","error","serverMode","e","message","activeMacs","assignedCount","Boolean","className","children","fileName","_jsxFileName","lineNumber","columnNumber","map","id","onClick","name","lengthMeters","toFixed","points","stats","sectors","params","widthMeters","dev","assignedPilot","find","value","onChange","target","surname","team","photoDriverUrl","src","alt","style","background","color","photoTeamUrl","Math","max","disabled","_c","$RefreshReg$"],"sources":["/home/ubuntu/racesense/racesense-frontend/src/pages/RaceSetup.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport '../App.css';\n\nconst API_BASE = process.env.REACT_APP_API_BASE || `http://${window.location.hostname}:5000`;\nconst WS_URL = process.env.REACT_APP_WS_URL || `ws://${window.location.hostname}:5001`;\n\nexport default function RaceSetup({ onStartRace }) {\n  const [circuits, setCircuits] = useState([]);\n  const [pilots, setPilots] = useState([]);\n  const [selectedCircuit, setSelectedCircuit] = useState(null);\n  const [circuitData, setCircuitData] = useState(null);\n  const [totalLaps, setTotalLaps] = useState(10);\n  const [activeDevices, setActiveDevices] = useState({});\n  const [deviceAssignments, setDeviceAssignments] = useState({}); // mac -> pilotId\n  const wsRef = useRef(null);\n  const timeouts = useRef({});\n\n  useEffect(() => {\n    fetch(`${API_BASE}/api/circuits`).then(r => r.json()).then(setCircuits).catch(() => { });\n    fetch(`${API_BASE}/api/pilots`).then(r => r.json()).then(setPilots).catch(() => { });\n  }, []);\n  useEffect(() => {\n    if (!selectedCircuit) return;\n    fetch(`${API_BASE}/api/circuits/${selectedCircuit}`).then(r => r.json()).then(setCircuitData).catch(() => { });\n  }, [selectedCircuit]);\n\n  // WebSocket solo per vedere i device attivi mentre configuro\n  useEffect(() => {\n    const ws = new WebSocket(WS_URL);\n    wsRef.current = ws;\n    ws.onmessage = (ev) => {\n      try {\n        const d = JSON.parse(ev.data);\n        // manteniamo compatibilità: il server invia {type:'gps', ...}\n        const isGps = d?.type === 'gps' || (d?.mac && d?.lat && d?.lon);\n        if (!isGps) return;\n        const mac = d.mac;\n        setActiveDevices(prev => ({ ...prev, [mac]: { lastSeen: Date.now(), lat: d.lat, lon: d.lon, speed: d.speedKmh || 0 } }));\n        if (timeouts.current[mac]) clearTimeout(timeouts.current[mac]);\n        timeouts.current[mac] = setTimeout(() => {\n          setActiveDevices(prev => { const c = { ...prev }; delete c[mac]; return c; });\n        }, 5000);\n      } catch { }\n    };\n    return () => { Object.values(timeouts.current).forEach(clearTimeout); ws.close(); };\n  }, []);\n\n  const assign = (mac, pilotId) => setDeviceAssignments(p => ({ ...p, [mac]: pilotId }));\n\n  const handleStart = async () => {\n    if (!selectedCircuit) return alert('Seleziona un circuito');\n    const assigned = Object.keys(deviceAssignments).filter(m => deviceAssignments[m]);\n    if (assigned.length === 0) return alert('Assegna almeno un pilota a un device');\n\n    try {\n      const res = await fetch(`${API_BASE}/api/race/start`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          circuitId: selectedCircuit,\n          totalLaps,\n          assignments: deviceAssignments\n        })\n      });\n      const j = await res.json();\n      if (!res.ok) throw new Error(j.error || 'Errore avvio gara');\n      // passa una config minimale: RaceLive lavorerà in \"server mode\"\n      onStartRace({ serverMode: true });\n    } catch (e) {\n      alert(e.message);\n    }\n  };\n\n  const activeMacs = Object.keys(activeDevices);\n  const assignedCount = Object.values(deviceAssignments).filter(Boolean).length;\n\n  return (\n    <div className=\"race-setup-page\">\n      <header className=\"setup-header\">\n        <div className=\"setup-logo\">RACESENSE</div>\n        <div className=\"setup-title\">CONFIGURAZIONE GARA</div>\n      </header>\n\n      <div className=\"setup-content\">\n        {/* Circuito */}\n        <section className=\"setup-section\">\n          <h2 className=\"section-title\">CIRCUITO</h2>\n          <div className=\"circuits-grid\">\n            {circuits.map(c => (\n              <div\n                key={c.id}\n                className={`circuit-card ${selectedCircuit === c.id ? 'selected' : ''}`}\n                onClick={() => setSelectedCircuit(c.id)}\n              >\n                <div className=\"circuit-header\">\n                  <span className=\"circuit-name\">{c.name}</span>\n                  {selectedCircuit === c.id && <span className=\"check\">✓</span>}\n                </div>\n                <div className=\"circuit-stats\">\n                  <div className=\"stat\"><span className=\"stat-icon\">LUNG</span>{(c.lengthMeters || 0).toFixed(0)}m</div>\n                  <div className=\"stat\"><span className=\"stat-icon\">PTS</span>{c.points || 0}</div>\n                </div>\n              </div>\n            ))}\n          </div>\n          {circuitData && (\n            <div className=\"circuit-details\">\n              <div className=\"detail\"><span>Lunghezza</span><strong>{circuitData.stats?.lengthMeters?.toFixed(0)}m</strong></div>\n              <div className=\"detail\"><span>Settori</span><strong>{circuitData.sectors?.length || 0}</strong></div>\n              <div className=\"detail\"><span>Larghezza</span><strong>{circuitData.params?.widthMeters || 6}m</strong></div>\n            </div>\n          )}\n        </section>\n\n        {/* Device + assegnazioni */}\n        <section className=\"setup-section\">\n          <h2 className=\"section-title\">DEVICE ATTIVI ({activeMacs.length})</h2>\n          {activeMacs.length === 0 ? (\n            <div className=\"no-devices\">\n              <div className=\"no-devices-icon\">GPS</div>\n              <p>Nessun device GPS attivo</p>\n              <small>Avvia il simulatore o connetti i device</small>\n            </div>\n          ) : (\n            <div className=\"devices-list\">\n              {activeMacs.map(mac => {\n                const dev = activeDevices[mac];\n                const assignedPilot = pilots.find(p => p.id === deviceAssignments[mac]);\n                return (\n                  <div key={mac} className={`device-card ${assignedPilot ? 'assigned' : ''}`}>\n                    <div className=\"device-info\">\n                      <div className=\"device-header\">\n                        <span className=\"device-mac\">{mac}</span>\n                      </div>\n                      <div className=\"device-data\">\n                        <span className=\"device-stat\">SPEED: {dev.speed.toFixed(1)} km/h</span>\n                      </div>\n                    </div>\n                    <div className=\"device-assignment\">\n                      <select className=\"pilot-select\" value={deviceAssignments[mac] || ''} onChange={e => assign(mac, e.target.value)}>\n                        <option value=\"\">-- Assegna Pilota --</option>\n                        {pilots.map(p => <option key={p.id} value={p.id}>{p.name} {p.surname} ({p.team})</option>)}\n                      </select>\n                      {assignedPilot && (\n                        <div className=\"assigned-pilot\">\n                          {assignedPilot.photoDriverUrl\n                            ? <img src={`${API_BASE}${assignedPilot.photoDriverUrl}`} alt=\"\" className=\"pilot-photo\" />\n                            : <div className=\"pilot-color\" style={{ background: assignedPilot.color || '#fff' }} />}\n                          <div className=\"pilot-details\">\n                            <span className=\"pilot-name\">{assignedPilot.name} {assignedPilot.surname}</span>\n                            <span className=\"pilot-team\">{assignedPilot.team}</span>\n                          </div>\n                          {assignedPilot.photoTeamUrl && <img src={`${API_BASE}${assignedPilot.photoTeamUrl}`} alt=\"\" className=\"team-logo\" />}\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          )}\n        </section>\n\n        {/* Giri */}\n        <section className=\"setup-section\">\n          <h2 className=\"section-title\">NUMERO GIRI</h2>\n          <div className=\"laps-selector\">\n            <button className=\"lap-btn\" onClick={() => setTotalLaps(Math.max(1, totalLaps - 1))}>−</button>\n            <div className=\"laps-display\">\n              <div className=\"laps-number\">{totalLaps}</div>\n              <div className=\"laps-label\">GIRI</div>\n            </div>\n            <button className=\"lap-btn\" onClick={() => setTotalLaps(totalLaps + 1)}>+</button>\n          </div>\n        </section>\n\n        {/* Start */}\n        <button className=\"start-btn\" disabled={!selectedCircuit || assignedCount === 0} onClick={handleStart}>\n          <span className=\"start-icon\">START</span>\n          <span className=\"start-text\">AVVIA GARA (Server)</span>\n          <span className=\"start-info\">\n            {selectedCircuit && assignedCount > 0 ? `${assignedCount} ${assignedCount === 1 ? 'pilota' : 'piloti'} × ${totalLaps} giri` : 'Configura gara per iniziare'}\n          </span>\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAC1D,OAAO,YAAY;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEpB,MAAMC,QAAQ,GAAGC,OAAO,CAACC,GAAG,CAACC,kBAAkB,IAAI,UAAUC,MAAM,CAACC,QAAQ,CAACC,QAAQ,OAAO;AAC5F,MAAMC,MAAM,GAAGN,OAAO,CAACC,GAAG,CAACM,gBAAgB,IAAI,QAAQJ,MAAM,CAACC,QAAQ,CAACC,QAAQ,OAAO;AAEtF,eAAe,SAASG,SAASA,CAAC;EAAEC;AAAY,CAAC,EAAE;EAAAC,EAAA;EAAA,IAAAC,kBAAA,EAAAC,qBAAA,EAAAC,oBAAA,EAAAC,mBAAA;EACjD,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGtB,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACuB,MAAM,EAAEC,SAAS,CAAC,GAAGxB,QAAQ,CAAC,EAAE,CAAC;EACxC,MAAM,CAACyB,eAAe,EAAEC,kBAAkB,CAAC,GAAG1B,QAAQ,CAAC,IAAI,CAAC;EAC5D,MAAM,CAAC2B,WAAW,EAAEC,cAAc,CAAC,GAAG5B,QAAQ,CAAC,IAAI,CAAC;EACpD,MAAM,CAAC6B,SAAS,EAAEC,YAAY,CAAC,GAAG9B,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAAC+B,aAAa,EAAEC,gBAAgB,CAAC,GAAGhC,QAAQ,CAAC,CAAC,CAAC,CAAC;EACtD,MAAM,CAACiC,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGlC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAChE,MAAMmC,KAAK,GAAGjC,MAAM,CAAC,IAAI,CAAC;EAC1B,MAAMkC,QAAQ,GAAGlC,MAAM,CAAC,CAAC,CAAC,CAAC;EAE3BD,SAAS,CAAC,MAAM;IACdoC,KAAK,CAAC,GAAGhC,QAAQ,eAAe,CAAC,CAACiC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC,CAACF,IAAI,CAAChB,WAAW,CAAC,CAACmB,KAAK,CAAC,MAAM,CAAE,CAAC,CAAC;IACxFJ,KAAK,CAAC,GAAGhC,QAAQ,aAAa,CAAC,CAACiC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC,CAACF,IAAI,CAACd,SAAS,CAAC,CAACiB,KAAK,CAAC,MAAM,CAAE,CAAC,CAAC;EACtF,CAAC,EAAE,EAAE,CAAC;EACNxC,SAAS,CAAC,MAAM;IACd,IAAI,CAACwB,eAAe,EAAE;IACtBY,KAAK,CAAC,GAAGhC,QAAQ,iBAAiBoB,eAAe,EAAE,CAAC,CAACa,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,CAAC,CAAC,CAAC,CAACF,IAAI,CAACV,cAAc,CAAC,CAACa,KAAK,CAAC,MAAM,CAAE,CAAC,CAAC;EAChH,CAAC,EAAE,CAAChB,eAAe,CAAC,CAAC;;EAErB;EACAxB,SAAS,CAAC,MAAM;IACd,MAAMyC,EAAE,GAAG,IAAIC,SAAS,CAAC/B,MAAM,CAAC;IAChCuB,KAAK,CAACS,OAAO,GAAGF,EAAE;IAClBA,EAAE,CAACG,SAAS,GAAIC,EAAE,IAAK;MACrB,IAAI;QACF,MAAMC,CAAC,GAAGC,IAAI,CAACC,KAAK,CAACH,EAAE,CAACI,IAAI,CAAC;QAC7B;QACA,MAAMC,KAAK,GAAG,CAAAJ,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEK,IAAI,MAAK,KAAK,IAAK,CAAAL,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEM,GAAG,MAAIN,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEO,GAAG,MAAIP,CAAC,aAADA,CAAC,uBAADA,CAAC,CAAEQ,GAAG,CAAC;QAC/D,IAAI,CAACJ,KAAK,EAAE;QACZ,MAAME,GAAG,GAAGN,CAAC,CAACM,GAAG;QACjBrB,gBAAgB,CAACwB,IAAI,KAAK;UAAE,GAAGA,IAAI;UAAE,CAACH,GAAG,GAAG;YAAEI,QAAQ,EAAEC,IAAI,CAACC,GAAG,CAAC,CAAC;YAAEL,GAAG,EAAEP,CAAC,CAACO,GAAG;YAAEC,GAAG,EAAER,CAAC,CAACQ,GAAG;YAAEK,KAAK,EAAEb,CAAC,CAACc,QAAQ,IAAI;UAAE;QAAE,CAAC,CAAC,CAAC;QACxH,IAAIzB,QAAQ,CAACQ,OAAO,CAACS,GAAG,CAAC,EAAES,YAAY,CAAC1B,QAAQ,CAACQ,OAAO,CAACS,GAAG,CAAC,CAAC;QAC9DjB,QAAQ,CAACQ,OAAO,CAACS,GAAG,CAAC,GAAGU,UAAU,CAAC,MAAM;UACvC/B,gBAAgB,CAACwB,IAAI,IAAI;YAAE,MAAMQ,CAAC,GAAG;cAAE,GAAGR;YAAK,CAAC;YAAE,OAAOQ,CAAC,CAACX,GAAG,CAAC;YAAE,OAAOW,CAAC;UAAE,CAAC,CAAC;QAC/E,CAAC,EAAE,IAAI,CAAC;MACV,CAAC,CAAC,MAAM,CAAE;IACZ,CAAC;IACD,OAAO,MAAM;MAAEC,MAAM,CAACC,MAAM,CAAC9B,QAAQ,CAACQ,OAAO,CAAC,CAACuB,OAAO,CAACL,YAAY,CAAC;MAAEpB,EAAE,CAAC0B,KAAK,CAAC,CAAC;IAAE,CAAC;EACrF,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMC,MAAM,GAAGA,CAAChB,GAAG,EAAEiB,OAAO,KAAKpC,oBAAoB,CAACqC,CAAC,KAAK;IAAE,GAAGA,CAAC;IAAE,CAAClB,GAAG,GAAGiB;EAAQ,CAAC,CAAC,CAAC;EAEtF,MAAME,WAAW,GAAG,MAAAA,CAAA,KAAY;IAC9B,IAAI,CAAC/C,eAAe,EAAE,OAAOgD,KAAK,CAAC,uBAAuB,CAAC;IAC3D,MAAMC,QAAQ,GAAGT,MAAM,CAACU,IAAI,CAAC1C,iBAAiB,CAAC,CAAC2C,MAAM,CAACC,CAAC,IAAI5C,iBAAiB,CAAC4C,CAAC,CAAC,CAAC;IACjF,IAAIH,QAAQ,CAACI,MAAM,KAAK,CAAC,EAAE,OAAOL,KAAK,CAAC,sCAAsC,CAAC;IAE/E,IAAI;MACF,MAAMM,GAAG,GAAG,MAAM1C,KAAK,CAAC,GAAGhC,QAAQ,iBAAiB,EAAE;QACpD2E,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UAAE,cAAc,EAAE;QAAmB,CAAC;QAC/CC,IAAI,EAAElC,IAAI,CAACmC,SAAS,CAAC;UACnBC,SAAS,EAAE3D,eAAe;UAC1BI,SAAS;UACTwD,WAAW,EAAEpD;QACf,CAAC;MACH,CAAC,CAAC;MACF,MAAMqD,CAAC,GAAG,MAAMP,GAAG,CAACvC,IAAI,CAAC,CAAC;MAC1B,IAAI,CAACuC,GAAG,CAACQ,EAAE,EAAE,MAAM,IAAIC,KAAK,CAACF,CAAC,CAACG,KAAK,IAAI,mBAAmB,CAAC;MAC5D;MACA1E,WAAW,CAAC;QAAE2E,UAAU,EAAE;MAAK,CAAC,CAAC;IACnC,CAAC,CAAC,OAAOC,CAAC,EAAE;MACVlB,KAAK,CAACkB,CAAC,CAACC,OAAO,CAAC;IAClB;EACF,CAAC;EAED,MAAMC,UAAU,GAAG5B,MAAM,CAACU,IAAI,CAAC5C,aAAa,CAAC;EAC7C,MAAM+D,aAAa,GAAG7B,MAAM,CAACC,MAAM,CAACjC,iBAAiB,CAAC,CAAC2C,MAAM,CAACmB,OAAO,CAAC,CAACjB,MAAM;EAE7E,oBACE1E,OAAA;IAAK4F,SAAS,EAAC,iBAAiB;IAAAC,QAAA,gBAC9B7F,OAAA;MAAQ4F,SAAS,EAAC,cAAc;MAAAC,QAAA,gBAC9B7F,OAAA;QAAK4F,SAAS,EAAC,YAAY;QAAAC,QAAA,EAAC;MAAS;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eAC3CjG,OAAA;QAAK4F,SAAS,EAAC,aAAa;QAAAC,QAAA,EAAC;MAAmB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAChD,CAAC,eAETjG,OAAA;MAAK4F,SAAS,EAAC,eAAe;MAAAC,QAAA,gBAE5B7F,OAAA;QAAS4F,SAAS,EAAC,eAAe;QAAAC,QAAA,gBAChC7F,OAAA;UAAI4F,SAAS,EAAC,eAAe;UAAAC,QAAA,EAAC;QAAQ;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAC3CjG,OAAA;UAAK4F,SAAS,EAAC,eAAe;UAAAC,QAAA,EAC3B5E,QAAQ,CAACiF,GAAG,CAACtC,CAAC,iBACb5D,OAAA;YAEE4F,SAAS,EAAE,gBAAgBvE,eAAe,KAAKuC,CAAC,CAACuC,EAAE,GAAG,UAAU,GAAG,EAAE,EAAG;YACxEC,OAAO,EAAEA,CAAA,KAAM9E,kBAAkB,CAACsC,CAAC,CAACuC,EAAE,CAAE;YAAAN,QAAA,gBAExC7F,OAAA;cAAK4F,SAAS,EAAC,gBAAgB;cAAAC,QAAA,gBAC7B7F,OAAA;gBAAM4F,SAAS,EAAC,cAAc;gBAAAC,QAAA,EAAEjC,CAAC,CAACyC;cAAI;gBAAAP,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC,EAC7C5E,eAAe,KAAKuC,CAAC,CAACuC,EAAE,iBAAInG,OAAA;gBAAM4F,SAAS,EAAC,OAAO;gBAAAC,QAAA,EAAC;cAAC;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC1D,CAAC,eACNjG,OAAA;cAAK4F,SAAS,EAAC,eAAe;cAAAC,QAAA,gBAC5B7F,OAAA;gBAAK4F,SAAS,EAAC,MAAM;gBAAAC,QAAA,gBAAC7F,OAAA;kBAAM4F,SAAS,EAAC,WAAW;kBAAAC,QAAA,EAAC;gBAAI;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,EAAC,CAACrC,CAAC,CAAC0C,YAAY,IAAI,CAAC,EAAEC,OAAO,CAAC,CAAC,CAAC,EAAC,GAAC;cAAA;gBAAAT,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CAAC,eACtGjG,OAAA;gBAAK4F,SAAS,EAAC,MAAM;gBAAAC,QAAA,gBAAC7F,OAAA;kBAAM4F,SAAS,EAAC,WAAW;kBAAAC,QAAA,EAAC;gBAAG;kBAAAC,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAM,CAAC,EAACrC,CAAC,CAAC4C,MAAM,IAAI,CAAC;cAAA;gBAAAV,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC9E,CAAC;UAAA,GAXDrC,CAAC,CAACuC,EAAE;YAAAL,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAYN,CACN;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC,EACL1E,WAAW,iBACVvB,OAAA;UAAK4F,SAAS,EAAC,iBAAiB;UAAAC,QAAA,gBAC9B7F,OAAA;YAAK4F,SAAS,EAAC,QAAQ;YAAAC,QAAA,gBAAC7F,OAAA;cAAA6F,QAAA,EAAM;YAAS;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAAAjG,OAAA;cAAA6F,QAAA,IAAAhF,kBAAA,GAASU,WAAW,CAACkF,KAAK,cAAA5F,kBAAA,wBAAAC,qBAAA,GAAjBD,kBAAA,CAAmByF,YAAY,cAAAxF,qBAAA,uBAA/BA,qBAAA,CAAiCyF,OAAO,CAAC,CAAC,CAAC,EAAC,GAAC;YAAA;cAAAT,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eACnHjG,OAAA;YAAK4F,SAAS,EAAC,QAAQ;YAAAC,QAAA,gBAAC7F,OAAA;cAAA6F,QAAA,EAAM;YAAO;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAAAjG,OAAA;cAAA6F,QAAA,EAAS,EAAA9E,oBAAA,GAAAQ,WAAW,CAACmF,OAAO,cAAA3F,oBAAA,uBAAnBA,oBAAA,CAAqB2D,MAAM,KAAI;YAAC;cAAAoB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAS,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eACrGjG,OAAA;YAAK4F,SAAS,EAAC,QAAQ;YAAAC,QAAA,gBAAC7F,OAAA;cAAA6F,QAAA,EAAM;YAAS;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAAAjG,OAAA;cAAA6F,QAAA,GAAS,EAAA7E,mBAAA,GAAAO,WAAW,CAACoF,MAAM,cAAA3F,mBAAA,uBAAlBA,mBAAA,CAAoB4F,WAAW,KAAI,CAAC,EAAC,GAAC;YAAA;cAAAd,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACzG,CACN;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACM,CAAC,eAGVjG,OAAA;QAAS4F,SAAS,EAAC,eAAe;QAAAC,QAAA,gBAChC7F,OAAA;UAAI4F,SAAS,EAAC,eAAe;UAAAC,QAAA,GAAC,iBAAe,EAACJ,UAAU,CAACf,MAAM,EAAC,GAAC;QAAA;UAAAoB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,EACrER,UAAU,CAACf,MAAM,KAAK,CAAC,gBACtB1E,OAAA;UAAK4F,SAAS,EAAC,YAAY;UAAAC,QAAA,gBACzB7F,OAAA;YAAK4F,SAAS,EAAC,iBAAiB;YAAAC,QAAA,EAAC;UAAG;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,eAC1CjG,OAAA;YAAA6F,QAAA,EAAG;UAAwB;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC,eAC/BjG,OAAA;YAAA6F,QAAA,EAAO;UAAuC;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACnD,CAAC,gBAENjG,OAAA;UAAK4F,SAAS,EAAC,cAAc;UAAAC,QAAA,EAC1BJ,UAAU,CAACS,GAAG,CAACjD,GAAG,IAAI;YACrB,MAAM4D,GAAG,GAAGlF,aAAa,CAACsB,GAAG,CAAC;YAC9B,MAAM6D,aAAa,GAAG3F,MAAM,CAAC4F,IAAI,CAAC5C,CAAC,IAAIA,CAAC,CAACgC,EAAE,KAAKtE,iBAAiB,CAACoB,GAAG,CAAC,CAAC;YACvE,oBACEjD,OAAA;cAAe4F,SAAS,EAAE,eAAekB,aAAa,GAAG,UAAU,GAAG,EAAE,EAAG;cAAAjB,QAAA,gBACzE7F,OAAA;gBAAK4F,SAAS,EAAC,aAAa;gBAAAC,QAAA,gBAC1B7F,OAAA;kBAAK4F,SAAS,EAAC,eAAe;kBAAAC,QAAA,eAC5B7F,OAAA;oBAAM4F,SAAS,EAAC,YAAY;oBAAAC,QAAA,EAAE5C;kBAAG;oBAAA6C,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAO;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACtC,CAAC,eACNjG,OAAA;kBAAK4F,SAAS,EAAC,aAAa;kBAAAC,QAAA,eAC1B7F,OAAA;oBAAM4F,SAAS,EAAC,aAAa;oBAAAC,QAAA,GAAC,SAAO,EAACgB,GAAG,CAACrD,KAAK,CAAC+C,OAAO,CAAC,CAAC,CAAC,EAAC,OAAK;kBAAA;oBAAAT,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAM;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACpE,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC,eACNjG,OAAA;gBAAK4F,SAAS,EAAC,mBAAmB;gBAAAC,QAAA,gBAChC7F,OAAA;kBAAQ4F,SAAS,EAAC,cAAc;kBAACoB,KAAK,EAAEnF,iBAAiB,CAACoB,GAAG,CAAC,IAAI,EAAG;kBAACgE,QAAQ,EAAE1B,CAAC,IAAItB,MAAM,CAAChB,GAAG,EAAEsC,CAAC,CAAC2B,MAAM,CAACF,KAAK,CAAE;kBAAAnB,QAAA,gBAC/G7F,OAAA;oBAAQgH,KAAK,EAAC,EAAE;oBAAAnB,QAAA,EAAC;kBAAoB;oBAAAC,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAQ,CAAC,EAC7C9E,MAAM,CAAC+E,GAAG,CAAC/B,CAAC,iBAAInE,OAAA;oBAAmBgH,KAAK,EAAE7C,CAAC,CAACgC,EAAG;oBAAAN,QAAA,GAAE1B,CAAC,CAACkC,IAAI,EAAC,GAAC,EAAClC,CAAC,CAACgD,OAAO,EAAC,IAAE,EAAChD,CAAC,CAACiD,IAAI,EAAC,GAAC;kBAAA,GAAlDjD,CAAC,CAACgC,EAAE;oBAAAL,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAsD,CAAC,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACpF,CAAC,EACRa,aAAa,iBACZ9G,OAAA;kBAAK4F,SAAS,EAAC,gBAAgB;kBAAAC,QAAA,GAC5BiB,aAAa,CAACO,cAAc,gBACzBrH,OAAA;oBAAKsH,GAAG,EAAE,GAAGrH,QAAQ,GAAG6G,aAAa,CAACO,cAAc,EAAG;oBAACE,GAAG,EAAC,EAAE;oBAAC3B,SAAS,EAAC;kBAAa;oBAAAE,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE,CAAC,gBACzFjG,OAAA;oBAAK4F,SAAS,EAAC,aAAa;oBAAC4B,KAAK,EAAE;sBAAEC,UAAU,EAAEX,aAAa,CAACY,KAAK,IAAI;oBAAO;kBAAE;oBAAA5B,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE,CAAC,eACzFjG,OAAA;oBAAK4F,SAAS,EAAC,eAAe;oBAAAC,QAAA,gBAC5B7F,OAAA;sBAAM4F,SAAS,EAAC,YAAY;sBAAAC,QAAA,GAAEiB,aAAa,CAACT,IAAI,EAAC,GAAC,EAACS,aAAa,CAACK,OAAO;oBAAA;sBAAArB,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAO,CAAC,eAChFjG,OAAA;sBAAM4F,SAAS,EAAC,YAAY;sBAAAC,QAAA,EAAEiB,aAAa,CAACM;oBAAI;sBAAAtB,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAO,CAAC;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACrD,CAAC,EACLa,aAAa,CAACa,YAAY,iBAAI3H,OAAA;oBAAKsH,GAAG,EAAE,GAAGrH,QAAQ,GAAG6G,aAAa,CAACa,YAAY,EAAG;oBAACJ,GAAG,EAAC,EAAE;oBAAC3B,SAAS,EAAC;kBAAW;oBAAAE,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACjH,CACN;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACE,CAAC;YAAA,GA1BEhD,GAAG;cAAA6C,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OA2BR,CAAC;UAEV,CAAC;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CACN;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACM,CAAC,eAGVjG,OAAA;QAAS4F,SAAS,EAAC,eAAe;QAAAC,QAAA,gBAChC7F,OAAA;UAAI4F,SAAS,EAAC,eAAe;UAAAC,QAAA,EAAC;QAAW;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAC9CjG,OAAA;UAAK4F,SAAS,EAAC,eAAe;UAAAC,QAAA,gBAC5B7F,OAAA;YAAQ4F,SAAS,EAAC,SAAS;YAACQ,OAAO,EAAEA,CAAA,KAAM1E,YAAY,CAACkG,IAAI,CAACC,GAAG,CAAC,CAAC,EAAEpG,SAAS,GAAG,CAAC,CAAC,CAAE;YAAAoE,QAAA,EAAC;UAAC;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eAC/FjG,OAAA;YAAK4F,SAAS,EAAC,cAAc;YAAAC,QAAA,gBAC3B7F,OAAA;cAAK4F,SAAS,EAAC,aAAa;cAAAC,QAAA,EAAEpE;YAAS;cAAAqE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAC9CjG,OAAA;cAAK4F,SAAS,EAAC,YAAY;cAAAC,QAAA,EAAC;YAAI;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACnC,CAAC,eACNjG,OAAA;YAAQ4F,SAAS,EAAC,SAAS;YAACQ,OAAO,EAAEA,CAAA,KAAM1E,YAAY,CAACD,SAAS,GAAG,CAAC,CAAE;YAAAoE,QAAA,EAAC;UAAC;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC/E,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC,eAGVjG,OAAA;QAAQ4F,SAAS,EAAC,WAAW;QAACkC,QAAQ,EAAE,CAACzG,eAAe,IAAIqE,aAAa,KAAK,CAAE;QAACU,OAAO,EAAEhC,WAAY;QAAAyB,QAAA,gBACpG7F,OAAA;UAAM4F,SAAS,EAAC,YAAY;UAAAC,QAAA,EAAC;QAAK;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eACzCjG,OAAA;UAAM4F,SAAS,EAAC,YAAY;UAAAC,QAAA,EAAC;QAAmB;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eACvDjG,OAAA;UAAM4F,SAAS,EAAC,YAAY;UAAAC,QAAA,EACzBxE,eAAe,IAAIqE,aAAa,GAAG,CAAC,GAAG,GAAGA,aAAa,IAAIA,aAAa,KAAK,CAAC,GAAG,QAAQ,GAAG,QAAQ,MAAMjE,SAAS,OAAO,GAAG;QAA6B;UAAAqE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACvJ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAACrF,EAAA,CArLuBF,SAAS;AAAAqH,EAAA,GAATrH,SAAS;AAAA,IAAAqH,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}