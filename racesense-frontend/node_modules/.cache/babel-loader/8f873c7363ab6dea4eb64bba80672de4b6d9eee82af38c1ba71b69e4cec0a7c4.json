{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/racesense/racesense-frontend/src/pages/Circuits.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$(),\n  _s4 = $RefreshSig$();\nimport React from 'react';\n\n/* ============ ICONS (inline SVG, no deps) ============ */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Svg = ({\n  children,\n  size = 16,\n  className = '',\n  stroke = 'currentColor',\n  strokeWidth = 2,\n  ...rest\n}) => /*#__PURE__*/_jsxDEV(\"svg\", {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: size,\n  height: size,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: stroke,\n  strokeWidth: strokeWidth,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  className: className,\n  \"aria-hidden\": \"true\",\n  focusable: \"false\",\n  ...rest,\n  children: children\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 5,\n  columnNumber: 5\n}, this);\n_c = Svg;\nconst IconFlag = props => /*#__PURE__*/_jsxDEV(Svg, {\n  ...props,\n  children: [/*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M4 3v18\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 26,\n    columnNumber: 9\n  }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M4 4s3-1 6 1 6 0 6 0v9s-3 1-6-1-6 0-6 0V4z\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 27,\n    columnNumber: 9\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 25,\n  columnNumber: 5\n}, this);\n_c2 = IconFlag;\nconst IconRuler = props => /*#__PURE__*/_jsxDEV(Svg, {\n  ...props,\n  children: [/*#__PURE__*/_jsxDEV(\"rect\", {\n    x: \"3\",\n    y: \"6\",\n    width: \"18\",\n    height: \"12\",\n    rx: \"2\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 33,\n    columnNumber: 9\n  }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M7 10h2M11 10h2M15 10h2M7 14h1M11 14h1M15 14h1\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 34,\n    columnNumber: 9\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 32,\n  columnNumber: 5\n}, this);\n_c3 = IconRuler;\nconst IconWidth = props => /*#__PURE__*/_jsxDEV(Svg, {\n  ...props,\n  children: [/*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M3 12h18\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 40,\n    columnNumber: 9\n  }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M7 8l-4 4 4 4M17 8l4 4-4 4\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 41,\n    columnNumber: 9\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 39,\n  columnNumber: 5\n}, this);\n_c4 = IconWidth;\nconst IconSearch = props => /*#__PURE__*/_jsxDEV(Svg, {\n  ...props,\n  children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n    cx: \"11\",\n    cy: \"11\",\n    r: \"7\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 47,\n    columnNumber: 9\n  }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"m21 21-3.8-3.8\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 48,\n    columnNumber: 9\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 46,\n  columnNumber: 5\n}, this);\n_c5 = IconSearch;\nconst IconId = props => /*#__PURE__*/_jsxDEV(Svg, {\n  ...props,\n  children: [/*#__PURE__*/_jsxDEV(\"rect\", {\n    x: \"3\",\n    y: \"6\",\n    width: \"18\",\n    height: \"12\",\n    rx: \"2\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 9\n  }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M7 10h6M7 14h10\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 9\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 53,\n  columnNumber: 5\n}, this);\n\n/* ===== Helpers di proiezione e fit su canvas ===== */\n_c6 = IconId;\nfunction projectLatLonToXY(points) {\n  if (!points || points.length === 0) return [];\n  const lat0 = points.reduce((s, p) => s + p.lat, 0) / points.length;\n  const lon0 = points.reduce((s, p) => s + p.lon, 0) / points.length;\n  const mPerDegLat = 111132;\n  const mPerDegLon = 111320 * Math.cos(lat0 * Math.PI / 180);\n  return points.map(p => ({\n    x: (p.lon - lon0) * mPerDegLon,\n    y: (p.lat - lat0) * mPerDegLat * -1\n  }));\n}\nfunction fitToCanvas(localXY, width, height, padding = 20) {\n  if (!localXY.length) return [];\n  const xs = localXY.map(p => p.x),\n    ys = localXY.map(p => p.y);\n  const minX = Math.min(...xs),\n    maxX = Math.max(...xs);\n  const minY = Math.min(...ys),\n    maxY = Math.max(...ys);\n  const spanX = maxX - minX || 1,\n    spanY = maxY - minY || 1;\n  const scale = Math.min((width - 2 * padding) / spanX, (height - 2 * padding) / spanY);\n  const offX = padding - minX * scale + (width - 2 * padding - spanX * scale) / 2;\n  const offY = padding - minY * scale + (height - 2 * padding - spanY * scale) / 2;\n  return localXY.map(p => ({\n    X: p.x * scale + offX,\n    Y: p.y * scale + offY\n  }));\n}\n\n/* ===== Canvas preview per le card ===== */\nfunction MiniTrack({\n  points,\n  className = ''\n}) {\n  _s();\n  const ref = React.useRef(null);\n  React.useEffect(() => {\n    const canvas = ref.current;\n    if (!canvas) return;\n    const ctx = canvas.getContext('2d');\n    const W = canvas.width,\n      H = canvas.height;\n    ctx.clearRect(0, 0, W, H);\n\n    // sfondo soft\n    ctx.fillStyle = 'rgba(255,255,255,0.03)';\n    ctx.fillRect(0, 0, W, H);\n    if (!points || points.length < 2) {\n      ctx.setLineDash([8, 8]);\n      ctx.strokeStyle = 'rgba(255,255,255,0.20)';\n      ctx.lineWidth = 2;\n      ctx.strokeRect(14, 14, W - 28, H - 28);\n      ctx.setLineDash([]);\n      return;\n    }\n    const local = projectLatLonToXY(points);\n    const fitted = fitToCanvas(local, W, H, 14);\n\n    // pista\n    ctx.beginPath();\n    fitted.forEach((p, i) => i ? ctx.lineTo(p.X, p.Y) : ctx.moveTo(p.X, p.Y));\n    ctx.strokeStyle = 'rgba(192,255,3,0.9)';\n    ctx.lineWidth = 2.5;\n    ctx.lineCap = 'round';\n    ctx.lineJoin = 'round';\n    ctx.shadowColor = 'rgba(192,255,3,0.35)';\n    ctx.shadowBlur = 6;\n    ctx.stroke();\n    ctx.shadowBlur = 0;\n\n    // start\n    const s = fitted[0];\n    ctx.fillStyle = '#0a0a0a';\n    ctx.strokeStyle = 'rgba(255,255,255,0.85)';\n    ctx.lineWidth = 1.5;\n    ctx.beginPath();\n    ctx.arc(s.X, s.Y, 4, 0, Math.PI * 2);\n    ctx.fill();\n    ctx.stroke();\n  }, [points]);\n  return /*#__PURE__*/_jsxDEV(\"canvas\", {\n    ref: ref,\n    width: 320,\n    height: 150,\n    className: `cr-mini ${className}`,\n    \"aria-hidden\": \"true\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 134,\n    columnNumber: 9\n  }, this);\n}\n\n/* ===== Canvas grande per il dettaglio ===== */\n_s(MiniTrack, \"8uVE59eA/r6b92xF80p7sH8rXLk=\");\n_c7 = MiniTrack;\nfunction TrackCanvas({\n  points,\n  width = 760,\n  height = 420\n}) {\n  _s2();\n  const ref = React.useRef(null);\n  React.useEffect(() => {\n    const canvas = ref.current;\n    if (!canvas) return;\n    const ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n    // bordo soft\n    ctx.fillStyle = 'rgba(255,255,255,0.02)';\n    ctx.strokeStyle = 'rgba(192,255,3,0.18)';\n    ctx.lineWidth = 1;\n    ctx.strokeRect(0.5, 0.5, canvas.width - 1, canvas.height - 1);\n    if (!points || points.length < 2) return;\n    const local = projectLatLonToXY(points);\n    const fitted = fitToCanvas(local, canvas.width, canvas.height, 24);\n\n    // asfalto\n    ctx.beginPath();\n    fitted.forEach((p, i) => i ? ctx.lineTo(p.X, p.Y) : ctx.moveTo(p.X, p.Y));\n    ctx.strokeStyle = 'rgba(80,84,90,0.95)';\n    ctx.lineWidth = 10;\n    ctx.lineCap = 'round';\n    ctx.lineJoin = 'round';\n    ctx.stroke();\n\n    // bordo\n    ctx.beginPath();\n    fitted.forEach((p, i) => i ? ctx.lineTo(p.X, p.Y) : ctx.moveTo(p.X, p.Y));\n    ctx.strokeStyle = 'rgba(255,255,255,0.12)';\n    ctx.lineWidth = 12;\n    ctx.stroke();\n\n    // linea start\n    const s0 = fitted[0],\n      s1 = fitted[1] || fitted[0];\n    const ang = Math.atan2(s1.Y - s0.Y, s1.X - s0.X);\n    ctx.save();\n    ctx.translate(s0.X, s0.Y);\n    ctx.rotate(ang);\n    ctx.strokeStyle = '#fff';\n    ctx.lineWidth = 3;\n    ctx.beginPath();\n    ctx.moveTo(0, -10);\n    ctx.lineTo(0, 10);\n    ctx.stroke();\n    ctx.restore();\n  }, [points]);\n  return /*#__PURE__*/_jsxDEV(\"canvas\", {\n    ref: ref,\n    width: width,\n    height: height,\n    className: \"cr-canvas\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 195,\n    columnNumber: 12\n  }, this);\n}\n\n/* ===== Modal ===== */\n_s2(TrackCanvas, \"8uVE59eA/r6b92xF80p7sH8rXLk=\");\n_c8 = TrackCanvas;\nfunction Modal({\n  open,\n  onClose,\n  children\n}) {\n  if (!open) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"cr-modal\",\n    role: \"dialog\",\n    \"aria-modal\": \"true\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"cr-backdrop\",\n      onClick: onClose\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"cr-dialog\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"cr-close\",\n        onClick: onClose,\n        \"aria-label\": \"Chiudi\",\n        children: \"\\xD7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 17\n      }, this), children]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 202,\n    columnNumber: 9\n  }, this);\n}\n\n/* ===== Card singola con lazy-preview ===== */\n_c9 = Modal;\nfunction CircuitCard({\n  apiBase,\n  circuit,\n  onOpenDetail\n}) {\n  _s3();\n  var _ref, _circuit$points, _circuit$meta;\n  const [previewPts, setPreviewPts] = React.useState(null);\n  const [isLoading, setIsLoading] = React.useState(false);\n  const cardRef = React.useRef(null);\n  React.useEffect(() => {\n    const el = cardRef.current;\n    if (!el) return;\n    let aborted = false;\n    const controller = new AbortController();\n    const io = new IntersectionObserver(entries => {\n      var _entries$;\n      const v = (_entries$ = entries[0]) === null || _entries$ === void 0 ? void 0 : _entries$.isIntersecting;\n      if (!v) return;\n      io.disconnect();\n      setIsLoading(true);\n      fetch(`${apiBase}/api/circuits/${encodeURIComponent(circuit.id)}`, {\n        signal: controller.signal\n      }).then(r => r.ok ? r.json() : Promise.reject(new Error(`HTTP ${r.status}`))).then(j => {\n        if (aborted) return;\n        const pts = Array.isArray(j.sectors) && j.sectors.length ? j.sectors.map(s => ({\n          lat: s.lat,\n          lon: s.lon\n        })) : Array.isArray(j.pathPoints) ? j.pathPoints : null;\n        setPreviewPts(pts);\n      }).catch(() => {}).finally(() => !aborted && setIsLoading(false));\n    }, {\n      rootMargin: '120px'\n    });\n    io.observe(el);\n    return () => {\n      aborted = true;\n      controller.abort();\n      io.disconnect();\n    };\n  }, [apiBase, circuit.id]);\n  return /*#__PURE__*/_jsxDEV(\"article\", {\n    ref: cardRef,\n    className: \"cr-card\",\n    role: \"button\",\n    tabIndex: 0,\n    onClick: () => onOpenDetail(circuit.id),\n    onKeyDown: e => e.key === 'Enter' && onOpenDetail(circuit.id),\n    children: [/*#__PURE__*/_jsxDEV(MiniTrack, {\n      points: previewPts || [],\n      className: isLoading ? 'loading' : ''\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"cr-card-head\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"cr-title\",\n        children: circuit.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cr-sub muted\",\n        children: circuit.createdAt ? new Date(circuit.createdAt).toLocaleDateString() : 'data sconosciuta'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"footer\", {\n      className: \"cr-meta\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"pill\",\n        children: [/*#__PURE__*/_jsxDEV(IconFlag, {\n          className: \"pill-ic\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 21\n        }, this), (_ref = (_circuit$points = circuit.points) !== null && _circuit$points !== void 0 ? _circuit$points : (_circuit$meta = circuit.meta) === null || _circuit$meta === void 0 ? void 0 : _circuit$meta.points) !== null && _ref !== void 0 ? _ref : '?', \" punti\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 17\n      }, this), circuit.lengthMeters != null && /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"pill\",\n        children: [/*#__PURE__*/_jsxDEV(IconRuler, {\n          className: \"pill-ic\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 25\n        }, this), circuit.lengthMeters.toFixed(1), \" m\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 21\n      }, this), circuit.widthMeters != null && /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"pill\",\n        children: [/*#__PURE__*/_jsxDEV(IconWidth, {\n          className: \"pill-ic\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 25\n        }, this), circuit.widthMeters, \" m\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 248,\n    columnNumber: 9\n  }, this);\n}\n\n/* ===== Pagina ===== */\n_s3(CircuitCard, \"q2+MmCmcf7SNW5W34DO8BiBUPLA=\");\n_c0 = CircuitCard;\nexport default function CircuitsPage({\n  apiBase\n}) {\n  _s4();\n  var _ref2, _detail$meta$points, _detail$meta, _detail$pathPoints, _detail$stats, _detail$params, _detail$params2, _detail$params$minQua, _detail$params3;\n  const [list, setList] = React.useState([]);\n  const [loading, setLoading] = React.useState(true);\n  const [error, setError] = React.useState('');\n  const [query, setQuery] = React.useState('');\n  const [sort, setSort] = React.useState('date_desc');\n  const [openId, setOpenId] = React.useState(null);\n  const [detail, setDetail] = React.useState(null);\n  const [detailLoading, setDetailLoading] = React.useState(false);\n  const [detailError, setDetailError] = React.useState('');\n  React.useEffect(() => {\n    setLoading(true);\n    setError('');\n    fetch(`${apiBase}/api/circuits`).then(r => r.ok ? r.json() : Promise.reject(new Error(`HTTP ${r.status}`))).then(json => setList(json || [])).catch(e => setError(e.message || 'Errore caricamento circuiti')).finally(() => setLoading(false));\n  }, [apiBase]);\n  const filtered = React.useMemo(() => {\n    const q = query.trim().toLowerCase();\n    let arr = list.filter(c => {\n      var _c$name, _c$id;\n      return !q || `${(_c$name = c.name) !== null && _c$name !== void 0 ? _c$name : ''}`.toLowerCase().includes(q) || `${(_c$id = c.id) !== null && _c$id !== void 0 ? _c$id : ''}`.toLowerCase().includes(q);\n    });\n    switch (sort) {\n      case 'name_asc':\n        arr = arr.sort((a, b) => (a.name || '').localeCompare(b.name || ''));\n        break;\n      case 'len_desc':\n        arr = arr.sort((a, b) => (b.lengthMeters || 0) - (a.lengthMeters || 0));\n        break;\n      case 'date_asc':\n        arr = arr.sort((a, b) => new Date(a.createdAt || 0) - new Date(b.createdAt || 0));\n        break;\n      default:\n        arr = arr.sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0));\n    }\n    return arr;\n  }, [list, query, sort]);\n  const openDetail = id => {\n    setOpenId(id);\n    setDetail(null);\n    setDetailError('');\n    setDetailLoading(true);\n    fetch(`${apiBase}/api/circuits/${encodeURIComponent(id)}`).then(r => r.ok ? r.json() : Promise.reject(new Error(`HTTP ${r.status}`))).then(j => setDetail(j)).catch(e => setDetailError(e.message || 'Errore caricamento circuito')).finally(() => setDetailLoading(false));\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"circuits-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-grid\",\n      \"aria-hidden\": \"true\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 349,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-glow bg-glow-1\",\n      \"aria-hidden\": \"true\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 350,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-glow bg-glow-2\",\n      \"aria-hidden\": \"true\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 351,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"main small-top\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"circuits-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"section-title\",\n          children: \"Circuiti\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cr-toolbar\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cr-search\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"cr-search-ic\",\n              \"aria-hidden\": \"true\",\n              children: /*#__PURE__*/_jsxDEV(IconSearch, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 359,\n                columnNumber: 79\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 359,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"cr-input\",\n              type: \"text\",\n              placeholder: \"Cerca per nome o ID\\u2026\",\n              value: query,\n              onChange: e => setQuery(e.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cr-sort\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"muted\",\n              htmlFor: \"sort\",\n              children: \"Ordina\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 370,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              id: \"sort\",\n              className: \"cr-input\",\n              value: sort,\n              onChange: e => setSort(e.target.value),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"date_desc\",\n                children: \"Pi\\xF9 recenti\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 372,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"date_asc\",\n                children: \"Pi\\xF9 vecchi\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 373,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"name_asc\",\n                children: \"Nome (A\\u2192Z)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 374,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"len_desc\",\n                children: \"Lunghezza (\\u2193)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 375,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 371,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 369,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 357,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 17\n      }, this), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cr-grid\",\n        children: Array.from({\n          length: 6\n        }).map((_, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cr-card cr-skel\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cr-mini\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 385,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cr-skel-line\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 386,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cr-skel-line short\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 387,\n            columnNumber: 33\n          }, this)]\n        }, i, true, {\n          fileName: _jsxFileName,\n          lineNumber: 384,\n          columnNumber: 29\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 21\n      }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"muted\",\n        children: [\"Errore: \", error]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 27\n      }, this), !loading && !error && (filtered.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cr-empty\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cr-empty-emoji\",\n          children: \"\\uD83D\\uDCED\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 398,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cr-empty-title\",\n          children: \"Nessun circuito\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 399,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"muted\",\n          children: \"Prova a rimuovere il filtro o aggiungere un nuovo tracciato.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 400,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 25\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cr-grid\",\n        children: filtered.map(c => /*#__PURE__*/_jsxDEV(CircuitCard, {\n          apiBase: apiBase,\n          circuit: c,\n          onOpenDetail: openDetail\n        }, c.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 405,\n          columnNumber: 33\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 403,\n        columnNumber: 25\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      open: !!openId,\n      onClose: () => setOpenId(null),\n      children: [detailLoading && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"muted\",\n        style: {\n          padding: '8px 0'\n        },\n        children: \"Caricamento circuito\\u2026\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 419,\n        columnNumber: 35\n      }, this), detailError && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"muted\",\n        style: {\n          padding: '8px 0'\n        },\n        children: [\"Errore: \", detailError]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 420,\n        columnNumber: 33\n      }, this), detail && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cr-body\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cr-block\",\n            children: /*#__PURE__*/_jsxDEV(TrackCanvas, {\n              points: Array.isArray(detail.sectors) && detail.sectors.length ? detail.sectors.map(s => ({\n                lat: s.lat,\n                lon: s.lon\n              })) : detail.pathPoints || []\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 438,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 437,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cr-block\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"cr-block-title\",\n              children: \"Dati del circuito\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 448,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cr-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-key\",\n                children: \"Creato\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 450,\n                columnNumber: 57\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-val\",\n                children: detail.createdAt ? new Date(detail.createdAt).toLocaleString() : '-'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 450,\n                columnNumber: 95\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 450,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cr-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-key\",\n                children: \"Punti\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 451,\n                columnNumber: 57\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-val\",\n                children: (_ref2 = (_detail$meta$points = (_detail$meta = detail.meta) === null || _detail$meta === void 0 ? void 0 : _detail$meta.points) !== null && _detail$meta$points !== void 0 ? _detail$meta$points : (_detail$pathPoints = detail.pathPoints) === null || _detail$pathPoints === void 0 ? void 0 : _detail$pathPoints.length) !== null && _ref2 !== void 0 ? _ref2 : '-'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 451,\n                columnNumber: 94\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 451,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cr-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-key\",\n                children: \"Lunghezza\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 452,\n                columnNumber: 57\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-val\",\n                children: (_detail$stats = detail.stats) !== null && _detail$stats !== void 0 && _detail$stats.lengthMeters ? `${detail.stats.lengthMeters.toFixed(1)} m` : '-'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 452,\n                columnNumber: 98\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 452,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cr-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-key\",\n                children: \"Larghezza\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 453,\n                columnNumber: 57\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-val\",\n                children: (_detail$params = detail.params) !== null && _detail$params !== void 0 && _detail$params.widthMeters ? `${detail.params.widthMeters} m` : '-'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 453,\n                columnNumber: 98\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 453,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cr-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-key\",\n                children: \"Spacing\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 454,\n                columnNumber: 57\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-val\",\n                children: (_detail$params2 = detail.params) !== null && _detail$params2 !== void 0 && _detail$params2.spacingMeters ? `${detail.params.spacingMeters} m` : '-'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 454,\n                columnNumber: 96\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 454,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cr-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-key\",\n                children: \"minQual\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 455,\n                columnNumber: 57\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-val\",\n                children: (_detail$params$minQua = (_detail$params3 = detail.params) === null || _detail$params3 === void 0 ? void 0 : _detail$params3.minQual) !== null && _detail$params$minQua !== void 0 ? _detail$params$minQua : '-'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 455,\n                columnNumber: 96\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 455,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 447,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 436,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 418,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 348,\n    columnNumber: 9\n  }, this);\n}\n_s4(CircuitsPage, \"vaIm7Cq5SBV0pL9h0iKrBJb0v+0=\");\n_c1 = CircuitsPage;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c0, _c1;\n$RefreshReg$(_c, \"Svg\");\n$RefreshReg$(_c2, \"IconFlag\");\n$RefreshReg$(_c3, \"IconRuler\");\n$RefreshReg$(_c4, \"IconWidth\");\n$RefreshReg$(_c5, \"IconSearch\");\n$RefreshReg$(_c6, \"IconId\");\n$RefreshReg$(_c7, \"MiniTrack\");\n$RefreshReg$(_c8, \"TrackCanvas\");\n$RefreshReg$(_c9, \"Modal\");\n$RefreshReg$(_c0, \"CircuitCard\");\n$RefreshReg$(_c1, \"CircuitsPage\");","map":{"version":3,"names":["React","jsxDEV","_jsxDEV","Svg","children","size","className","stroke","strokeWidth","rest","xmlns","width","height","viewBox","fill","strokeLinecap","strokeLinejoin","focusable","fileName","_jsxFileName","lineNumber","columnNumber","_c","IconFlag","props","d","_c2","IconRuler","x","y","rx","_c3","IconWidth","_c4","IconSearch","cx","cy","r","_c5","IconId","_c6","projectLatLonToXY","points","length","lat0","reduce","s","p","lat","lon0","lon","mPerDegLat","mPerDegLon","Math","cos","PI","map","fitToCanvas","localXY","padding","xs","ys","minX","min","maxX","max","minY","maxY","spanX","spanY","scale","offX","offY","X","Y","MiniTrack","_s","ref","useRef","useEffect","canvas","current","ctx","getContext","W","H","clearRect","fillStyle","fillRect","setLineDash","strokeStyle","lineWidth","strokeRect","local","fitted","beginPath","forEach","i","lineTo","moveTo","lineCap","lineJoin","shadowColor","shadowBlur","arc","_c7","TrackCanvas","_s2","s0","s1","ang","atan2","save","translate","rotate","restore","_c8","Modal","open","onClose","role","onClick","_c9","CircuitCard","apiBase","circuit","onOpenDetail","_s3","_ref","_circuit$points","_circuit$meta","previewPts","setPreviewPts","useState","isLoading","setIsLoading","cardRef","el","aborted","controller","AbortController","io","IntersectionObserver","entries","_entries$","v","isIntersecting","disconnect","fetch","encodeURIComponent","id","signal","then","ok","json","Promise","reject","Error","status","j","pts","Array","isArray","sectors","pathPoints","catch","finally","rootMargin","observe","abort","tabIndex","onKeyDown","e","key","name","createdAt","Date","toLocaleDateString","meta","lengthMeters","toFixed","widthMeters","_c0","CircuitsPage","_s4","_ref2","_detail$meta$points","_detail$meta","_detail$pathPoints","_detail$stats","_detail$params","_detail$params2","_detail$params$minQua","_detail$params3","list","setList","loading","setLoading","error","setError","query","setQuery","sort","setSort","openId","setOpenId","detail","setDetail","detailLoading","setDetailLoading","detailError","setDetailError","message","filtered","useMemo","q","trim","toLowerCase","arr","filter","c","_c$name","_c$id","includes","a","b","localeCompare","openDetail","type","placeholder","value","onChange","target","htmlFor","from","_","style","toLocaleString","stats","params","spacingMeters","minQual","_c1","$RefreshReg$"],"sources":["/home/ubuntu/racesense/racesense-frontend/src/pages/Circuits.jsx"],"sourcesContent":["import React from 'react';\n\n/* ============ ICONS (inline SVG, no deps) ============ */\nconst Svg = ({ children, size = 16, className = '', stroke = 'currentColor', strokeWidth = 2, ...rest }) => (\n    <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        width={size}\n        height={size}\n        viewBox=\"0 0 24 24\"\n        fill=\"none\"\n        stroke={stroke}\n        strokeWidth={strokeWidth}\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        className={className}\n        aria-hidden=\"true\"\n        focusable=\"false\"\n        {...rest}\n    >\n        {children}\n    </svg>\n);\n\nconst IconFlag = (props) => (\n    <Svg {...props}>\n        <path d=\"M4 3v18\" />\n        <path d=\"M4 4s3-1 6 1 6 0 6 0v9s-3 1-6-1-6 0-6 0V4z\" />\n    </Svg>\n);\n\nconst IconRuler = (props) => (\n    <Svg {...props}>\n        <rect x=\"3\" y=\"6\" width=\"18\" height=\"12\" rx=\"2\" />\n        <path d=\"M7 10h2M11 10h2M15 10h2M7 14h1M11 14h1M15 14h1\" />\n    </Svg>\n);\n\nconst IconWidth = (props) => (\n    <Svg {...props}>\n        <path d=\"M3 12h18\" />\n        <path d=\"M7 8l-4 4 4 4M17 8l4 4-4 4\" />\n    </Svg>\n);\n\nconst IconSearch = (props) => (\n    <Svg {...props}>\n        <circle cx=\"11\" cy=\"11\" r=\"7\" />\n        <path d=\"m21 21-3.8-3.8\" />\n    </Svg>\n);\n\nconst IconId = (props) => (\n    <Svg {...props}>\n        <rect x=\"3\" y=\"6\" width=\"18\" height=\"12\" rx=\"2\" />\n        <path d=\"M7 10h6M7 14h10\" />\n    </Svg>\n);\n\n/* ===== Helpers di proiezione e fit su canvas ===== */\nfunction projectLatLonToXY(points) {\n    if (!points || points.length === 0) return [];\n    const lat0 = points.reduce((s, p) => s + p.lat, 0) / points.length;\n    const lon0 = points.reduce((s, p) => s + p.lon, 0) / points.length;\n    const mPerDegLat = 111_132;\n    const mPerDegLon = 111_320 * Math.cos((lat0 * Math.PI) / 180);\n    return points.map(p => ({\n        x: (p.lon - lon0) * mPerDegLon,\n        y: (p.lat - lat0) * mPerDegLat * -1,\n    }));\n}\nfunction fitToCanvas(localXY, width, height, padding = 20) {\n    if (!localXY.length) return [];\n    const xs = localXY.map(p => p.x), ys = localXY.map(p => p.y);\n    const minX = Math.min(...xs), maxX = Math.max(...xs);\n    const minY = Math.min(...ys), maxY = Math.max(...ys);\n    const spanX = (maxX - minX) || 1, spanY = (maxY - minY) || 1;\n    const scale = Math.min((width - 2 * padding) / spanX, (height - 2 * padding) / spanY);\n    const offX = padding - minX * scale + (width - 2 * padding - spanX * scale) / 2;\n    const offY = padding - minY * scale + (height - 2 * padding - spanY * scale) / 2;\n    return localXY.map(p => ({ X: p.x * scale + offX, Y: p.y * scale + offY }));\n}\n\n/* ===== Canvas preview per le card ===== */\nfunction MiniTrack({ points, className = '' }) {\n    const ref = React.useRef(null);\n\n    React.useEffect(() => {\n        const canvas = ref.current;\n        if (!canvas) return;\n        const ctx = canvas.getContext('2d');\n        const W = canvas.width, H = canvas.height;\n        ctx.clearRect(0, 0, W, H);\n\n        // sfondo soft\n        ctx.fillStyle = 'rgba(255,255,255,0.03)';\n        ctx.fillRect(0, 0, W, H);\n\n        if (!points || points.length < 2) {\n            ctx.setLineDash([8, 8]);\n            ctx.strokeStyle = 'rgba(255,255,255,0.20)';\n            ctx.lineWidth = 2;\n            ctx.strokeRect(14, 14, W - 28, H - 28);\n            ctx.setLineDash([]);\n            return;\n        }\n\n        const local = projectLatLonToXY(points);\n        const fitted = fitToCanvas(local, W, H, 14);\n\n        // pista\n        ctx.beginPath();\n        fitted.forEach((p, i) => (i ? ctx.lineTo(p.X, p.Y) : ctx.moveTo(p.X, p.Y)));\n        ctx.strokeStyle = 'rgba(192,255,3,0.9)';\n        ctx.lineWidth = 2.5;\n        ctx.lineCap = 'round';\n        ctx.lineJoin = 'round';\n        ctx.shadowColor = 'rgba(192,255,3,0.35)';\n        ctx.shadowBlur = 6;\n        ctx.stroke();\n        ctx.shadowBlur = 0;\n\n        // start\n        const s = fitted[0];\n        ctx.fillStyle = '#0a0a0a';\n        ctx.strokeStyle = 'rgba(255,255,255,0.85)';\n        ctx.lineWidth = 1.5;\n        ctx.beginPath();\n        ctx.arc(s.X, s.Y, 4, 0, Math.PI * 2);\n        ctx.fill();\n        ctx.stroke();\n    }, [points]);\n\n    return (\n        <canvas\n            ref={ref}\n            width={320}\n            height={150}\n            className={`cr-mini ${className}`}\n            aria-hidden=\"true\"\n        />\n    );\n}\n\n/* ===== Canvas grande per il dettaglio ===== */\nfunction TrackCanvas({ points, width = 760, height = 420 }) {\n    const ref = React.useRef(null);\n    React.useEffect(() => {\n        const canvas = ref.current;\n        if (!canvas) return;\n        const ctx = canvas.getContext('2d');\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n        // bordo soft\n        ctx.fillStyle = 'rgba(255,255,255,0.02)';\n        ctx.strokeStyle = 'rgba(192,255,3,0.18)';\n        ctx.lineWidth = 1;\n        ctx.strokeRect(0.5, 0.5, canvas.width - 1, canvas.height - 1);\n\n        if (!points || points.length < 2) return;\n\n        const local = projectLatLonToXY(points);\n        const fitted = fitToCanvas(local, canvas.width, canvas.height, 24);\n\n        // asfalto\n        ctx.beginPath();\n        fitted.forEach((p, i) => (i ? ctx.lineTo(p.X, p.Y) : ctx.moveTo(p.X, p.Y)));\n        ctx.strokeStyle = 'rgba(80,84,90,0.95)';\n        ctx.lineWidth = 10;\n        ctx.lineCap = 'round';\n        ctx.lineJoin = 'round';\n        ctx.stroke();\n\n        // bordo\n        ctx.beginPath();\n        fitted.forEach((p, i) => (i ? ctx.lineTo(p.X, p.Y) : ctx.moveTo(p.X, p.Y)));\n        ctx.strokeStyle = 'rgba(255,255,255,0.12)';\n        ctx.lineWidth = 12;\n        ctx.stroke();\n\n        // linea start\n        const s0 = fitted[0], s1 = fitted[1] || fitted[0];\n        const ang = Math.atan2(s1.Y - s0.Y, s1.X - s0.X);\n        ctx.save();\n        ctx.translate(s0.X, s0.Y);\n        ctx.rotate(ang);\n        ctx.strokeStyle = '#fff';\n        ctx.lineWidth = 3;\n        ctx.beginPath();\n        ctx.moveTo(0, -10);\n        ctx.lineTo(0, 10);\n        ctx.stroke();\n        ctx.restore();\n    }, [points]);\n\n    return <canvas ref={ref} width={width} height={height} className=\"cr-canvas\" />;\n}\n\n/* ===== Modal ===== */\nfunction Modal({ open, onClose, children }) {\n    if (!open) return null;\n    return (\n        <div className=\"cr-modal\" role=\"dialog\" aria-modal=\"true\">\n            <div className=\"cr-backdrop\" onClick={onClose} />\n            <div className=\"cr-dialog\">\n                <button className=\"cr-close\" onClick={onClose} aria-label=\"Chiudi\">×</button>\n                {children}\n            </div>\n        </div>\n    );\n}\n\n/* ===== Card singola con lazy-preview ===== */\nfunction CircuitCard({ apiBase, circuit, onOpenDetail }) {\n    const [previewPts, setPreviewPts] = React.useState(null);\n    const [isLoading, setIsLoading] = React.useState(false);\n    const cardRef = React.useRef(null);\n\n    React.useEffect(() => {\n        const el = cardRef.current;\n        if (!el) return;\n\n        let aborted = false;\n        const controller = new AbortController();\n\n        const io = new IntersectionObserver((entries) => {\n            const v = entries[0]?.isIntersecting;\n            if (!v) return;\n            io.disconnect();\n            setIsLoading(true);\n            fetch(`${apiBase}/api/circuits/${encodeURIComponent(circuit.id)}`, { signal: controller.signal })\n                .then(r => r.ok ? r.json() : Promise.reject(new Error(`HTTP ${r.status}`)))\n                .then(j => {\n                    if (aborted) return;\n                    const pts = (Array.isArray(j.sectors) && j.sectors.length\n                        ? j.sectors.map(s => ({ lat: s.lat, lon: s.lon }))\n                        : Array.isArray(j.pathPoints) ? j.pathPoints : null);\n                    setPreviewPts(pts);\n                })\n                .catch(() => { })\n                .finally(() => !aborted && setIsLoading(false));\n        }, { rootMargin: '120px' });\n\n        io.observe(el);\n        return () => { aborted = true; controller.abort(); io.disconnect(); };\n    }, [apiBase, circuit.id]);\n\n    return (\n        <article\n            ref={cardRef}\n            className=\"cr-card\"\n            role=\"button\"\n            tabIndex={0}\n            onClick={() => onOpenDetail(circuit.id)}\n            onKeyDown={(e) => e.key === 'Enter' && onOpenDetail(circuit.id)}\n        >\n            <MiniTrack points={previewPts || []} className={isLoading ? 'loading' : ''} />\n\n            <header className=\"cr-card-head\">\n                <h3 className=\"cr-title\">{circuit.name}</h3>\n                <div className=\"cr-sub muted\">\n                    {circuit.createdAt ? new Date(circuit.createdAt).toLocaleDateString() : 'data sconosciuta'}\n                </div>\n            </header>\n\n            <footer className=\"cr-meta\">\n                <span className=\"pill\">\n                    <IconFlag className=\"pill-ic\" />\n                    {(circuit.points ?? circuit.meta?.points ?? '?')} punti\n                </span>\n                {circuit.lengthMeters != null && (\n                    <span className=\"pill\">\n                        <IconRuler className=\"pill-ic\" />\n                        {circuit.lengthMeters.toFixed(1)} m\n                    </span>\n                )}\n                {circuit.widthMeters != null && (\n                    <span className=\"pill\">\n                        <IconWidth className=\"pill-ic\" />\n                        {circuit.widthMeters} m\n                    </span>\n                )}\n                {/* <span className=\"pill ghost\" title={circuit.id}><IconId className=\"pill-ic\" />{circuit.id}</span> */}\n            </footer>\n        </article>\n    );\n}\n\n/* ===== Pagina ===== */\nexport default function CircuitsPage({ apiBase }) {\n    const [list, setList] = React.useState([]);\n    const [loading, setLoading] = React.useState(true);\n    const [error, setError] = React.useState('');\n\n    const [query, setQuery] = React.useState('');\n    const [sort, setSort] = React.useState('date_desc');\n\n    const [openId, setOpenId] = React.useState(null);\n    const [detail, setDetail] = React.useState(null);\n    const [detailLoading, setDetailLoading] = React.useState(false);\n    const [detailError, setDetailError] = React.useState('');\n\n    React.useEffect(() => {\n        setLoading(true);\n        setError('');\n        fetch(`${apiBase}/api/circuits`)\n            .then(r => (r.ok ? r.json() : Promise.reject(new Error(`HTTP ${r.status}`))))\n            .then(json => setList(json || []))\n            .catch(e => setError(e.message || 'Errore caricamento circuiti'))\n            .finally(() => setLoading(false));\n    }, [apiBase]);\n\n    const filtered = React.useMemo(() => {\n        const q = query.trim().toLowerCase();\n        let arr = list.filter(c =>\n            !q ||\n            `${c.name ?? ''}`.toLowerCase().includes(q) ||\n            `${c.id ?? ''}`.toLowerCase().includes(q)\n        );\n        switch (sort) {\n            case 'name_asc':\n                arr = arr.sort((a, b) => (a.name || '').localeCompare(b.name || ''));\n                break;\n            case 'len_desc':\n                arr = arr.sort((a, b) => (b.lengthMeters || 0) - (a.lengthMeters || 0));\n                break;\n            case 'date_asc':\n                arr = arr.sort((a, b) => new Date(a.createdAt || 0) - new Date(b.createdAt || 0));\n                break;\n            default:\n                arr = arr.sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0));\n        }\n        return arr;\n    }, [list, query, sort]);\n\n    const openDetail = (id) => {\n        setOpenId(id);\n        setDetail(null);\n        setDetailError('');\n        setDetailLoading(true);\n        fetch(`${apiBase}/api/circuits/${encodeURIComponent(id)}`)\n            .then(r => (r.ok ? r.json() : Promise.reject(new Error(`HTTP ${r.status}`))))\n            .then(j => setDetail(j))\n            .catch(e => setDetailError(e.message || 'Errore caricamento circuito'))\n            .finally(() => setDetailLoading(false));\n    };\n\n    return (\n        <div className=\"circuits-page\">\n            <div className=\"bg-grid\" aria-hidden=\"true\" />\n            <div className=\"bg-glow bg-glow-1\" aria-hidden=\"true\" />\n            <div className=\"bg-glow bg-glow-2\" aria-hidden=\"true\" />\n\n            <main className=\"main small-top\">\n                <div className=\"circuits-header\">\n                    <h2 className=\"section-title\">Circuiti</h2>\n\n                    <div className=\"cr-toolbar\">\n                        <div className=\"cr-search\">\n                            <span className=\"cr-search-ic\" aria-hidden=\"true\"><IconSearch /></span>\n                            <input\n                                className=\"cr-input\"\n                                type=\"text\"\n                                placeholder=\"Cerca per nome o ID…\"\n                                value={query}\n                                onChange={e => setQuery(e.target.value)}\n                            />\n                        </div>\n\n                        <div className=\"cr-sort\">\n                            <label className=\"muted\" htmlFor=\"sort\">Ordina</label>\n                            <select id=\"sort\" className=\"cr-input\" value={sort} onChange={e => setSort(e.target.value)}>\n                                <option value=\"date_desc\">Più recenti</option>\n                                <option value=\"date_asc\">Più vecchi</option>\n                                <option value=\"name_asc\">Nome (A→Z)</option>\n                                <option value=\"len_desc\">Lunghezza (↓)</option>\n                            </select>\n                        </div>\n                    </div>\n                </div>\n\n                {loading && (\n                    <div className=\"cr-grid\">\n                        {Array.from({ length: 6 }).map((_, i) => (\n                            <div className=\"cr-card cr-skel\" key={i}>\n                                <div className=\"cr-mini\" />\n                                <div className=\"cr-skel-line\" />\n                                <div className=\"cr-skel-line short\" />\n                            </div>\n                        ))}\n                    </div>\n                )}\n\n                {error && <p className=\"muted\">Errore: {error}</p>}\n\n                {!loading && !error && (\n                    filtered.length === 0 ? (\n                        <div className=\"cr-empty\">\n                            <div className=\"cr-empty-emoji\">📭</div>\n                            <div className=\"cr-empty-title\">Nessun circuito</div>\n                            <div className=\"muted\">Prova a rimuovere il filtro o aggiungere un nuovo tracciato.</div>\n                        </div>\n                    ) : (\n                        <div className=\"cr-grid\">\n                            {filtered.map(c => (\n                                <CircuitCard\n                                    key={c.id}\n                                    apiBase={apiBase}\n                                    circuit={c}\n                                    onOpenDetail={openDetail}\n                                />\n                            ))}\n                        </div>\n                    )\n                )}\n            </main>\n\n            {/* MODALE DETTAGLIO */}\n            <Modal open={!!openId} onClose={() => setOpenId(null)}>\n                {detailLoading && <p className=\"muted\" style={{ padding: '8px 0' }}>Caricamento circuito…</p>}\n                {detailError && <p className=\"muted\" style={{ padding: '8px 0' }}>Errore: {detailError}</p>}\n                {detail && (\n                    <div>\n                        {/* <div className=\"cr-dialog-head\">\n                            <h3 className=\"cr-dialog-title\">{detail.name}</h3>\n                            <div className=\"cr-dialog-tags\">\n                                {detail.stats?.lengthMeters != null && (\n                                    <span className=\"pill\"><IconRuler className=\"pill-ic\" />{detail.stats.lengthMeters.toFixed(1)} m</span>\n                                )}\n                                {detail.params?.widthMeters != null && (\n                                    <span className=\"pill\"><IconWidth className=\"pill-ic\" />{detail.params.widthMeters} m</span>\n                                )}\n                                <span className=\"pill\"><IconFlag className=\"pill-ic\" />{detail.meta?.points ?? detail.pathPoints?.length ?? '-'}</span>\n                            </div>\n                        </div> */}\n\n                        <div className=\"cr-body\">\n                            <div className=\"cr-block\">\n                                <TrackCanvas\n                                    points={\n                                        (Array.isArray(detail.sectors) && detail.sectors.length\n                                            ? detail.sectors.map(s => ({ lat: s.lat, lon: s.lon }))\n                                            : detail.pathPoints || [])\n                                    }\n                                />\n                            </div>\n\n                            <div className=\"cr-block\">\n                                <h4 className=\"cr-block-title\">Dati del circuito</h4>\n                                {/* <div className=\"cr-row\"><span className=\"cr-key\">ID</span><span className=\"cr-val\" title={detail.id}>{detail.id}</span></div> */}\n                                <div className=\"cr-row\"><span className=\"cr-key\">Creato</span><span className=\"cr-val\">{detail.createdAt ? new Date(detail.createdAt).toLocaleString() : '-'}</span></div>\n                                <div className=\"cr-row\"><span className=\"cr-key\">Punti</span><span className=\"cr-val\">{detail.meta?.points ?? detail.pathPoints?.length ?? '-'}</span></div>\n                                <div className=\"cr-row\"><span className=\"cr-key\">Lunghezza</span><span className=\"cr-val\">{detail.stats?.lengthMeters ? `${detail.stats.lengthMeters.toFixed(1)} m` : '-'}</span></div>\n                                <div className=\"cr-row\"><span className=\"cr-key\">Larghezza</span><span className=\"cr-val\">{detail.params?.widthMeters ? `${detail.params.widthMeters} m` : '-'}</span></div>\n                                <div className=\"cr-row\"><span className=\"cr-key\">Spacing</span><span className=\"cr-val\">{detail.params?.spacingMeters ? `${detail.params.spacingMeters} m` : '-'}</span></div>\n                                <div className=\"cr-row\"><span className=\"cr-key\">minQual</span><span className=\"cr-val\">{detail.params?.minQual ?? '-'}</span></div>\n                            </div>\n                        </div>\n                    </div>\n                )}\n            </Modal>\n        </div>\n    );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}