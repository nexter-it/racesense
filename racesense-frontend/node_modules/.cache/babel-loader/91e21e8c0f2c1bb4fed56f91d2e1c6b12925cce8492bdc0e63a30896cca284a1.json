{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/racesense-frontend/src/pages/Circuits.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React from 'react';\n\n/** Utils: proiezione locale (lat/lon → x,y in metri), poi fit su canvas */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction projectLatLonToXY(points) {\n  if (!points || points.length === 0) return [];\n  // centro geografico\n  const lat0 = points.reduce((s, p) => s + p.lat, 0) / points.length;\n  const lon0 = points.reduce((s, p) => s + p.lon, 0) / points.length;\n\n  // metri per grado (approssimazione valida su piccole aree)\n  const mPerDegLat = 111132; // ~m/deg lat\n  const mPerDegLon = 111320 * Math.cos(lat0 * Math.PI / 180); // ~m/deg lon scalato\n\n  return points.map(p => ({\n    x: (p.lon - lon0) * mPerDegLon,\n    y: (p.lat - lat0) * mPerDegLat * -1 // inverti Y (lat ↑ = y ↓ nel canvas)\n  }));\n}\n\n/** Fit in canvas con padding, mantiene aspect ratio */\nfunction fitToCanvas(localXY, width, height, padding = 20) {\n  if (localXY.length === 0) return [];\n  const xs = localXY.map(p => p.x),\n    ys = localXY.map(p => p.y);\n  const minX = Math.min(...xs),\n    maxX = Math.max(...xs);\n  const minY = Math.min(...ys),\n    maxY = Math.max(...ys);\n  const spanX = maxX - minX || 1;\n  const spanY = maxY - minY || 1;\n  const scaleX = (width - 2 * padding) / spanX;\n  const scaleY = (height - 2 * padding) / spanY;\n  const scale = Math.min(scaleX, scaleY);\n  const offX = padding - minX * scale + (width - 2 * padding - spanX * scale) / 2;\n  const offY = padding - minY * scale + (height - 2 * padding - spanY * scale) / 2;\n  return localXY.map(p => ({\n    X: p.x * scale + offX,\n    Y: p.y * scale + offY\n  }));\n}\n\n/** Canvas track renderer */\nfunction TrackCanvas({\n  points,\n  width = 700,\n  height = 420,\n  stroke = 'rgba(192,255,3,0.95)'\n}) {\n  _s();\n  const ref = React.useRef(null);\n  React.useEffect(() => {\n    const canvas = ref.current;\n    if (!canvas || !points || points.length < 2) return;\n    const ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n    // proiezione e fit\n    const local = projectLatLonToXY(points);\n    const fitted = fitToCanvas(local, canvas.width, canvas.height, 24);\n\n    // bordo\n    ctx.fillStyle = 'rgba(255,255,255,0.02)';\n    ctx.strokeStyle = 'rgba(192,255,3,0.25)';\n    ctx.lineWidth = 1;\n    ctx.strokeRect(0.5, 0.5, canvas.width - 1, canvas.height - 1);\n\n    // tracciato\n    ctx.beginPath();\n    fitted.forEach((p, i) => {\n      if (i === 0) ctx.moveTo(p.X, p.Y);else ctx.lineTo(p.X, p.Y);\n    });\n    ctx.strokeStyle = stroke;\n    ctx.lineWidth = 3;\n    ctx.shadowColor = 'rgba(192,255,3,0.35)';\n    ctx.shadowBlur = 8;\n    ctx.stroke();\n    ctx.shadowBlur = 0;\n\n    // punto di start (primo)\n    const s = fitted[0];\n    ctx.fillStyle = '#000';\n    ctx.strokeStyle = 'rgba(192,255,3,0.8)';\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n    ctx.arc(s.X, s.Y, 6, 0, Math.PI * 2);\n    ctx.fill();\n    ctx.stroke();\n  }, [points]);\n  return /*#__PURE__*/_jsxDEV(\"canvas\", {\n    ref: ref,\n    width: width,\n    height: height,\n    style: {\n      width: '100%',\n      height: 'auto',\n      borderRadius: 12\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 86,\n    columnNumber: 12\n  }, this);\n}\n\n/** Modal semplice */\n_s(TrackCanvas, \"8uVE59eA/r6b92xF80p7sH8rXLk=\");\n_c = TrackCanvas;\nfunction Modal({\n  open,\n  onClose,\n  children\n}) {\n  if (!open) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"cr-modal\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"cr-backdrop\",\n      onClick: onClose\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"cr-dialog\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"cr-close\",\n        onClick: onClose,\n        \"aria-label\": \"Chiudi\",\n        children: \"\\xD7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 17\n      }, this), children]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 93,\n    columnNumber: 9\n  }, this);\n}\n_c2 = Modal;\nexport default function CircuitsPage({\n  apiBase\n}) {\n  _s2();\n  var _ref, _detail$meta$points, _detail$meta, _detail$pathPoints, _detail$stats, _detail$params, _detail$params2, _detail$params$minQua, _detail$params3;\n  const [list, setList] = React.useState([]);\n  const [loading, setLoading] = React.useState(true);\n  const [error, setError] = React.useState('');\n  const [openId, setOpenId] = React.useState(null);\n  const [detail, setDetail] = React.useState(null);\n  const [detailLoading, setDetailLoading] = React.useState(false);\n  const [detailError, setDetailError] = React.useState('');\n  React.useEffect(() => {\n    setLoading(true);\n    setError('');\n    fetch(`${apiBase}/api/circuits`).then(r => r.ok ? r.json() : Promise.reject(new Error(`HTTP ${r.status}`))).then(json => setList(json)).catch(e => setError(e.message || 'Errore caricamento circuiti')).finally(() => setLoading(false));\n  }, [apiBase]);\n  const openDetail = id => {\n    setOpenId(id);\n    setDetail(null);\n    setDetailError('');\n    setDetailLoading(true);\n    fetch(`${apiBase}/api/circuits/${encodeURIComponent(id)}`).then(r => r.ok ? r.json() : Promise.reject(new Error(`HTTP ${r.status}`))).then(j => setDetail(j)).catch(e => setDetailError(e.message || 'Errore caricamento circuito')).finally(() => setDetailLoading(false));\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"circuits-page\",\n    children: [/*#__PURE__*/_jsxDEV(\"style\", {\n      children: `\n        .circuits-header { display:flex; align-items:center; justify-content:space-between; margin-bottom: 14px; }\n        .section-title{ color: var(--brand); font-weight: 900; font-size: 1.8rem; letter-spacing:.5px; }\n        .muted{ color: var(--muted); }\n        .cr-grid{\n          display:grid;\n          grid-template-columns: repeat(3, minmax(0,1fr));\n          gap: 14px;\n        }\n        .cr-card{\n          background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));\n          border: 1px solid var(--line);\n          border-radius: var(--radius);\n          padding: 14px;\n          box-shadow: var(--shadow);\n          cursor: pointer;\n          transition: .2s;\n        }\n        .cr-card:hover{ transform: translateY(-2px); border-color: rgba(192,255,3,0.55); }\n        .cr-title{ font-weight: 900; color:white;}\n        .cr-meta{ display:flex; gap:10px; flex-wrap:wrap; margin-top:6px; }\n        .pill{\n          padding: 6px 10px; border-radius: 999px; font-size: .9rem;\n          background: var(--glass); border: 1px solid var(--line); color: var(--fg);\n        }\n        @media (max-width: 960px){ .cr-grid{ grid-template-columns: 1fr; } }\n\n        /* Modal */\n        .cr-modal{ position: fixed; inset:0; z-index: 50; }\n        .cr-backdrop{ position:absolute; inset:0; background:rgba(0,0,0,0.6); }\n        .cr-dialog{\n          position:absolute; inset:auto 0 0 0; margin:auto; top:8%;\n          max-width: 980px; width: calc(100% - 24px);\n          background: linear-gradient(180deg, rgba(20,20,20,0.98), rgba(10,10,10,0.98));\n          border: 1px solid var(--line); border-radius: 16px; box-shadow: var(--shadow);\n          padding: 16px;\n        }\n        .cr-close{\n          position:absolute; top:8px; right:10px; background:transparent; border: none;\n          font-size: 28px; color: var(--fg); cursor:pointer; line-height:1;\n        }\n        .cr-body{ display:grid; grid-template-columns: 1.2fr .8fr; gap: 14px; }\n        @media (max-width: 960px){ .cr-body{ grid-template-columns: 1fr; } }\n        .cr-block{ background: var(--glass); border: 1px solid var(--line); border-radius: 12px; padding: 12px; }\n        .cr-block h4{ margin-bottom: 8px; color:white}\n        .cr-row{ display:flex; justify-content: space-between; margin-bottom: 6px; }\n        .cr-key{ color: var(--muted); }\n        .cr-val{ font-weight: 700; color:white}\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-grid\",\n      \"aria-hidden\": \"true\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-glow bg-glow-1\",\n      \"aria-hidden\": \"true\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-glow bg-glow-2\",\n      \"aria-hidden\": \"true\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"main small-top\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"circuits-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"section-title\",\n          children: \"Circuiti\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"muted\",\n          children: loading ? 'Caricamento...' : `${list.length} trovati`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 17\n      }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"muted\",\n        children: [\"Errore: \", error]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 27\n      }, this), !loading && !error && (list.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"muted\",\n        children: [\"Nessun circuito trovato in \", /*#__PURE__*/_jsxDEV(\"code\", {\n          children: \"data/circuiti\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 73\n        }, this), \".\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 25\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cr-grid\",\n        children: list.map(c => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cr-card\",\n          onClick: () => openDetail(c.id),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cr-title\",\n            children: c.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 37\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"muted\",\n            style: {\n              fontSize: '.9rem',\n              marginTop: 2\n            },\n            children: c.createdAt ? new Date(c.createdAt).toLocaleString() : 'data sconosciuta'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 37\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cr-meta\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"pill\",\n              children: [c.points, \" punti\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 211,\n              columnNumber: 41\n            }, this), c.lengthMeters != null && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"pill\",\n              children: [c.lengthMeters.toFixed(1), \" m\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 68\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 37\n          }, this)]\n        }, c.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 33\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 25\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      open: !!openId,\n      onClose: () => setOpenId(null),\n      children: [detailLoading && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"muted\",\n        style: {\n          padding: '8px 0'\n        },\n        children: \"Caricamento circuito...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 35\n      }, this), detailError && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"muted\",\n        style: {\n          padding: '8px 0'\n        },\n        children: [\"Errore: \", detailError]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 33\n      }, this), detail && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          style: {\n            margin: '6px 0 12px 4px',\n            color: 'white'\n          },\n          children: detail.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cr-body\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cr-block\",\n            children: /*#__PURE__*/_jsxDEV(TrackCanvas, {\n              points: detail.pathPoints || []\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 231,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cr-block\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"Dati\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cr-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-key\",\n                children: \"ID \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 235,\n                columnNumber: 57\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-val\",\n                title: detail.id,\n                children: detail.id\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 235,\n                columnNumber: 92\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 235,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cr-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-key\",\n                children: \"Creato\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 236,\n                columnNumber: 57\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-val\",\n                children: detail.createdAt ? new Date(detail.createdAt).toLocaleString() : '-'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 236,\n                columnNumber: 95\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 236,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cr-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-key\",\n                children: \"Punti\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 237,\n                columnNumber: 57\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-val\",\n                children: (_ref = (_detail$meta$points = (_detail$meta = detail.meta) === null || _detail$meta === void 0 ? void 0 : _detail$meta.points) !== null && _detail$meta$points !== void 0 ? _detail$meta$points : (_detail$pathPoints = detail.pathPoints) === null || _detail$pathPoints === void 0 ? void 0 : _detail$pathPoints.length) !== null && _ref !== void 0 ? _ref : '-'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 237,\n                columnNumber: 94\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 237,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cr-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-key\",\n                children: \"Lunghezza\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 238,\n                columnNumber: 57\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-val\",\n                children: (_detail$stats = detail.stats) !== null && _detail$stats !== void 0 && _detail$stats.lengthMeters ? `${detail.stats.lengthMeters.toFixed(1)} m` : '-'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 238,\n                columnNumber: 98\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 238,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cr-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-key\",\n                children: \"Larghezza\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 239,\n                columnNumber: 57\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-val\",\n                children: (_detail$params = detail.params) !== null && _detail$params !== void 0 && _detail$params.widthMeters ? `${detail.params.widthMeters} m` : '-'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 239,\n                columnNumber: 98\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 239,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cr-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-key\",\n                children: \"Spacing\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 240,\n                columnNumber: 57\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-val\",\n                children: (_detail$params2 = detail.params) !== null && _detail$params2 !== void 0 && _detail$params2.spacingMeters ? `${detail.params.spacingMeters} m` : '-'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 240,\n                columnNumber: 96\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 240,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cr-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-key\",\n                children: \"minQual\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 241,\n                columnNumber: 57\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"cr-val\",\n                children: (_detail$params$minQua = (_detail$params3 = detail.params) === null || _detail$params3 === void 0 ? void 0 : _detail$params3.minQual) !== null && _detail$params$minQua !== void 0 ? _detail$params$minQua : '-'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 241,\n                columnNumber: 96\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 241,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 136,\n    columnNumber: 9\n  }, this);\n}\n_s2(CircuitsPage, \"AZkWkqw9C671TWSmpkMiz4eQwiw=\");\n_c3 = CircuitsPage;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"TrackCanvas\");\n$RefreshReg$(_c2, \"Modal\");\n$RefreshReg$(_c3, \"CircuitsPage\");","map":{"version":3,"names":["React","jsxDEV","_jsxDEV","projectLatLonToXY","points","length","lat0","reduce","s","p","lat","lon0","lon","mPerDegLat","mPerDegLon","Math","cos","PI","map","x","y","fitToCanvas","localXY","width","height","padding","xs","ys","minX","min","maxX","max","minY","maxY","spanX","spanY","scaleX","scaleY","scale","offX","offY","X","Y","TrackCanvas","stroke","_s","ref","useRef","useEffect","canvas","current","ctx","getContext","clearRect","local","fitted","fillStyle","strokeStyle","lineWidth","strokeRect","beginPath","forEach","i","moveTo","lineTo","shadowColor","shadowBlur","arc","fill","style","borderRadius","fileName","_jsxFileName","lineNumber","columnNumber","_c","Modal","open","onClose","children","className","onClick","_c2","CircuitsPage","apiBase","_s2","_ref","_detail$meta$points","_detail$meta","_detail$pathPoints","_detail$stats","_detail$params","_detail$params2","_detail$params$minQua","_detail$params3","list","setList","useState","loading","setLoading","error","setError","openId","setOpenId","detail","setDetail","detailLoading","setDetailLoading","detailError","setDetailError","fetch","then","r","ok","json","Promise","reject","Error","status","catch","e","message","finally","openDetail","id","encodeURIComponent","j","c","name","fontSize","marginTop","createdAt","Date","toLocaleString","lengthMeters","toFixed","margin","color","pathPoints","title","meta","stats","params","widthMeters","spacingMeters","minQual","_c3","$RefreshReg$"],"sources":["/home/ubuntu/racesense-frontend/src/pages/Circuits.jsx"],"sourcesContent":["import React from 'react';\n\n/** Utils: proiezione locale (lat/lon → x,y in metri), poi fit su canvas */\nfunction projectLatLonToXY(points) {\n    if (!points || points.length === 0) return [];\n    // centro geografico\n    const lat0 = points.reduce((s, p) => s + p.lat, 0) / points.length;\n    const lon0 = points.reduce((s, p) => s + p.lon, 0) / points.length;\n\n    // metri per grado (approssimazione valida su piccole aree)\n    const mPerDegLat = 111_132; // ~m/deg lat\n    const mPerDegLon = 111_320 * Math.cos(lat0 * Math.PI / 180); // ~m/deg lon scalato\n\n    return points.map(p => ({\n        x: (p.lon - lon0) * mPerDegLon,\n        y: (p.lat - lat0) * mPerDegLat * -1, // inverti Y (lat ↑ = y ↓ nel canvas)\n    }));\n}\n\n/** Fit in canvas con padding, mantiene aspect ratio */\nfunction fitToCanvas(localXY, width, height, padding = 20) {\n    if (localXY.length === 0) return [];\n    const xs = localXY.map(p => p.x), ys = localXY.map(p => p.y);\n    const minX = Math.min(...xs), maxX = Math.max(...xs);\n    const minY = Math.min(...ys), maxY = Math.max(...ys);\n    const spanX = (maxX - minX) || 1;\n    const spanY = (maxY - minY) || 1;\n\n    const scaleX = (width - 2 * padding) / spanX;\n    const scaleY = (height - 2 * padding) / spanY;\n    const scale = Math.min(scaleX, scaleY);\n\n    const offX = padding - minX * scale + (width - 2 * padding - spanX * scale) / 2;\n    const offY = padding - minY * scale + (height - 2 * padding - spanY * scale) / 2;\n\n    return localXY.map(p => ({\n        X: p.x * scale + offX,\n        Y: p.y * scale + offY\n    }));\n}\n\n/** Canvas track renderer */\nfunction TrackCanvas({ points, width = 700, height = 420, stroke = 'rgba(192,255,3,0.95)' }) {\n    const ref = React.useRef(null);\n\n    React.useEffect(() => {\n        const canvas = ref.current;\n        if (!canvas || !points || points.length < 2) return;\n        const ctx = canvas.getContext('2d');\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n        // proiezione e fit\n        const local = projectLatLonToXY(points);\n        const fitted = fitToCanvas(local, canvas.width, canvas.height, 24);\n\n        // bordo\n        ctx.fillStyle = 'rgba(255,255,255,0.02)';\n        ctx.strokeStyle = 'rgba(192,255,3,0.25)';\n        ctx.lineWidth = 1;\n        ctx.strokeRect(0.5, 0.5, canvas.width - 1, canvas.height - 1);\n\n        // tracciato\n        ctx.beginPath();\n        fitted.forEach((p, i) => {\n            if (i === 0) ctx.moveTo(p.X, p.Y);\n            else ctx.lineTo(p.X, p.Y);\n        });\n        ctx.strokeStyle = stroke;\n        ctx.lineWidth = 3;\n        ctx.shadowColor = 'rgba(192,255,3,0.35)';\n        ctx.shadowBlur = 8;\n        ctx.stroke();\n        ctx.shadowBlur = 0;\n\n        // punto di start (primo)\n        const s = fitted[0];\n        ctx.fillStyle = '#000';\n        ctx.strokeStyle = 'rgba(192,255,3,0.8)';\n        ctx.lineWidth = 2;\n        ctx.beginPath();\n        ctx.arc(s.X, s.Y, 6, 0, Math.PI * 2);\n        ctx.fill();\n        ctx.stroke();\n    }, [points]);\n\n    return <canvas ref={ref} width={width} height={height} style={{ width: '100%', height: 'auto', borderRadius: 12 }} />;\n}\n\n/** Modal semplice */\nfunction Modal({ open, onClose, children }) {\n    if (!open) return null;\n    return (\n        <div className=\"cr-modal\">\n            <div className=\"cr-backdrop\" onClick={onClose} />\n            <div className=\"cr-dialog\">\n                <button className=\"cr-close\" onClick={onClose} aria-label=\"Chiudi\">×</button>\n                {children}\n            </div>\n        </div>\n    );\n}\n\nexport default function CircuitsPage({ apiBase }) {\n    const [list, setList] = React.useState([]);\n    const [loading, setLoading] = React.useState(true);\n    const [error, setError] = React.useState('');\n\n    const [openId, setOpenId] = React.useState(null);\n    const [detail, setDetail] = React.useState(null);\n    const [detailLoading, setDetailLoading] = React.useState(false);\n    const [detailError, setDetailError] = React.useState('');\n\n    React.useEffect(() => {\n        setLoading(true);\n        setError('');\n        fetch(`${apiBase}/api/circuits`)\n            .then(r => r.ok ? r.json() : Promise.reject(new Error(`HTTP ${r.status}`)))\n            .then(json => setList(json))\n            .catch(e => setError(e.message || 'Errore caricamento circuiti'))\n            .finally(() => setLoading(false));\n    }, [apiBase]);\n\n    const openDetail = (id) => {\n        setOpenId(id);\n        setDetail(null);\n        setDetailError('');\n        setDetailLoading(true);\n        fetch(`${apiBase}/api/circuits/${encodeURIComponent(id)}`)\n            .then(r => r.ok ? r.json() : Promise.reject(new Error(`HTTP ${r.status}`)))\n            .then(j => setDetail(j))\n            .catch(e => setDetailError(e.message || 'Errore caricamento circuito'))\n            .finally(() => setDetailLoading(false));\n    };\n\n    return (\n        <div className=\"circuits-page\">\n            <style>{`\n        .circuits-header { display:flex; align-items:center; justify-content:space-between; margin-bottom: 14px; }\n        .section-title{ color: var(--brand); font-weight: 900; font-size: 1.8rem; letter-spacing:.5px; }\n        .muted{ color: var(--muted); }\n        .cr-grid{\n          display:grid;\n          grid-template-columns: repeat(3, minmax(0,1fr));\n          gap: 14px;\n        }\n        .cr-card{\n          background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));\n          border: 1px solid var(--line);\n          border-radius: var(--radius);\n          padding: 14px;\n          box-shadow: var(--shadow);\n          cursor: pointer;\n          transition: .2s;\n        }\n        .cr-card:hover{ transform: translateY(-2px); border-color: rgba(192,255,3,0.55); }\n        .cr-title{ font-weight: 900; color:white;}\n        .cr-meta{ display:flex; gap:10px; flex-wrap:wrap; margin-top:6px; }\n        .pill{\n          padding: 6px 10px; border-radius: 999px; font-size: .9rem;\n          background: var(--glass); border: 1px solid var(--line); color: var(--fg);\n        }\n        @media (max-width: 960px){ .cr-grid{ grid-template-columns: 1fr; } }\n\n        /* Modal */\n        .cr-modal{ position: fixed; inset:0; z-index: 50; }\n        .cr-backdrop{ position:absolute; inset:0; background:rgba(0,0,0,0.6); }\n        .cr-dialog{\n          position:absolute; inset:auto 0 0 0; margin:auto; top:8%;\n          max-width: 980px; width: calc(100% - 24px);\n          background: linear-gradient(180deg, rgba(20,20,20,0.98), rgba(10,10,10,0.98));\n          border: 1px solid var(--line); border-radius: 16px; box-shadow: var(--shadow);\n          padding: 16px;\n        }\n        .cr-close{\n          position:absolute; top:8px; right:10px; background:transparent; border: none;\n          font-size: 28px; color: var(--fg); cursor:pointer; line-height:1;\n        }\n        .cr-body{ display:grid; grid-template-columns: 1.2fr .8fr; gap: 14px; }\n        @media (max-width: 960px){ .cr-body{ grid-template-columns: 1fr; } }\n        .cr-block{ background: var(--glass); border: 1px solid var(--line); border-radius: 12px; padding: 12px; }\n        .cr-block h4{ margin-bottom: 8px; color:white}\n        .cr-row{ display:flex; justify-content: space-between; margin-bottom: 6px; }\n        .cr-key{ color: var(--muted); }\n        .cr-val{ font-weight: 700; color:white}\n      `}</style>\n\n            <div className=\"bg-grid\" aria-hidden=\"true\" />\n            <div className=\"bg-glow bg-glow-1\" aria-hidden=\"true\" />\n            <div className=\"bg-glow bg-glow-2\" aria-hidden=\"true\" />\n\n            <main className=\"main small-top\">\n                <div className=\"circuits-header\">\n                    <h2 className=\"section-title\">Circuiti</h2>\n                    <span className=\"muted\">{loading ? 'Caricamento...' : `${list.length} trovati`}</span>\n                </div>\n\n                {error && <p className=\"muted\">Errore: {error}</p>}\n\n                {!loading && !error && (\n                    list.length === 0 ? (\n                        <p className=\"muted\">Nessun circuito trovato in <code>data/circuiti</code>.</p>\n                    ) : (\n                        <div className=\"cr-grid\">\n                            {list.map(c => (\n                                <div key={c.id} className=\"cr-card\" onClick={() => openDetail(c.id)}>\n                                    <div className=\"cr-title\">{c.name}</div>\n                                    <div className=\"muted\" style={{ fontSize: '.9rem', marginTop: 2 }}>\n                                        {c.createdAt ? new Date(c.createdAt).toLocaleString() : 'data sconosciuta'}\n                                    </div>\n                                    <div className=\"cr-meta\">\n                                        <span className=\"pill\">{c.points} punti</span>\n                                        {c.lengthMeters != null && <span className=\"pill\">{c.lengthMeters.toFixed(1)} m</span>}\n                                        {/* <span className=\"pill\" title={c.filename}>{c.id}</span> */}\n                                    </div>\n                                </div>\n                            ))}\n                        </div>\n                    )\n                )}\n            </main>\n\n            {/* MODAL DETTAGLIO */}\n            <Modal open={!!openId} onClose={() => setOpenId(null)}>\n                {detailLoading && <p className=\"muted\" style={{ padding: '8px 0' }}>Caricamento circuito...</p>}\n                {detailError && <p className=\"muted\" style={{ padding: '8px 0' }}>Errore: {detailError}</p>}\n                {detail && (\n                    <div>\n                        <h3 style={{ margin: '6px 0 12px 4px', color: 'white' }}>{detail.name}</h3>\n                        <div className=\"cr-body\">\n                            <div className=\"cr-block\">\n                                <TrackCanvas points={detail.pathPoints || []} />\n                            </div>\n                            <div className=\"cr-block\">\n                                <h4>Dati</h4>\n                                <div className=\"cr-row\"><span className=\"cr-key\">ID </span><span className=\"cr-val\" title={detail.id}>{detail.id}</span></div>\n                                <div className=\"cr-row\"><span className=\"cr-key\">Creato</span><span className=\"cr-val\">{detail.createdAt ? new Date(detail.createdAt).toLocaleString() : '-'}</span></div>\n                                <div className=\"cr-row\"><span className=\"cr-key\">Punti</span><span className=\"cr-val\">{detail.meta?.points ?? detail.pathPoints?.length ?? '-'}</span></div>\n                                <div className=\"cr-row\"><span className=\"cr-key\">Lunghezza</span><span className=\"cr-val\">{detail.stats?.lengthMeters ? `${detail.stats.lengthMeters.toFixed(1)} m` : '-'}</span></div>\n                                <div className=\"cr-row\"><span className=\"cr-key\">Larghezza</span><span className=\"cr-val\">{detail.params?.widthMeters ? `${detail.params.widthMeters} m` : '-'}</span></div>\n                                <div className=\"cr-row\"><span className=\"cr-key\">Spacing</span><span className=\"cr-val\">{detail.params?.spacingMeters ? `${detail.params.spacingMeters} m` : '-'}</span></div>\n                                <div className=\"cr-row\"><span className=\"cr-key\">minQual</span><span className=\"cr-val\">{detail.params?.minQual ?? '-'}</span></div>\n                            </div>\n                        </div>\n                    </div>\n                )}\n            </Modal>\n        </div>\n    );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}