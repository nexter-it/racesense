{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/racesense/racesense-frontend/src/pages/RaceLive.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport '../App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE = process.env.REACT_APP_API_BASE || `http://${window.location.hostname}:5000`;\nconst WS_URL = process.env.REACT_APP_WS_URL || `ws://${window.location.hostname}:5001`;\n\n/* ===== utils ===== */\nfunction formatLap(sec) {\n  if (!sec && sec !== 0) return '—';\n  const m = Math.floor(sec / 60);\n  const s = (sec % 60).toFixed(3).padStart(6, '0');\n  return `${m}:${s}`;\n}\n\n/* ===== component ===== */\nexport default function RaceLive({\n  raceConfig,\n  onStopRace\n}) {\n  _s();\n  var _circuit$stats, _circuit$params2, _statusColors$lbBorde;\n  const [serverState, setServerState] = useState(null); // circuito + summary iniziali\n  const [summary, setSummary] = useState(null); // aggiornato dal WS (classifica server-side)\n  const [raceStatus, setRaceStatus] = useState('IN CORSO'); // mirror lato client\n  const [pilotsIndex, setPilotsIndex] = useState({}); // pilotId -> pilot object\n  const canvasRef = useRef(null);\n  const zoomRef = useRef(1);\n  const panRef = useRef({\n    x: 0,\n    y: 0\n  });\n  const isDraggingRef = useRef(false);\n  const lastMouseRef = useRef({\n    x: 0,\n    y: 0\n  });\n  const animRef = useRef(null);\n  const dprRef = useRef(1);\n  const circuitRef = useRef(null);\n\n  // ===== fetch stato iniziale (se entro senza config locale) =====\n  useEffect(() => {\n    let alive = true;\n    const init = async () => {\n      if (raceConfig && raceConfig.serverMode) {\n        var _j$summary;\n        const r = await fetch(`${API_BASE}/api/race/state`);\n        const j = await r.json();\n        if (!alive) return;\n        if (!j.active) {\n          setServerState(null);\n          return;\n        }\n        setServerState(j);\n        setSummary(j.summary);\n        setRaceStatus(((_j$summary = j.summary) === null || _j$summary === void 0 ? void 0 : _j$summary.status) || 'IN CORSO');\n        setPilotsIndex(Object.fromEntries((j.pilots || []).map(p => [p.id, p])));\n        circuitRef.current = j.circuit;\n      } else {\n        // anche se raceConfig è null, provo comunque a joinare se c'è una gara\n        const r = await fetch(`${API_BASE}/api/race/state`);\n        const j = await r.json();\n        if (!alive) return;\n        if (j.active) {\n          var _j$summary2;\n          setServerState(j);\n          setSummary(j.summary);\n          setRaceStatus(((_j$summary2 = j.summary) === null || _j$summary2 === void 0 ? void 0 : _j$summary2.status) || 'IN CORSO');\n          setPilotsIndex(Object.fromEntries((j.pilots || []).map(p => [p.id, p])));\n          circuitRef.current = j.circuit;\n        }\n      }\n    };\n    init();\n    return () => {\n      alive = false;\n    };\n  }, [raceConfig]);\n\n  // ===== WebSocket: ricevo GPS per canvas + summary per classifica =====\n  useEffect(() => {\n    const ws = new WebSocket(WS_URL);\n    const driverPositions = {}; // mac -> {lat,lon,tag,color,teamLogo}\n\n    ws.onmessage = ev => {\n      try {\n        const msg = JSON.parse(ev.data);\n        if ((msg === null || msg === void 0 ? void 0 : msg.type) === 'race') {\n          var _msg$payload;\n          setSummary(msg.payload);\n          setRaceStatus(((_msg$payload = msg.payload) === null || _msg$payload === void 0 ? void 0 : _msg$payload.status) || 'IN CORSO');\n        } else if ((msg === null || msg === void 0 ? void 0 : msg.type) === 'gps' || msg !== null && msg !== void 0 && msg.mac && msg !== null && msg !== void 0 && msg.lat && msg !== null && msg !== void 0 && msg.lon) {\n          // memorizzo posizione corrente per il draw loop\n          const mac = msg.mac;\n          // Provo a recuperare info pilota dalla summary per mostrare tag e colore\n          const d = ((summary === null || summary === void 0 ? void 0 : summary.leaderboard) || []).find(x => x.mac === mac);\n          driverPositions[mac] = {\n            lat: msg.lat,\n            lon: msg.lon,\n            tag: (d === null || d === void 0 ? void 0 : d.tag) || 'PIL',\n            color: (d === null || d === void 0 ? void 0 : d.color) || '#C0FF03',\n            photoTeamUrl: (d === null || d === void 0 ? void 0 : d.photoTeamUrl) || null\n          };\n        }\n      } catch {}\n    };\n    ws.onerror = e => console.error('[WS]', e);\n\n    // ===== Canvas draw loop (solo render, niente calcoli di classifica) =====\n    const canvas = canvasRef.current;\n    if (!canvas) return () => ws.close();\n    const ctx = canvas.getContext('2d');\n    const dpr = window.devicePixelRatio || 1;\n    dprRef.current = dpr;\n    const ensureSize = () => {\n      const parent = canvas.parentElement;\n      const w = parent.clientWidth || 800;\n      const h = parent.clientHeight || 520;\n      if (canvas.width !== Math.floor(w * dpr) || canvas.height !== Math.floor(h * dpr)) {\n        canvas.width = Math.floor(w * dpr);\n        canvas.height = Math.floor(h * dpr);\n        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n      }\n    };\n    ensureSize();\n    const onResize = () => ensureSize();\n    window.addEventListener('resize', onResize);\n    const wheel = e => {\n      e.preventDefault();\n      zoomRef.current = Math.max(0.5, Math.min(5, zoomRef.current * (e.deltaY > 0 ? 0.9 : 1.1)));\n    };\n    const mousedown = e => {\n      isDraggingRef.current = true;\n      lastMouseRef.current = {\n        x: e.clientX,\n        y: e.clientY\n      };\n      canvas.style.cursor = 'grabbing';\n    };\n    const mousemove = e => {\n      if (!isDraggingRef.current) return;\n      const dx = e.clientX - lastMouseRef.current.x;\n      const dy = e.clientY - lastMouseRef.current.y;\n      panRef.current.x += dx;\n      panRef.current.y += dy;\n      lastMouseRef.current = {\n        x: e.clientX,\n        y: e.clientY\n      };\n    };\n    const mouseup = () => {\n      isDraggingRef.current = false;\n      canvas.style.cursor = 'grab';\n    };\n    canvas.addEventListener('wheel', wheel, {\n      passive: false\n    });\n    canvas.addEventListener('mousedown', mousedown);\n    canvas.addEventListener('mousemove', mousemove);\n    canvas.addEventListener('mouseup', mouseup);\n    canvas.addEventListener('mouseleave', mouseup);\n    canvas.style.cursor = 'grab';\n\n    // proiezione\n    const projectFactory = () => {\n      var _circuit$sectors;\n      const circuit = circuitRef.current;\n      if (!(circuit !== null && circuit !== void 0 && (_circuit$sectors = circuit.sectors) !== null && _circuit$sectors !== void 0 && _circuit$sectors.length)) return null;\n      const lats = circuit.sectors.map(s => s.lat);\n      const lons = circuit.sectors.map(s => s.lon);\n      const minLat = Math.min(...lats),\n        maxLat = Math.max(...lats);\n      const minLon = Math.min(...lons),\n        maxLon = Math.max(...lons);\n      const centerLat = (minLat + maxLat) / 2;\n      const centerLon = (minLon + maxLon) / 2;\n      const R = 6371000;\n      const centerLatRad = centerLat * Math.PI / 180;\n      const dxList = lons.map(l => (l - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad));\n      const dyList = lats.map(l => (l - centerLat) * Math.PI / 180 * R);\n      const maxDx = Math.max(...dxList.map(Math.abs));\n      const maxDy = Math.max(...dyList.map(Math.abs));\n      const padding = 40;\n      return (lat, lon, w, h) => {\n        const maxRange = Math.max(maxDx, maxDy) * 1.1;\n        const scale = Math.min(w - padding * 2, h - padding * 2) / (maxRange * 2) * zoomRef.current;\n        const dx = (lon - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad);\n        const dy = (lat - centerLat) * Math.PI / 180 * R;\n        const x = w / 2 + dx * scale + panRef.current.x;\n        const y = h / 2 - dy * scale + panRef.current.y;\n        return {\n          x,\n          y,\n          scale\n        };\n      };\n    };\n    let project = projectFactory();\n    const draw = () => {\n      var _circuit$sectors2;\n      ensureSize();\n      const circuit = circuitRef.current;\n      const w = canvas.width / dpr;\n      const h = canvas.height / dpr;\n      ctx.clearRect(0, 0, w, h);\n      ctx.fillStyle = '#0a0a0a';\n      ctx.fillRect(0, 0, w, h);\n      if (circuit !== null && circuit !== void 0 && (_circuit$sectors2 = circuit.sectors) !== null && _circuit$sectors2 !== void 0 && _circuit$sectors2.length) {\n        var _circuit$params$width, _circuit$params, _pts$;\n        if (!project) project = projectFactory();\n        const widthMeters = (_circuit$params$width = (_circuit$params = circuit.params) === null || _circuit$params === void 0 ? void 0 : _circuit$params.widthMeters) !== null && _circuit$params$width !== void 0 ? _circuit$params$width : 6;\n        const pts = circuit.sectors.map(s => project(s.lat, s.lon, w, h));\n        const scale = ((_pts$ = pts[0]) === null || _pts$ === void 0 ? void 0 : _pts$.scale) || 1;\n        const trackPx = Math.max(6, widthMeters * scale);\n        ctx.strokeStyle = 'rgba(255,255,255,0.10)';\n        ctx.lineWidth = trackPx + 4;\n        ctx.lineCap = 'round';\n        ctx.lineJoin = 'round';\n        ctx.beginPath();\n        pts.forEach((p, i) => i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y));\n        ctx.closePath();\n        ctx.stroke();\n        ctx.strokeStyle = 'rgba(80, 84, 90, 0.95)';\n        ctx.lineWidth = trackPx;\n        ctx.beginPath();\n        pts.forEach((p, i) => i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y));\n        ctx.closePath();\n        ctx.stroke();\n        if (pts.length > 1) {\n          const s0 = pts[0],\n            s1 = pts[1];\n          const ang = Math.atan2(s1.y - s0.y, s1.x - s0.x);\n          ctx.save();\n          ctx.translate(s0.x, s0.y);\n          ctx.rotate(ang);\n          ctx.strokeStyle = '#ffffff';\n          ctx.lineWidth = Math.max(2, trackPx * 0.12);\n          ctx.beginPath();\n          ctx.moveTo(0, -trackPx * 0.5);\n          ctx.lineTo(0, trackPx * 0.5);\n          ctx.stroke();\n          ctx.restore();\n        }\n      }\n\n      // markers piloti (posizioni arrivate via WS GPS)\n      const board = (summary === null || summary === void 0 ? void 0 : summary.leaderboard) || [];\n      Object.entries(driverPositions).forEach(([mac, pos]) => {\n        const p = project ? project(pos.lat, pos.lon, w, h) : null;\n        if (!p) return;\n        const teamCol = pos.color || '#C0FF03';\n        const r = Math.max(5, 6 * (zoomRef.current * 0.9));\n        ctx.shadowColor = 'rgba(0,0,0,0.5)';\n        ctx.shadowBlur = 4;\n        ctx.fillStyle = teamCol;\n        ctx.beginPath();\n        ctx.arc(p.x, p.y, r, 0, Math.PI * 2);\n        ctx.fill();\n        ctx.shadowBlur = 0;\n        ctx.strokeStyle = '#fff';\n        ctx.lineWidth = 2;\n        ctx.stroke();\n        ctx.fillStyle = '#fff';\n        ctx.font = 'bold 10px Roboto, sans-serif';\n        ctx.textAlign = 'center';\n        ctx.fillText((pos.tag || 'PIL').slice(0, 4), p.x, p.y - (r + 6));\n      });\n      animRef.current = requestAnimationFrame(draw);\n    };\n    draw();\n    return () => {\n      window.removeEventListener('resize', onResize);\n      canvas.removeEventListener('wheel', wheel);\n      canvas.removeEventListener('mousedown', mousedown);\n      canvas.removeEventListener('mousemove', mousemove);\n      canvas.removeEventListener('mouseup', mouseup);\n      canvas.removeEventListener('mouseleave', mouseup);\n      if (animRef.current) cancelAnimationFrame(animRef.current);\n      ws.close();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [summary === null || summary === void 0 ? void 0 : summary.leaderboard]);\n\n  // ===== controlli gara (status + sanzioni) =====\n  const [penPilot, setPenPilot] = useState('');\n  const [penType, setPenType] = useState('+5s');\n  const sendStatus = async s => {\n    try {\n      setRaceStatus(s);\n      await fetch(`${API_BASE}/api/race/status`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          status: s\n        })\n      });\n    } catch {}\n  };\n  const sendPenalty = async () => {\n    if (!penPilot) return;\n    try {\n      await fetch(`${API_BASE}/api/race/penalty`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          pilotId: penPilot,\n          type: penType\n        })\n      });\n      // il server aggiornerà la summary via WS; qui basta pulire\n      setPenPilot('');\n      setPenType('+5s');\n    } catch (e) {\n      console.error(e);\n    }\n  };\n  const statusColors = useMemo(() => {\n    switch (raceStatus) {\n      case 'RED FLAG':\n        return {\n          chipBg: 'rgba(225,6,0,.15)',\n          chipBorder: '#e10600',\n          chipText: '#ffdede',\n          lbBorder: '#e10600'\n        };\n      case 'YELLOW FLAG':\n        return {\n          chipBg: 'rgba(241,196,15,.15)',\n          chipBorder: '#f1c40f',\n          chipText: '#fff3c4',\n          lbBorder: '#f1c40f'\n        };\n      case 'FINITA':\n        return {\n          chipBg: 'rgba(154,163,154,.15)',\n          chipBorder: '#9aa39a',\n          chipText: '#e0e0e0',\n          lbBorder: '#9aa39a'\n        };\n      default:\n        return {\n          chipBg: 'rgba(21,193,48,.15)',\n          chipBorder: '#15c130',\n          chipText: '#e9ffe0',\n          lbBorder: null\n        };\n    }\n  }, [raceStatus]);\n\n  // ===== render =====\n  const circuit = serverState === null || serverState === void 0 ? void 0 : serverState.circuit;\n  const board = (summary === null || summary === void 0 ? void 0 : summary.leaderboard) || [];\n  const totalLaps = (summary === null || summary === void 0 ? void 0 : summary.totalLaps) || (serverState === null || serverState === void 0 ? void 0 : serverState.totalLaps) || 0;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main small-top\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"rs-live-topbar\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rs-live-left\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            gap: 8\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            \"aria-hidden\": true,\n            style: {\n              width: 10,\n              height: 10,\n              borderRadius: '50%',\n              background: '#ff4d4f',\n              boxShadow: '0 0 12px rgba(255,77,79,.8)',\n              animation: 'blink 1.2s infinite'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 13\n          }, this), \"LIVE\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          children: [totalLaps, \" giri\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          style: {\n            background: statusColors.chipBg,\n            border: `1px solid ${statusColors.chipBorder}`,\n            color: statusColors.chipText,\n            fontWeight: 800\n          },\n          children: raceStatus\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 287,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"rs-live-right\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          children: (circuit === null || circuit === void 0 ? void 0 : circuit.name) || 'Circuito'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 11\n        }, this), (circuit === null || circuit === void 0 ? void 0 : (_circuit$stats = circuit.stats) === null || _circuit$stats === void 0 ? void 0 : _circuit$stats.lengthMeters) && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          children: [circuit.stats.lengthMeters.toFixed(0), \" m\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 44\n        }, this), (circuit === null || circuit === void 0 ? void 0 : (_circuit$params2 = circuit.params) === null || _circuit$params2 === void 0 ? void 0 : _circuit$params2.widthMeters) && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          children: [circuit.params.widthMeters, \" m larghezza\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 44\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"rs-live-grid\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"track-card\",\n        children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n          ref: canvasRef,\n          className: \"track-canvas\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"leaderboard-card\",\n        style: {\n          borderColor: (_statusColors$lbBorde = statusColors.lbBorder) !== null && _statusColors$lbBorde !== void 0 ? _statusColors$lbBorde : 'var(--line)',\n          boxShadow: statusColors.lbBorder ? `0 8px 32px ${statusColors.lbBorder}33, inset 0 0 0 1px ${statusColors.lbBorder}55` : undefined\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lb-title\",\n            children: \"CLASSIFICA\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lb-sub\",\n            children: [board.length, \" piloti\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-list\",\n          children: board.map((d, idx) => {\n            const fastest = (summary === null || summary === void 0 ? void 0 : summary.bestLapOverall) && d.bestLapTime && d.bestLapTime === summary.bestLapOverall;\n            const gapText = idx === 0 ? 'LEADER' : typeof d.gap === 'string' ? `+${d.gap}` : `+${(d.gap || 0).toFixed(2)}`;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `lb-row ${idx === 0 ? 'lb-leader' : ''}`,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-pos\",\n                children: idx + 1\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 320,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-team\",\n                children: d.photoTeamUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: `${API_BASE}${d.photoTeamUrl}`,\n                  alt: \"\",\n                  className: \"lb-team-logo\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 322,\n                  columnNumber: 39\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"lb-team-color\",\n                  style: {\n                    background: d.color\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 323,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 321,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-name\",\n                children: (d.tag || 'PIL').slice(0, 4)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 325,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-gap\",\n                children: gapText\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 326,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-icons\",\n                children: [fastest && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"lb-icon purple\",\n                  children: \"\\u23F1\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 328,\n                  columnNumber: 33\n                }, this), d.penaltySeconds > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"lb-icon\",\n                  title: `${d.penaltySeconds}s penalità`,\n                  children: \"\\u26A0\\uFE0F\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 329,\n                  columnNumber: 46\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 327,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-lap\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"muted\",\n                  children: \"Lap\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 331,\n                  columnNumber: 43\n                }, this), \"\\xA0\", d.lapCount, \"/\", totalLaps]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 331,\n                columnNumber: 19\n              }, this)]\n            }, d.mac, true, {\n              fileName: _jsxFileName,\n              lineNumber: 319,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"leaderboard-card\",\n      style: {\n        marginTop: 12\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lb-header\",\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'baseline'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-title\",\n          children: \"CLASSIFICA DETTAGLIATA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lb-sub\",\n          children: [board.length, \" piloti \\u2022 ultimo giro e best\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lb-list\",\n        children: board.map((d, idx) => {\n          const fastest = (summary === null || summary === void 0 ? void 0 : summary.bestLapOverall) && d.bestLapTime && d.bestLapTime === summary.bestLapOverall;\n          const pen = d.penaltySeconds || 0;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lb-row\",\n            style: {\n              gridTemplateColumns: '28px 28px 1fr 90px 110px 110px 110px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-pos\",\n              children: idx + 1\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 351,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-team\",\n              children: d.photoTeamUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n                src: `${API_BASE}${d.photoTeamUrl}`,\n                alt: \"\",\n                className: \"lb-team-logo\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 353,\n                columnNumber: 37\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"lb-team-color\",\n                style: {\n                  background: d.color\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 354,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 352,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-name\",\n              children: (d.tag || 'PIL').slice(0, 4)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 356,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              style: {\n                textAlign: 'right'\n              },\n              children: idx === 0 ? 'LEADER' : typeof d.gap === 'string' ? `+${d.gap}` : `+${(d.gap || 0).toFixed(2)}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 357,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              title: \"Ultimo giro\",\n              style: {\n                fontWeight: 700\n              },\n              children: formatLap(d.lastLapTime)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              title: \"Miglior giro\",\n              style: {\n                fontWeight: 700,\n                color: fastest ? '#b085ff' : 'inherit'\n              },\n              children: [formatLap(d.bestLapTime), fastest && /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"lb-icon purple\",\n                style: {\n                  marginLeft: 6\n                },\n                children: \"\\u23F1\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 362,\n                columnNumber: 57\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lb-gap\",\n              title: \"Penalit\\xE0\",\n              style: {\n                fontWeight: 700\n              },\n              children: pen > 0 ? `+${pen}s` : '—'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 364,\n              columnNumber: 17\n            }, this)]\n          }, `wide-${d.mac}`, true, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 345,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pilot-form\",\n      style: {\n        marginTop: 12\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"section-title\",\n        style: {\n          marginBottom: 10\n        },\n        children: \"COMANDI GARA\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 375,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          flexWrap: 'wrap',\n          gap: 8,\n          alignItems: 'center',\n          marginBottom: 10\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"muted\",\n          children: \"Stato:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 379,\n          columnNumber: 11\n        }, this), ['IN CORSO', 'FINITA', 'RED FLAG', 'YELLOW FLAG'].map(s => /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-ghost\",\n          onClick: () => sendStatus(s),\n          style: {\n            borderColor: raceStatus === s ? 'rgba(192,255,3,0.6)' : 'var(--line)',\n            boxShadow: raceStatus === s ? '0 0 0 2px rgba(192,255,3,0.12) inset' : 'none',\n            fontWeight: 700\n          },\n          children: s\n        }, s, false, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 378,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          flexWrap: 'wrap',\n          gap: 8,\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"muted\",\n          children: \"Sanzione:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 395,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          className: \"input\",\n          style: {\n            maxWidth: 260\n          },\n          value: penPilot,\n          onChange: e => setPenPilot(e.target.value),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"\",\n            children: \"-- Pilota --\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 397,\n            columnNumber: 13\n          }, this), ((serverState === null || serverState === void 0 ? void 0 : serverState.pilots) || []).map(p => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: p.id,\n            children: [p.name, \" \", p.surname, \" (\", p.team, \")\"]\n          }, p.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 399,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 396,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          className: \"input\",\n          style: {\n            maxWidth: 220\n          },\n          value: penType,\n          onChange: e => setPenType(e.target.value),\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"+5s\",\n            children: \"+5s\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 403,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"+10s\",\n            children: \"+10s\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"+15s\",\n            children: \"+15s\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 405,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"1mo avv. squalifica\",\n            children: \"1mo avv. squalifica\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 406,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"squalifica\",\n            children: \"squalifica\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 407,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 402,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-primary\",\n          onClick: sendPenalty,\n          disabled: !penPilot,\n          children: \"Applica\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 409,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginLeft: 'auto'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn-danger\",\n            onClick: async () => {\n              await fetch(`${API_BASE}/api/race/stop`, {\n                method: 'POST'\n              }).catch(() => {});\n              onStopRace();\n            },\n            children: \"Termina gara\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 412,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 275,\n    columnNumber: 5\n  }, this);\n}\n_s(RaceLive, \"8OErzUE/ZMceG76Bm87Ofy4xyeo=\");\n_c = RaceLive;\nvar _c;\n$RefreshReg$(_c, \"RaceLive\");","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","jsxDEV","_jsxDEV","API_BASE","process","env","REACT_APP_API_BASE","window","location","hostname","WS_URL","REACT_APP_WS_URL","formatLap","sec","m","Math","floor","s","toFixed","padStart","RaceLive","raceConfig","onStopRace","_s","_circuit$stats","_circuit$params2","_statusColors$lbBorde","serverState","setServerState","summary","setSummary","raceStatus","setRaceStatus","pilotsIndex","setPilotsIndex","canvasRef","zoomRef","panRef","x","y","isDraggingRef","lastMouseRef","animRef","dprRef","circuitRef","alive","init","serverMode","_j$summary","r","fetch","j","json","active","status","Object","fromEntries","pilots","map","p","id","current","circuit","_j$summary2","ws","WebSocket","driverPositions","onmessage","ev","msg","JSON","parse","data","type","_msg$payload","payload","mac","lat","lon","d","leaderboard","find","tag","color","photoTeamUrl","onerror","e","console","error","canvas","close","ctx","getContext","dpr","devicePixelRatio","ensureSize","parent","parentElement","w","clientWidth","h","clientHeight","width","height","setTransform","onResize","addEventListener","wheel","preventDefault","max","min","deltaY","mousedown","clientX","clientY","style","cursor","mousemove","dx","dy","mouseup","passive","projectFactory","_circuit$sectors","sectors","length","lats","lons","minLat","maxLat","minLon","maxLon","centerLat","centerLon","R","centerLatRad","PI","dxList","l","cos","dyList","maxDx","abs","maxDy","padding","maxRange","scale","project","draw","_circuit$sectors2","clearRect","fillStyle","fillRect","_circuit$params$width","_circuit$params","_pts$","widthMeters","params","pts","trackPx","strokeStyle","lineWidth","lineCap","lineJoin","beginPath","forEach","i","lineTo","moveTo","closePath","stroke","s0","s1","ang","atan2","save","translate","rotate","restore","board","entries","pos","teamCol","shadowColor","shadowBlur","arc","fill","font","textAlign","fillText","slice","requestAnimationFrame","removeEventListener","cancelAnimationFrame","penPilot","setPenPilot","penType","setPenType","sendStatus","method","headers","body","stringify","sendPenalty","pilotId","statusColors","chipBg","chipBorder","chipText","lbBorder","totalLaps","className","children","display","alignItems","gap","borderRadius","background","boxShadow","animation","fileName","_jsxFileName","lineNumber","columnNumber","border","fontWeight","name","stats","lengthMeters","ref","borderColor","undefined","idx","fastest","bestLapOverall","bestLapTime","gapText","src","alt","penaltySeconds","title","lapCount","marginTop","justifyContent","pen","gridTemplateColumns","lastLapTime","marginLeft","marginBottom","flexWrap","onClick","maxWidth","value","onChange","target","surname","team","disabled","catch","_c","$RefreshReg$"],"sources":["/home/ubuntu/racesense/racesense-frontend/src/pages/RaceLive.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from 'react';\nimport '../App.css';\n\nconst API_BASE = process.env.REACT_APP_API_BASE || `http://${window.location.hostname}:5000`;\nconst WS_URL = process.env.REACT_APP_WS_URL || `ws://${window.location.hostname}:5001`;\n\n/* ===== utils ===== */\nfunction formatLap(sec) {\n  if (!sec && sec !== 0) return '—';\n  const m = Math.floor(sec / 60);\n  const s = (sec % 60).toFixed(3).padStart(6, '0');\n  return `${m}:${s}`;\n}\n\n/* ===== component ===== */\nexport default function RaceLive({ raceConfig, onStopRace }) {\n  const [serverState, setServerState] = useState(null);       // circuito + summary iniziali\n  const [summary, setSummary] = useState(null);               // aggiornato dal WS (classifica server-side)\n  const [raceStatus, setRaceStatus] = useState('IN CORSO');   // mirror lato client\n  const [pilotsIndex, setPilotsIndex] = useState({});         // pilotId -> pilot object\n  const canvasRef = useRef(null);\n  const zoomRef = useRef(1);\n  const panRef = useRef({ x: 0, y: 0 });\n  const isDraggingRef = useRef(false);\n  const lastMouseRef = useRef({ x: 0, y: 0 });\n  const animRef = useRef(null);\n  const dprRef = useRef(1);\n  const circuitRef = useRef(null);\n\n  // ===== fetch stato iniziale (se entro senza config locale) =====\n  useEffect(() => {\n    let alive = true;\n    const init = async () => {\n      if (raceConfig && raceConfig.serverMode) {\n        const r = await fetch(`${API_BASE}/api/race/state`);\n        const j = await r.json();\n        if (!alive) return;\n        if (!j.active) {\n          setServerState(null);\n          return;\n        }\n        setServerState(j);\n        setSummary(j.summary);\n        setRaceStatus(j.summary?.status || 'IN CORSO');\n        setPilotsIndex(Object.fromEntries((j.pilots || []).map(p => [p.id, p])));\n        circuitRef.current = j.circuit;\n      } else {\n        // anche se raceConfig è null, provo comunque a joinare se c'è una gara\n        const r = await fetch(`${API_BASE}/api/race/state`);\n        const j = await r.json();\n        if (!alive) return;\n        if (j.active) {\n          setServerState(j);\n          setSummary(j.summary);\n          setRaceStatus(j.summary?.status || 'IN CORSO');\n          setPilotsIndex(Object.fromEntries((j.pilots || []).map(p => [p.id, p])));\n          circuitRef.current = j.circuit;\n        }\n      }\n    };\n    init();\n    return () => { alive = false; };\n  }, [raceConfig]);\n\n  // ===== WebSocket: ricevo GPS per canvas + summary per classifica =====\n  useEffect(() => {\n    const ws = new WebSocket(WS_URL);\n    const driverPositions = {}; // mac -> {lat,lon,tag,color,teamLogo}\n\n    ws.onmessage = (ev) => {\n      try {\n        const msg = JSON.parse(ev.data);\n        if (msg?.type === 'race') {\n          setSummary(msg.payload);\n          setRaceStatus(msg.payload?.status || 'IN CORSO');\n        } else if (msg?.type === 'gps' || (msg?.mac && msg?.lat && msg?.lon)) {\n          // memorizzo posizione corrente per il draw loop\n          const mac = msg.mac;\n          // Provo a recuperare info pilota dalla summary per mostrare tag e colore\n          const d = (summary?.leaderboard || []).find(x => x.mac === mac);\n          driverPositions[mac] = {\n            lat: msg.lat, lon: msg.lon,\n            tag: d?.tag || 'PIL',\n            color: d?.color || '#C0FF03',\n            photoTeamUrl: d?.photoTeamUrl || null\n          };\n        }\n      } catch { }\n    };\n    ws.onerror = e => console.error('[WS]', e);\n\n    // ===== Canvas draw loop (solo render, niente calcoli di classifica) =====\n    const canvas = canvasRef.current;\n    if (!canvas) return () => ws.close();\n    const ctx = canvas.getContext('2d');\n    const dpr = window.devicePixelRatio || 1;\n    dprRef.current = dpr;\n\n    const ensureSize = () => {\n      const parent = canvas.parentElement;\n      const w = parent.clientWidth || 800;\n      const h = parent.clientHeight || 520;\n      if (canvas.width !== Math.floor(w * dpr) || canvas.height !== Math.floor(h * dpr)) {\n        canvas.width = Math.floor(w * dpr);\n        canvas.height = Math.floor(h * dpr);\n        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\n      }\n    };\n    ensureSize();\n    const onResize = () => ensureSize();\n    window.addEventListener('resize', onResize);\n\n    const wheel = (e) => { e.preventDefault(); zoomRef.current = Math.max(0.5, Math.min(5, zoomRef.current * (e.deltaY > 0 ? 0.9 : 1.1))); };\n    const mousedown = (e) => { isDraggingRef.current = true; lastMouseRef.current = { x: e.clientX, y: e.clientY }; canvas.style.cursor = 'grabbing'; };\n    const mousemove = (e) => {\n      if (!isDraggingRef.current) return;\n      const dx = e.clientX - lastMouseRef.current.x;\n      const dy = e.clientY - lastMouseRef.current.y;\n      panRef.current.x += dx; panRef.current.y += dy;\n      lastMouseRef.current = { x: e.clientX, y: e.clientY };\n    };\n    const mouseup = () => { isDraggingRef.current = false; canvas.style.cursor = 'grab'; };\n    canvas.addEventListener('wheel', wheel, { passive: false });\n    canvas.addEventListener('mousedown', mousedown);\n    canvas.addEventListener('mousemove', mousemove);\n    canvas.addEventListener('mouseup', mouseup);\n    canvas.addEventListener('mouseleave', mouseup);\n    canvas.style.cursor = 'grab';\n\n    // proiezione\n    const projectFactory = () => {\n      const circuit = circuitRef.current;\n      if (!circuit?.sectors?.length) return null;\n      const lats = circuit.sectors.map(s => s.lat);\n      const lons = circuit.sectors.map(s => s.lon);\n      const minLat = Math.min(...lats), maxLat = Math.max(...lats);\n      const minLon = Math.min(...lons), maxLon = Math.max(...lons);\n      const centerLat = (minLat + maxLat) / 2;\n      const centerLon = (minLon + maxLon) / 2;\n      const R = 6371000;\n      const centerLatRad = centerLat * Math.PI / 180;\n      const dxList = lons.map(l => (l - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad));\n      const dyList = lats.map(l => (l - centerLat) * Math.PI / 180 * R);\n      const maxDx = Math.max(...dxList.map(Math.abs));\n      const maxDy = Math.max(...dyList.map(Math.abs));\n      const padding = 40;\n      return (lat, lon, w, h) => {\n        const maxRange = Math.max(maxDx, maxDy) * 1.1;\n        const scale = Math.min(w - padding * 2, h - padding * 2) / (maxRange * 2) * zoomRef.current;\n        const dx = (lon - centerLon) * Math.PI / 180 * R * Math.cos(centerLatRad);\n        const dy = (lat - centerLat) * Math.PI / 180 * R;\n        const x = w / 2 + dx * scale + panRef.current.x;\n        const y = h / 2 - dy * scale + panRef.current.y;\n        return { x, y, scale };\n      };\n    };\n    let project = projectFactory();\n\n    const draw = () => {\n      ensureSize();\n      const circuit = circuitRef.current;\n      const w = canvas.width / dpr;\n      const h = canvas.height / dpr;\n      ctx.clearRect(0, 0, w, h);\n      ctx.fillStyle = '#0a0a0a';\n      ctx.fillRect(0, 0, w, h);\n\n      if (circuit?.sectors?.length) {\n        if (!project) project = projectFactory();\n\n        const widthMeters = circuit.params?.widthMeters ?? 6;\n        const pts = circuit.sectors.map(s => project(s.lat, s.lon, w, h));\n        const scale = pts[0]?.scale || 1;\n        const trackPx = Math.max(6, widthMeters * scale);\n\n        ctx.strokeStyle = 'rgba(255,255,255,0.10)';\n        ctx.lineWidth = trackPx + 4;\n        ctx.lineCap = 'round';\n        ctx.lineJoin = 'round';\n        ctx.beginPath();\n        pts.forEach((p, i) => i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y));\n        ctx.closePath(); ctx.stroke();\n\n        ctx.strokeStyle = 'rgba(80, 84, 90, 0.95)';\n        ctx.lineWidth = trackPx;\n        ctx.beginPath();\n        pts.forEach((p, i) => i ? ctx.lineTo(p.x, p.y) : ctx.moveTo(p.x, p.y));\n        ctx.closePath(); ctx.stroke();\n\n        if (pts.length > 1) {\n          const s0 = pts[0], s1 = pts[1];\n          const ang = Math.atan2(s1.y - s0.y, s1.x - s0.x);\n          ctx.save(); ctx.translate(s0.x, s0.y); ctx.rotate(ang);\n          ctx.strokeStyle = '#ffffff';\n          ctx.lineWidth = Math.max(2, trackPx * 0.12);\n          ctx.beginPath(); ctx.moveTo(0, -trackPx * 0.5); ctx.lineTo(0, trackPx * 0.5); ctx.stroke();\n          ctx.restore();\n        }\n      }\n\n      // markers piloti (posizioni arrivate via WS GPS)\n      const board = summary?.leaderboard || [];\n      Object.entries(driverPositions).forEach(([mac, pos]) => {\n        const p = project ? project(pos.lat, pos.lon, w, h) : null;\n        if (!p) return;\n        const teamCol = pos.color || '#C0FF03';\n        const r = Math.max(5, 6 * (zoomRef.current * 0.9));\n        ctx.shadowColor = 'rgba(0,0,0,0.5)'; ctx.shadowBlur = 4;\n        ctx.fillStyle = teamCol; ctx.beginPath(); ctx.arc(p.x, p.y, r, 0, Math.PI * 2); ctx.fill();\n        ctx.shadowBlur = 0; ctx.strokeStyle = '#fff'; ctx.lineWidth = 2; ctx.stroke();\n        ctx.fillStyle = '#fff'; ctx.font = 'bold 10px Roboto, sans-serif'; ctx.textAlign = 'center';\n        ctx.fillText((pos.tag || 'PIL').slice(0, 4), p.x, p.y - (r + 6));\n      });\n\n      animRef.current = requestAnimationFrame(draw);\n    };\n    draw();\n\n    return () => {\n      window.removeEventListener('resize', onResize);\n      canvas.removeEventListener('wheel', wheel);\n      canvas.removeEventListener('mousedown', mousedown);\n      canvas.removeEventListener('mousemove', mousemove);\n      canvas.removeEventListener('mouseup', mouseup);\n      canvas.removeEventListener('mouseleave', mouseup);\n      if (animRef.current) cancelAnimationFrame(animRef.current);\n      ws.close();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [summary?.leaderboard]);\n\n  // ===== controlli gara (status + sanzioni) =====\n  const [penPilot, setPenPilot] = useState('');\n  const [penType, setPenType] = useState('+5s');\n\n  const sendStatus = async (s) => {\n    try {\n      setRaceStatus(s);\n      await fetch(`${API_BASE}/api/race/status`, {\n        method: 'POST', headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ status: s })\n      });\n    } catch { }\n  };\n  const sendPenalty = async () => {\n    if (!penPilot) return;\n    try {\n      await fetch(`${API_BASE}/api/race/penalty`, {\n        method: 'POST', headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ pilotId: penPilot, type: penType })\n      });\n      // il server aggiornerà la summary via WS; qui basta pulire\n      setPenPilot('');\n      setPenType('+5s');\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  const statusColors = useMemo(() => {\n    switch (raceStatus) {\n      case 'RED FLAG': return { chipBg: 'rgba(225,6,0,.15)', chipBorder: '#e10600', chipText: '#ffdede', lbBorder: '#e10600' };\n      case 'YELLOW FLAG': return { chipBg: 'rgba(241,196,15,.15)', chipBorder: '#f1c40f', chipText: '#fff3c4', lbBorder: '#f1c40f' };\n      case 'FINITA': return { chipBg: 'rgba(154,163,154,.15)', chipBorder: '#9aa39a', chipText: '#e0e0e0', lbBorder: '#9aa39a' };\n      default: return { chipBg: 'rgba(21,193,48,.15)', chipBorder: '#15c130', chipText: '#e9ffe0', lbBorder: null };\n    }\n  }, [raceStatus]);\n\n  // ===== render =====\n  const circuit = serverState?.circuit;\n  const board = summary?.leaderboard || [];\n  const totalLaps = summary?.totalLaps || serverState?.totalLaps || 0;\n\n  return (\n    <div className=\"main small-top\">\n      {/* Top bar */}\n      <div className=\"rs-live-topbar\">\n        <div className=\"rs-live-left\">\n          <span className=\"chip readonly\" style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n            <span aria-hidden style={{\n              width: 10, height: 10, borderRadius: '50%', background: '#ff4d4f',\n              boxShadow: '0 0 12px rgba(255,77,79,.8)', animation: 'blink 1.2s infinite'\n            }} />\n            LIVE\n          </span>\n          <span className=\"chip readonly\">{totalLaps} giri</span>\n          <span className=\"chip readonly\" style={{\n            background: statusColors.chipBg, border: `1px solid ${statusColors.chipBorder}`,\n            color: statusColors.chipText, fontWeight: 800\n          }}>{raceStatus}</span>\n        </div>\n        <div className=\"rs-live-right\">\n          <span className=\"chip readonly\">{circuit?.name || 'Circuito'}</span>\n          {circuit?.stats?.lengthMeters && <span className=\"chip readonly\">{circuit.stats.lengthMeters.toFixed(0)} m</span>}\n          {circuit?.params?.widthMeters && <span className=\"chip readonly\">{circuit.params.widthMeters} m larghezza</span>}\n        </div>\n      </div>\n\n      {/* Griglia principale */}\n      <div className=\"rs-live-grid\">\n        <div className=\"track-card\">\n          <canvas ref={canvasRef} className=\"track-canvas\" />\n        </div>\n\n        {/* classifica laterale (server-side) */}\n        <div className=\"leaderboard-card\" style={{\n          borderColor: statusColors.lbBorder ?? 'var(--line)',\n          boxShadow: statusColors.lbBorder ? `0 8px 32px ${statusColors.lbBorder}33, inset 0 0 0 1px ${statusColors.lbBorder}55` : undefined\n        }}>\n          <div className=\"lb-header\">\n            <div className=\"lb-title\">CLASSIFICA</div>\n            <div className=\"lb-sub\">{board.length} piloti</div>\n          </div>\n          <div className=\"lb-list\">\n            {board.map((d, idx) => {\n              const fastest = summary?.bestLapOverall && d.bestLapTime && d.bestLapTime === summary.bestLapOverall;\n              const gapText = idx === 0 ? 'LEADER' : (typeof d.gap === 'string' ? `+${d.gap}` : `+${(d.gap || 0).toFixed(2)}`);\n              return (\n                <div key={d.mac} className={`lb-row ${idx === 0 ? 'lb-leader' : ''}`}>\n                  <div className=\"lb-pos\">{idx + 1}</div>\n                  <div className=\"lb-team\">\n                    {d.photoTeamUrl ? <img src={`${API_BASE}${d.photoTeamUrl}`} alt=\"\" className=\"lb-team-logo\" /> :\n                      <div className=\"lb-team-color\" style={{ background: d.color }} />}\n                  </div>\n                  <div className=\"lb-name\">{(d.tag || 'PIL').slice(0, 4)}</div>\n                  <div className=\"lb-gap\">{gapText}</div>\n                  <div className=\"lb-icons\">\n                    {fastest && <span className=\"lb-icon purple\">⏱</span>}\n                    {d.penaltySeconds > 0 && <span className=\"lb-icon\" title={`${d.penaltySeconds}s penalità`}>⚠️</span>}\n                  </div>\n                  <div className=\"lb-lap\"><span className=\"muted\">Lap</span>&nbsp;{d.lapCount}/{totalLaps}</div>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      </div>\n\n      {/* Classifica full-width con tempi + penalità */}\n      <div className=\"leaderboard-card\" style={{ marginTop: 12 }}>\n        <div className=\"lb-header\" style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'baseline' }}>\n          <div className=\"lb-title\">CLASSIFICA DETTAGLIATA</div>\n          <div className=\"lb-sub\">{board.length} piloti • ultimo giro e best</div>\n        </div>\n        <div className=\"lb-list\">\n          {board.map((d, idx) => {\n            const fastest = summary?.bestLapOverall && d.bestLapTime && d.bestLapTime === summary.bestLapOverall;\n            const pen = d.penaltySeconds || 0;\n            return (\n              <div key={`wide-${d.mac}`} className=\"lb-row\" style={{ gridTemplateColumns: '28px 28px 1fr 90px 110px 110px 110px' }}>\n                <div className=\"lb-pos\">{idx + 1}</div>\n                <div className=\"lb-team\">\n                  {d.photoTeamUrl ? <img src={`${API_BASE}${d.photoTeamUrl}`} alt=\"\" className=\"lb-team-logo\" /> :\n                    <div className=\"lb-team-color\" style={{ background: d.color }} />}\n                </div>\n                <div className=\"lb-name\">{(d.tag || 'PIL').slice(0, 4)}</div>\n                <div className=\"lb-gap\" style={{ textAlign: 'right' }}>\n                  {idx === 0 ? 'LEADER' : (typeof d.gap === 'string' ? `+${d.gap}` : `+${(d.gap || 0).toFixed(2)}`)}\n                </div>\n                <div className=\"lb-gap\" title=\"Ultimo giro\" style={{ fontWeight: 700 }}>{formatLap(d.lastLapTime)}</div>\n                <div className=\"lb-gap\" title=\"Miglior giro\" style={{ fontWeight: 700, color: fastest ? '#b085ff' : 'inherit' }}>\n                  {formatLap(d.bestLapTime)}{fastest && <span className=\"lb-icon purple\" style={{ marginLeft: 6 }}>⏱</span>}\n                </div>\n                <div className=\"lb-gap\" title=\"Penalità\" style={{ fontWeight: 700 }}>\n                  {pen > 0 ? `+${pen}s` : '—'}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* ===== COMANDI GARA ===== */}\n      <div className=\"pilot-form\" style={{ marginTop: 12 }}>\n        <h3 className=\"section-title\" style={{ marginBottom: 10 }}>COMANDI GARA</h3>\n\n        {/* riga 1: stato gara */}\n        <div style={{ display: 'flex', flexWrap: 'wrap', gap: 8, alignItems: 'center', marginBottom: 10 }}>\n          <span className=\"muted\">Stato:</span>\n          {['IN CORSO', 'FINITA', 'RED FLAG', 'YELLOW FLAG'].map(s => (\n            <button key={s} className=\"btn-ghost\"\n              onClick={() => sendStatus(s)}\n              style={{\n                borderColor: raceStatus === s ? 'rgba(192,255,3,0.6)' : 'var(--line)',\n                boxShadow: raceStatus === s ? '0 0 0 2px rgba(192,255,3,0.12) inset' : 'none',\n                fontWeight: 700\n              }}>\n              {s}\n            </button>\n          ))}\n        </div>\n\n        {/* riga 2: sanzioni */}\n        <div style={{ display: 'flex', flexWrap: 'wrap', gap: 8, alignItems: 'center' }}>\n          <span className=\"muted\">Sanzione:</span>\n          <select className=\"input\" style={{ maxWidth: 260 }} value={penPilot} onChange={e => setPenPilot(e.target.value)}>\n            <option value=\"\">-- Pilota --</option>\n            {(serverState?.pilots || []).map(p => (\n              <option key={p.id} value={p.id}>{p.name} {p.surname} ({p.team})</option>\n            ))}\n          </select>\n          <select className=\"input\" style={{ maxWidth: 220 }} value={penType} onChange={e => setPenType(e.target.value)}>\n            <option value=\"+5s\">+5s</option>\n            <option value=\"+10s\">+10s</option>\n            <option value=\"+15s\">+15s</option>\n            <option value=\"1mo avv. squalifica\">1mo avv. squalifica</option>\n            <option value=\"squalifica\">squalifica</option>\n          </select>\n          <button className=\"btn-primary\" onClick={sendPenalty} disabled={!penPilot}>Applica</button>\n\n          <div style={{ marginLeft: 'auto' }}>\n            <button className=\"btn-danger\" onClick={async () => {\n              await fetch(`${API_BASE}/api/race/stop`, { method: 'POST' }).catch(() => { });\n              onStopRace();\n            }}>Termina gara</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}