{"ast":null,"code":"var _jsxFileName = \"/home/ubuntu/racesense/racesense-frontend/src/pages/RaceSetup.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport '../App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE = process.env.REACT_APP_API_BASE || `http://${window.location.hostname}:5000`;\n\n/* ========= WebSocket URL coerente con http/https ========= */\n/* ========= WebSocket URL coerente con http/https e stessa porta dell'API ========= */\nconst makeWsUrl = () => {\n  if (process.env.REACT_APP_WS_URL) return process.env.REACT_APP_WS_URL; // opzionale override\n  const proto = window.location.protocol === 'https:' ? 'wss' : 'ws';\n  // window.location.host include già hostname + :porta\n  return `${proto}://${window.location.host}/ws`;\n};\nconst WS_URL = makeWsUrl();\n\n/* ========= Hook: WebSocket affidabile con auto-reconnect ========= */\nfunction useReliableWebSocket(url, {\n  onMessage,\n  onOpen,\n  onError\n} = {}) {\n  _s();\n  const wsRef = React.useRef(null);\n  const aliveRef = React.useRef(true);\n  const retryRef = React.useRef(0);\n  React.useEffect(() => {\n    aliveRef.current = true;\n    const connect = () => {\n      if (!aliveRef.current) return;\n      try {\n        const ws = new WebSocket(url);\n        wsRef.current = ws;\n        ws.onopen = e => {\n          retryRef.current = 0;\n          onOpen && onOpen(e);\n        };\n        ws.onmessage = e => onMessage && onMessage(e);\n        ws.onerror = e => onError && onError(e);\n        ws.onclose = () => {\n          if (!aliveRef.current) return;\n          const delay = Math.min(1000 * 2 ** retryRef.current, 10000);\n          retryRef.current += 1;\n          setTimeout(connect, delay);\n        };\n      } catch {\n        const delay = Math.min(1000 * 2 ** retryRef.current, 10000);\n        retryRef.current += 1;\n        setTimeout(connect, delay);\n      }\n    };\n    connect();\n    return () => {\n      aliveRef.current = false;\n      try {\n        const ws = wsRef.current;\n        if (ws && (ws.readyState === WebSocket.OPEN || ws.readyState === WebSocket.CONNECTING)) {\n          ws.close();\n        }\n      } catch {}\n    };\n  }, [url, onMessage, onOpen, onError]);\n  return wsRef;\n}\n_s(useReliableWebSocket, \"iFhBiEiu1yKOD3cu3g/02F8KEsM=\");\nexport default function RaceSetup({\n  onStartRace\n}) {\n  _s2();\n  const [circuits, setCircuits] = useState([]);\n  const [pilots, setPilots] = useState([]);\n  const [selectedCircuit, setSelectedCircuit] = useState(null);\n  const [circuitData, setCircuitData] = useState(null);\n  const [totalLaps, setTotalLaps] = useState(10);\n\n  // Device attivi e assegnazioni (pilotId SALVATO COME STRINGA)\n  const [activeDevices, setActiveDevices] = useState({});\n  const [deviceAssignments, setDeviceAssignments] = useState({});\n  const deviceTimeoutRef = useRef({});\n\n  // --- Carica circuiti e piloti ---\n  useEffect(() => {\n    fetch(`${API_BASE}/api/circuits`).then(r => r.json()).then(setCircuits).catch(e => console.error('Errore caricamento circuiti:', e));\n    fetch(`${API_BASE}/api/pilots`).then(r => r.json()).then(setPilots).catch(e => console.error('Errore caricamento piloti:', e));\n  }, []);\n\n  // --- Dettagli circuito selezionato ---\n  useEffect(() => {\n    if (!selectedCircuit) return;\n    fetch(`${API_BASE}/api/circuits/${selectedCircuit}`).then(r => r.json()).then(setCircuitData).catch(e => console.error('Errore caricamento circuito:', e));\n  }, [selectedCircuit]);\n\n  // --- WebSocket per device attivi (affidabile) ---\n  useReliableWebSocket(WS_URL, {\n    onOpen: () => console.log('[RaceSetup] WS connesso'),\n    onError: e => console.error('[RaceSetup] WS errore', e),\n    onMessage: event => {\n      try {\n        const data = JSON.parse(event.data);\n        const pkt = (data === null || data === void 0 ? void 0 : data.type) === 'gps' ? data.payload || data : data;\n        if (pkt.mac && pkt.lat && pkt.lon) {\n          const mac = String(pkt.mac);\n          const lat = Number(pkt.lat);\n          const lon = Number(pkt.lon);\n          const speed = Number(pkt.speedKmh || 0);\n          setActiveDevices(prev => ({\n            ...prev,\n            [mac]: {\n              lastSeen: Date.now(),\n              lat,\n              lon,\n              speed,\n              data: pkt\n            }\n          }));\n          if (deviceTimeoutRef.current[mac]) clearTimeout(deviceTimeoutRef.current[mac]);\n          deviceTimeoutRef.current[mac] = setTimeout(() => {\n            setActiveDevices(prev => {\n              const copy = {\n                ...prev\n              };\n              delete copy[mac];\n              return copy;\n            });\n          }, 6000);\n        }\n      } catch (err) {\n        console.error('Errore parsing GPS:', err);\n      }\n    }\n  });\n\n  // --- Assegna pilota: mantengo SEMPRE stringa ---\n  const assignPilotToDevice = (mac, pilotIdString) => {\n    setDeviceAssignments(prev => ({\n      ...prev,\n      [mac]: pilotIdString\n    }));\n  };\n\n  // --- Avvio gara ---\n  const handleStart = () => {\n    if (!selectedCircuit) return alert('ATTENZIONE: seleziona un circuito!');\n    const assignedDevices = Object.keys(deviceAssignments).filter(mac => deviceAssignments[mac]);\n    if (assignedDevices.length === 0) return alert('ATTENZIONE: assegna almeno un pilota a un device attivo!');\n    const selectedPilotIds = Object.values(deviceAssignments).filter(Boolean); // stringhe\n    const selectedPilots = pilots.filter(p => selectedPilotIds.includes(String(p.id)));\n    const raceConfig = {\n      circuit: selectedCircuit,\n      circuitData,\n      totalLaps,\n      assignments: deviceAssignments,\n      // { MAC: 'pilotId' }\n      pilots: selectedPilots,\n      activeDevices: assignedDevices\n    };\n    onStartRace(raceConfig);\n  };\n  const activeMacs = Object.keys(activeDevices);\n  const assignedCount = Object.values(deviceAssignments).filter(Boolean).length;\n  const canStart = Boolean(selectedCircuit) && assignedCount > 0;\n  const selectedStyle = {\n    borderColor: 'rgba(192, 255, 3, 0.55)',\n    boxShadow: '0 0 24px rgba(192,255,3,0.25)'\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main small-top\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"section-title\",\n      style: {\n        marginBottom: 8\n      },\n      children: \"Configurazione Gara\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"subtitle\",\n      style: {\n        marginTop: 0,\n        marginBottom: 24\n      },\n      children: \"Seleziona il circuito, assegna i piloti ai device e imposta i giri.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      style: {\n        marginBottom: 28\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"section-title\",\n        children: \"Circuito\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"actions\",\n        style: {\n          marginBottom: 16\n        },\n        children: circuits.map(c => {\n          const isSelected = selectedCircuit === c.id;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"action-card\",\n            role: \"button\",\n            tabIndex: 0,\n            onClick: () => setSelectedCircuit(c.id),\n            style: isSelected ? selectedStyle : undefined,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"action-icon\",\n              children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                viewBox: \"0 0 24 24\",\n                className: \"icon\",\n                \"aria-hidden\": \"true\",\n                children: [/*#__PURE__*/_jsxDEV(\"path\", {\n                  d: \"M4 12a8 8 0 1 1 16 0v3a3 3 0 0 1-3 3h-2a1 1 0 1 1 0-2h2a1 1 0 0 0 1-1v-3a6 6 0 1 0-12 0v3a1 1 0 0 0 1 1h2a1 1 0 1 1 0 2H7a3 3 0 0 1-3-3v-3z\",\n                  fill: \"currentColor\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 196,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"circle\", {\n                  cx: \"12\",\n                  cy: \"12\",\n                  r: \"2.25\",\n                  fill: \"currentColor\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 197,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 195,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 194,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"action-title\",\n              children: c.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 200,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"action-desc\",\n              children: [\"Lunghezza ~ \", (c.lengthMeters || 0).toFixed(0), \" m \\u2022 Punti \", c.points || 0]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 201,\n              columnNumber: 17\n            }, this)]\n          }, c.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      style: {\n        marginBottom: 28\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          gap: 10,\n          marginBottom: 12\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"section-title\",\n          style: {\n            margin: 0\n          },\n          children: \"Device attivi\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"chip readonly\",\n          style: {\n            background: 'rgba(192,255,3,0.15)',\n            borderColor: 'rgba(192,255,3,0.55)'\n          },\n          children: activeMacs.length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"muted\",\n          children: \"in tempo reale via WebSocket\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 9\n      }, this), activeMacs.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"dz\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"dz-inner\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"dz-label\",\n            children: \"Nessun device GPS attivo\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"dz-hint\",\n            children: \"Avvia il simulatore o connetti dispositivi GPS\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"pilots-grid\",\n        children: activeMacs.map(mac => {\n          var _deviceAssignments$ma;\n          const device = activeDevices[mac];\n          const assignedPilotId = (_deviceAssignments$ma = deviceAssignments[mac]) !== null && _deviceAssignments$ma !== void 0 ? _deviceAssignments$ma : '';\n          const assignedPilot = pilots.find(p => String(p.id) === assignedPilotId);\n          const pilotPhotoUrl = assignedPilot !== null && assignedPilot !== void 0 && assignedPilot.photoDriverUrl ? `${API_BASE}${assignedPilot.photoDriverUrl}` : null;\n          const teamLogoUrl = assignedPilot !== null && assignedPilot !== void 0 && assignedPilot.photoTeamUrl ? `${API_BASE}${assignedPilot.photoTeamUrl}` : null;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"pilot-card\",\n            style: {\n              ...(assignedPilotId ? selectedStyle : {}),\n              gridTemplateColumns: '140px 1fr' // 2 colonne: immagini + contenuto\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pilot-photos col\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"photo tall media-box\",\n                children: pilotPhotoUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: pilotPhotoUrl,\n                  alt: `${(assignedPilot === null || assignedPilot === void 0 ? void 0 : assignedPilot.name) || ''} ${(assignedPilot === null || assignedPilot === void 0 ? void 0 : assignedPilot.surname) || ''}`,\n                  className: \"pilot-photo-img\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 248,\n                  columnNumber: 25\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"photo-placeholder\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontWeight: 700,\n                      color: 'var(--brand)'\n                    },\n                    children: \"Seleziona pilota\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 251,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"muted\",\n                    style: {\n                      marginTop: 6\n                    },\n                    children: \"Foto pilota\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 252,\n                    columnNumber: 27\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 250,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 246,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"photo small media-box team-logo-box\",\n                children: teamLogoUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: teamLogoUrl,\n                  alt: (assignedPilot === null || assignedPilot === void 0 ? void 0 : assignedPilot.team) || 'Team',\n                  className: \"team-logo-img\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 259,\n                  columnNumber: 25\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"photo-placeholder\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"muted\",\n                    children: \"Logo team\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 262,\n                    columnNumber: 27\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 261,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 257,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pilot-info wide\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"pilot-name big\",\n                children: \"Assegnazione pilota\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 270,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"pilot-team big muted\",\n                style: {\n                  marginBottom: 12\n                },\n                children: mac\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 273,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-row\",\n                style: {\n                  gridTemplateColumns: '1fr'\n                },\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"form-col\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    className: \"muted\",\n                    children: \"Pilota\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 279,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                    className: \"input\",\n                    value: assignedPilotId,\n                    onChange: e => assignPilotToDevice(mac, e.target.value),\n                    children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"\",\n                      children: \"-- Seleziona --\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 285,\n                      columnNumber: 27\n                    }, this), pilots.map(p => /*#__PURE__*/_jsxDEV(\"option\", {\n                      value: String(p.id),\n                      children: [p.name, \" \", p.surname, \" (\", p.team, \")\"]\n                    }, p.id, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 287,\n                      columnNumber: 29\n                    }, this))]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 280,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 278,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 277,\n                columnNumber: 21\n              }, this), assignedPilot && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"pilot-chips\",\n                style: {\n                  marginTop: 10\n                },\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"chip readonly\",\n                  title: \"Team\",\n                  children: assignedPilot.team\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 298,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 297,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  marginTop: 12,\n                  display: 'flex',\n                  justifyContent: 'flex-end'\n                },\n                children: assignedPilot ? /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn-danger\",\n                  onClick: () => assignPilotToDevice(mac, ''),\n                  title: \"Rimuovi assegnazione\",\n                  children: \"Rimuovi\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 305,\n                  columnNumber: 25\n                }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"muted\",\n                  children: \"non assegnato\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 313,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 303,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 19\n            }, this)]\n          }, mac, true, {\n            fileName: _jsxFileName,\n            lineNumber: 236,\n            columnNumber: 17\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      style: {\n        marginBottom: 28\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"section-title\",\n        children: \"Numero giri\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          gap: 12\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-ghost\",\n          onClick: () => setTotalLaps(Math.max(1, totalLaps - 1)),\n          children: \"\\u2212\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pilot-form\",\n          style: {\n            padding: 12,\n            minWidth: 160\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              textAlign: 'center'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"muted\",\n              style: {\n                marginBottom: 6\n              },\n              children: \"Giri\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 331,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontWeight: 900,\n                fontSize: '1.8rem',\n                color: 'var(--brand)'\n              },\n              children: totalLaps\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 332,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn-ghost\",\n          onClick: () => setTotalLaps(totalLaps + 1),\n          children: \"+\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 335,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"cta-wrapper\",\n      style: {\n        marginTop: 10\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"big-cta\",\n        disabled: !canStart,\n        onClick: handleStart,\n        \"aria-label\": \"Avvia gara\",\n        children: \"START RACE\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"cta-hint\",\n        children: canStart ? `${assignedCount} ${assignedCount === 1 ? 'pilota' : 'piloti'} × ${totalLaps} giri` + (selectedCircuit ? ` • circuito #${selectedCircuit}` : '') : 'Seleziona circuito e assegna almeno un pilota a un device'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 173,\n    columnNumber: 5\n  }, this);\n}\n_s2(RaceSetup, \"bH7ha7IHK8hkn4MBSZbzOhrRmL0=\", false, function () {\n  return [useReliableWebSocket];\n});\n_c = RaceSetup;\nvar _c;\n$RefreshReg$(_c, \"RaceSetup\");","map":{"version":3,"names":["React","useState","useEffect","useRef","jsxDEV","_jsxDEV","API_BASE","process","env","REACT_APP_API_BASE","window","location","hostname","makeWsUrl","REACT_APP_WS_URL","proto","protocol","host","WS_URL","useReliableWebSocket","url","onMessage","onOpen","onError","_s","wsRef","aliveRef","retryRef","current","connect","ws","WebSocket","onopen","e","onmessage","onerror","onclose","delay","Math","min","setTimeout","readyState","OPEN","CONNECTING","close","RaceSetup","onStartRace","_s2","circuits","setCircuits","pilots","setPilots","selectedCircuit","setSelectedCircuit","circuitData","setCircuitData","totalLaps","setTotalLaps","activeDevices","setActiveDevices","deviceAssignments","setDeviceAssignments","deviceTimeoutRef","fetch","then","r","json","catch","console","error","log","event","data","JSON","parse","pkt","type","payload","mac","lat","lon","String","Number","speed","speedKmh","prev","lastSeen","Date","now","clearTimeout","copy","err","assignPilotToDevice","pilotIdString","handleStart","alert","assignedDevices","Object","keys","filter","length","selectedPilotIds","values","Boolean","selectedPilots","p","includes","id","raceConfig","circuit","assignments","activeMacs","assignedCount","canStart","selectedStyle","borderColor","boxShadow","className","children","style","marginBottom","fileName","_jsxFileName","lineNumber","columnNumber","marginTop","map","c","isSelected","role","tabIndex","onClick","undefined","viewBox","d","fill","cx","cy","name","lengthMeters","toFixed","points","display","alignItems","gap","margin","background","_deviceAssignments$ma","device","assignedPilotId","assignedPilot","find","pilotPhotoUrl","photoDriverUrl","teamLogoUrl","photoTeamUrl","gridTemplateColumns","src","alt","surname","fontWeight","color","team","value","onChange","target","title","justifyContent","max","padding","minWidth","textAlign","fontSize","disabled","_c","$RefreshReg$"],"sources":["/home/ubuntu/racesense/racesense-frontend/src/pages/RaceSetup.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport '../App.css';\n\nconst API_BASE = process.env.REACT_APP_API_BASE || `http://${window.location.hostname}:5000`;\n\n/* ========= WebSocket URL coerente con http/https ========= */\n/* ========= WebSocket URL coerente con http/https e stessa porta dell'API ========= */\nconst makeWsUrl = () => {\n  if (process.env.REACT_APP_WS_URL) return process.env.REACT_APP_WS_URL; // opzionale override\n  const proto = window.location.protocol === 'https:' ? 'wss' : 'ws';\n  // window.location.host include già hostname + :porta\n  return `${proto}://${window.location.host}/ws`;\n};\nconst WS_URL = makeWsUrl();\n\n/* ========= Hook: WebSocket affidabile con auto-reconnect ========= */\nfunction useReliableWebSocket(url, { onMessage, onOpen, onError } = {}) {\n  const wsRef = React.useRef(null);\n  const aliveRef = React.useRef(true);\n  const retryRef = React.useRef(0);\n\n  React.useEffect(() => {\n    aliveRef.current = true;\n\n    const connect = () => {\n      if (!aliveRef.current) return;\n      try {\n        const ws = new WebSocket(url);\n        wsRef.current = ws;\n\n        ws.onopen = (e) => {\n          retryRef.current = 0;\n          onOpen && onOpen(e);\n        };\n        ws.onmessage = (e) => onMessage && onMessage(e);\n        ws.onerror = (e) => onError && onError(e);\n        ws.onclose = () => {\n          if (!aliveRef.current) return;\n          const delay = Math.min(1000 * 2 ** retryRef.current, 10000);\n          retryRef.current += 1;\n          setTimeout(connect, delay);\n        };\n      } catch {\n        const delay = Math.min(1000 * 2 ** retryRef.current, 10000);\n        retryRef.current += 1;\n        setTimeout(connect, delay);\n      }\n    };\n\n    connect();\n\n    return () => {\n      aliveRef.current = false;\n      try {\n        const ws = wsRef.current;\n        if (ws && (ws.readyState === WebSocket.OPEN || ws.readyState === WebSocket.CONNECTING)) {\n          ws.close();\n        }\n      } catch { }\n    };\n  }, [url, onMessage, onOpen, onError]);\n\n  return wsRef;\n}\n\nexport default function RaceSetup({ onStartRace }) {\n  const [circuits, setCircuits] = useState([]);\n  const [pilots, setPilots] = useState([]);\n\n  const [selectedCircuit, setSelectedCircuit] = useState(null);\n  const [circuitData, setCircuitData] = useState(null);\n\n  const [totalLaps, setTotalLaps] = useState(10);\n\n  // Device attivi e assegnazioni (pilotId SALVATO COME STRINGA)\n  const [activeDevices, setActiveDevices] = useState({});\n  const [deviceAssignments, setDeviceAssignments] = useState({});\n\n  const deviceTimeoutRef = useRef({});\n\n  // --- Carica circuiti e piloti ---\n  useEffect(() => {\n    fetch(`${API_BASE}/api/circuits`)\n      .then(r => r.json())\n      .then(setCircuits)\n      .catch(e => console.error('Errore caricamento circuiti:', e));\n\n    fetch(`${API_BASE}/api/pilots`)\n      .then(r => r.json())\n      .then(setPilots)\n      .catch(e => console.error('Errore caricamento piloti:', e));\n  }, []);\n\n  // --- Dettagli circuito selezionato ---\n  useEffect(() => {\n    if (!selectedCircuit) return;\n    fetch(`${API_BASE}/api/circuits/${selectedCircuit}`)\n      .then(r => r.json())\n      .then(setCircuitData)\n      .catch(e => console.error('Errore caricamento circuito:', e));\n  }, [selectedCircuit]);\n\n  // --- WebSocket per device attivi (affidabile) ---\n  useReliableWebSocket(WS_URL, {\n    onOpen: () => console.log('[RaceSetup] WS connesso'),\n    onError: (e) => console.error('[RaceSetup] WS errore', e),\n    onMessage: (event) => {\n      try {\n        const data = JSON.parse(event.data);\n        const pkt = data?.type === 'gps' ? (data.payload || data) : data;\n\n        if (pkt.mac && pkt.lat && pkt.lon) {\n          const mac = String(pkt.mac);\n          const lat = Number(pkt.lat);\n          const lon = Number(pkt.lon);\n          const speed = Number(pkt.speedKmh || 0);\n\n          setActiveDevices(prev => ({\n            ...prev,\n            [mac]: { lastSeen: Date.now(), lat, lon, speed, data: pkt }\n          }));\n\n          if (deviceTimeoutRef.current[mac]) clearTimeout(deviceTimeoutRef.current[mac]);\n          deviceTimeoutRef.current[mac] = setTimeout(() => {\n            setActiveDevices(prev => {\n              const copy = { ...prev };\n              delete copy[mac];\n              return copy;\n            });\n          }, 6000);\n        }\n      } catch (err) {\n        console.error('Errore parsing GPS:', err);\n      }\n    }\n  });\n\n  // --- Assegna pilota: mantengo SEMPRE stringa ---\n  const assignPilotToDevice = (mac, pilotIdString) => {\n    setDeviceAssignments(prev => ({ ...prev, [mac]: pilotIdString }));\n  };\n\n  // --- Avvio gara ---\n  const handleStart = () => {\n    if (!selectedCircuit) return alert('ATTENZIONE: seleziona un circuito!');\n    const assignedDevices = Object.keys(deviceAssignments).filter(mac => deviceAssignments[mac]);\n    if (assignedDevices.length === 0) return alert('ATTENZIONE: assegna almeno un pilota a un device attivo!');\n\n    const selectedPilotIds = Object.values(deviceAssignments).filter(Boolean); // stringhe\n    const selectedPilots = pilots.filter(p => selectedPilotIds.includes(String(p.id)));\n\n    const raceConfig = {\n      circuit: selectedCircuit,\n      circuitData,\n      totalLaps,\n      assignments: deviceAssignments, // { MAC: 'pilotId' }\n      pilots: selectedPilots,\n      activeDevices: assignedDevices\n    };\n    onStartRace(raceConfig);\n  };\n\n  const activeMacs = Object.keys(activeDevices);\n  const assignedCount = Object.values(deviceAssignments).filter(Boolean).length;\n  const canStart = Boolean(selectedCircuit) && assignedCount > 0;\n\n  const selectedStyle = {\n    borderColor: 'rgba(192, 255, 3, 0.55)',\n    boxShadow: '0 0 24px rgba(192,255,3,0.25)'\n  };\n\n  return (\n    <div className=\"main small-top\">\n      <h2 className=\"section-title\" style={{ marginBottom: 8 }}>Configurazione Gara</h2>\n      <p className=\"subtitle\" style={{ marginTop: 0, marginBottom: 24 }}>\n        Seleziona il circuito, assegna i piloti ai device e imposta i giri.\n      </p>\n\n      {/* Circuito */}\n      <section style={{ marginBottom: 28 }}>\n        <h3 className=\"section-title\">Circuito</h3>\n        <div className=\"actions\" style={{ marginBottom: 16 }}>\n          {circuits.map(c => {\n            const isSelected = selectedCircuit === c.id;\n            return (\n              <div\n                key={c.id}\n                className=\"action-card\"\n                role=\"button\"\n                tabIndex={0}\n                onClick={() => setSelectedCircuit(c.id)}\n                style={isSelected ? selectedStyle : undefined}\n              >\n                <div className=\"action-icon\">\n                  <svg viewBox=\"0 0 24 24\" className=\"icon\" aria-hidden=\"true\">\n                    <path d=\"M4 12a8 8 0 1 1 16 0v3a3 3 0 0 1-3 3h-2a1 1 0 1 1 0-2h2a1 1 0 0 0 1-1v-3a6 6 0 1 0-12 0v3a1 1 0 0 0 1 1h2a1 1 0 1 1 0 2H7a3 3 0 0 1-3-3v-3z\" fill=\"currentColor\" />\n                    <circle cx=\"12\" cy=\"12\" r=\"2.25\" fill=\"currentColor\" />\n                  </svg>\n                </div>\n                <h4 className=\"action-title\">{c.name}</h4>\n                <p className=\"action-desc\">Lunghezza ~ {(c.lengthMeters || 0).toFixed(0)} m • Punti {c.points || 0}</p>\n              </div>\n            );\n          })}\n        </div>\n      </section>\n\n      {/* Device & Assegnazioni */}\n      <section style={{ marginBottom: 28 }}>\n        <div style={{ display: 'flex', alignItems: 'center', gap: 10, marginBottom: 12 }}>\n          <h3 className=\"section-title\" style={{ margin: 0 }}>Device attivi</h3>\n          <span className=\"chip readonly\" style={{ background: 'rgba(192,255,3,0.15)', borderColor: 'rgba(192,255,3,0.55)' }}>\n            {activeMacs.length}\n          </span>\n          <span className=\"muted\">in tempo reale via WebSocket</span>\n        </div>\n\n        {activeMacs.length === 0 ? (\n          <div className=\"dz\">\n            <div className=\"dz-inner\">\n              <span className=\"dz-label\">Nessun device GPS attivo</span>\n              <span className=\"dz-hint\">Avvia il simulatore o connetti dispositivi GPS</span>\n            </div>\n          </div>\n        ) : (\n          <div className=\"pilots-grid\">{/* 3 colonne su desktop */}\n            {activeMacs.map(mac => {\n              const device = activeDevices[mac];\n              const assignedPilotId = deviceAssignments[mac] ?? '';\n              const assignedPilot = pilots.find(p => String(p.id) === assignedPilotId);\n\n              const pilotPhotoUrl = assignedPilot?.photoDriverUrl ? `${API_BASE}${assignedPilot.photoDriverUrl}` : null;\n              const teamLogoUrl = assignedPilot?.photoTeamUrl ? `${API_BASE}${assignedPilot.photoTeamUrl}` : null;\n\n              return (\n                <div\n                  key={mac}\n                  className=\"pilot-card\"\n                  style={{\n                    ...(assignedPilotId ? selectedStyle : {}),\n                    gridTemplateColumns: '140px 1fr' // 2 colonne: immagini + contenuto\n                  }}\n                >\n                  {/* Colonna sinistra: foto pilota (tall) + logo team (small) */}\n                  <div className=\"pilot-photos col\">\n                    <div className=\"photo tall media-box\">\n                      {pilotPhotoUrl ? (\n                        <img src={pilotPhotoUrl} alt={`${assignedPilot?.name || ''} ${assignedPilot?.surname || ''}`} className=\"pilot-photo-img\" />\n                      ) : (\n                        <div className=\"photo-placeholder\">\n                          <div style={{ fontWeight: 700, color: 'var(--brand)' }}>Seleziona pilota</div>\n                          <div className=\"muted\" style={{ marginTop: 6 }}>Foto pilota</div>\n                        </div>\n                      )}\n                    </div>\n\n                    <div className=\"photo small media-box team-logo-box\">\n                      {teamLogoUrl ? (\n                        <img src={teamLogoUrl} alt={assignedPilot?.team || 'Team'} className=\"team-logo-img\" />\n                      ) : (\n                        <div className=\"photo-placeholder\">\n                          <div className=\"muted\">Logo team</div>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n\n                  {/* Colonna destra: info e selezione */}\n                  <div className=\"pilot-info wide\">\n                    <div className=\"pilot-name big\">Assegnazione pilota</div>\n\n                    {/* Mostra il MAC al posto della frase lunga */}\n                    <div className=\"pilot-team big muted\" style={{ marginBottom: 12 }}>\n                      {mac}\n                    </div>\n\n                    <div className=\"form-row\" style={{ gridTemplateColumns: '1fr' }}>\n                      <div className=\"form-col\">\n                        <label className=\"muted\">Pilota</label>\n                        <select\n                          className=\"input\"\n                          value={assignedPilotId}\n                          onChange={(e) => assignPilotToDevice(mac, e.target.value)}\n                        >\n                          <option value=\"\">-- Seleziona --</option>\n                          {pilots.map(p => (\n                            <option key={p.id} value={String(p.id)}>\n                              {p.name} {p.surname} ({p.team})\n                            </option>\n                          ))}\n                        </select>\n                      </div>\n                    </div>\n\n                    {/* Dati selezionati: SOLO team */}\n                    {assignedPilot && (\n                      <div className=\"pilot-chips\" style={{ marginTop: 10 }}>\n                        <span className=\"chip readonly\" title=\"Team\">{assignedPilot.team}</span>\n                      </div>\n                    )}\n\n                    {/* Azioni: se assegnato -> Rimuovi, altrimenti \"non assegnato\" */}\n                    <div style={{ marginTop: 12, display: 'flex', justifyContent: 'flex-end' }}>\n                      {assignedPilot ? (\n                        <button\n                          className=\"btn-danger\"\n                          onClick={() => assignPilotToDevice(mac, '')}\n                          title=\"Rimuovi assegnazione\"\n                        >\n                          Rimuovi\n                        </button>\n                      ) : (\n                        <span className=\"muted\">non assegnato</span>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        )}\n      </section>\n\n      {/* Numero giri */}\n      <section style={{ marginBottom: 28 }}>\n        <h3 className=\"section-title\">Numero giri</h3>\n        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: 12 }}>\n          <button className=\"btn-ghost\" onClick={() => setTotalLaps(Math.max(1, totalLaps - 1))}>−</button>\n          <div className=\"pilot-form\" style={{ padding: 12, minWidth: 160 }}>\n            <div style={{ textAlign: 'center' }}>\n              <div className=\"muted\" style={{ marginBottom: 6 }}>Giri</div>\n              <div style={{ fontWeight: 900, fontSize: '1.8rem', color: 'var(--brand)' }}>{totalLaps}</div>\n            </div>\n          </div>\n          <button className=\"btn-ghost\" onClick={() => setTotalLaps(totalLaps + 1)}>+</button>\n        </div>\n      </section>\n\n      {/* CTA Avvio */}\n      <div className=\"cta-wrapper\" style={{ marginTop: 10 }}>\n        <button className=\"big-cta\" disabled={!canStart} onClick={handleStart} aria-label=\"Avvia gara\">\n          START RACE\n        </button>\n        <p className=\"cta-hint\">\n          {canStart\n            ? `${assignedCount} ${assignedCount === 1 ? 'pilota' : 'piloti'} × ${totalLaps} giri` +\n            (selectedCircuit ? ` • circuito #${selectedCircuit}` : '')\n            : 'Seleziona circuito e assegna almeno un pilota a un device'}\n        </p>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}